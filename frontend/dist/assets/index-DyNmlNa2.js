var Kk=Object.defineProperty;var z1=n=>{throw TypeError(n)};var Qk=(n,e,t)=>e in n?Kk(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var F=(n,e,t)=>Qk(n,typeof e!="symbol"?e+"":e,t),dv=(n,e,t)=>e.has(n)||z1("Cannot "+t);var a=(n,e,t)=>(dv(n,e,"read from private field"),t?t.call(n):e.get(n)),b=(n,e,t)=>e.has(n)?z1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),g=(n,e,t,s)=>(dv(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),A=(n,e,t)=>(dv(n,e,"access private method"),t);var At=(n,e,t,s)=>({set _(i){g(n,e,i,t)},get _(){return a(n,e,s)}});function Jk(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in n)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function Vb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Gb={exports:{}},Ny={},Wb={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $p=Symbol.for("react.element"),Zk=Symbol.for("react.portal"),eT=Symbol.for("react.fragment"),tT=Symbol.for("react.strict_mode"),nT=Symbol.for("react.profiler"),sT=Symbol.for("react.provider"),iT=Symbol.for("react.context"),rT=Symbol.for("react.forward_ref"),oT=Symbol.for("react.suspense"),aT=Symbol.for("react.memo"),lT=Symbol.for("react.lazy"),U1=Symbol.iterator;function cT(n){return n===null||typeof n!="object"?null:(n=U1&&n[U1]||n["@@iterator"],typeof n=="function"?n:null)}var Xb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qb=Object.assign,Yb={};function kh(n,e,t){this.props=n,this.context=e,this.refs=Yb,this.updater=t||Xb}kh.prototype.isReactComponent={};kh.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};kh.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Kb(){}Kb.prototype=kh.prototype;function xx(n,e,t){this.props=n,this.context=e,this.refs=Yb,this.updater=t||Xb}var Sx=xx.prototype=new Kb;Sx.constructor=xx;qb(Sx,kh.prototype);Sx.isPureReactComponent=!0;var $1=Array.isArray,Qb=Object.prototype.hasOwnProperty,bx={current:null},Jb={key:!0,ref:!0,__self:!0,__source:!0};function Zb(n,e,t){var s,i={},r=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(r=""+e.key),e)Qb.call(e,s)&&!Jb.hasOwnProperty(s)&&(i[s]=e[s]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(s in l=n.defaultProps,l)i[s]===void 0&&(i[s]=l[s]);return{$$typeof:$p,type:n,key:r,ref:o,props:i,_owner:bx.current}}function uT(n,e){return{$$typeof:$p,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Ax(n){return typeof n=="object"&&n!==null&&n.$$typeof===$p}function hT(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var H1=/\/+/g;function fv(n,e){return typeof n=="object"&&n!==null&&n.key!=null?hT(""+n.key):e.toString(36)}function Fg(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case $p:case Zk:o=!0}}if(o)return o=n,i=i(o),n=s===""?"."+fv(o,0):s,$1(i)?(t="",n!=null&&(t=n.replace(H1,"$&/")+"/"),Fg(i,e,t,"",function(u){return u})):i!=null&&(Ax(i)&&(i=uT(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(H1,"$&/")+"/")+n)),e.push(i)),1;if(o=0,s=s===""?".":s+":",$1(n))for(var l=0;l<n.length;l++){r=n[l];var c=s+fv(r,l);o+=Fg(r,e,t,c,i)}else if(c=cT(n),typeof c=="function")for(n=c.call(n),l=0;!(r=n.next()).done;)r=r.value,c=s+fv(r,l++),o+=Fg(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function rg(n,e,t){if(n==null)return n;var s=[],i=0;return Fg(n,s,"","",function(r){return e.call(t,r,i++)}),s}function dT(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var An={current:null},jg={transition:null},fT={ReactCurrentDispatcher:An,ReactCurrentBatchConfig:jg,ReactCurrentOwner:bx};function eA(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:rg,forEach:function(n,e,t){rg(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return rg(n,function(){e++}),e},toArray:function(n){return rg(n,function(e){return e})||[]},only:function(n){if(!Ax(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ge.Component=kh;ge.Fragment=eT;ge.Profiler=nT;ge.PureComponent=xx;ge.StrictMode=tT;ge.Suspense=oT;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fT;ge.act=eA;ge.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=qb({},n.props),i=n.key,r=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,o=bx.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(c in e)Qb.call(e,c)&&!Jb.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:$p,type:n.type,key:i,ref:r,props:s,_owner:o}};ge.createContext=function(n){return n={$$typeof:iT,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:sT,_context:n},n.Consumer=n};ge.createElement=Zb;ge.createFactory=function(n){var e=Zb.bind(null,n);return e.type=n,e};ge.createRef=function(){return{current:null}};ge.forwardRef=function(n){return{$$typeof:rT,render:n}};ge.isValidElement=Ax;ge.lazy=function(n){return{$$typeof:lT,_payload:{_status:-1,_result:n},_init:dT}};ge.memo=function(n,e){return{$$typeof:aT,type:n,compare:e===void 0?null:e}};ge.startTransition=function(n){var e=jg.transition;jg.transition={};try{n()}finally{jg.transition=e}};ge.unstable_act=eA;ge.useCallback=function(n,e){return An.current.useCallback(n,e)};ge.useContext=function(n){return An.current.useContext(n)};ge.useDebugValue=function(){};ge.useDeferredValue=function(n){return An.current.useDeferredValue(n)};ge.useEffect=function(n,e){return An.current.useEffect(n,e)};ge.useId=function(){return An.current.useId()};ge.useImperativeHandle=function(n,e,t){return An.current.useImperativeHandle(n,e,t)};ge.useInsertionEffect=function(n,e){return An.current.useInsertionEffect(n,e)};ge.useLayoutEffect=function(n,e){return An.current.useLayoutEffect(n,e)};ge.useMemo=function(n,e){return An.current.useMemo(n,e)};ge.useReducer=function(n,e,t){return An.current.useReducer(n,e,t)};ge.useRef=function(n){return An.current.useRef(n)};ge.useState=function(n){return An.current.useState(n)};ge.useSyncExternalStore=function(n,e,t){return An.current.useSyncExternalStore(n,e,t)};ge.useTransition=function(){return An.current.useTransition()};ge.version="18.3.1";Wb.exports=ge;var P=Wb.exports;const pT=Vb(P),gT=Jk({__proto__:null,default:pT},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mT=P,yT=Symbol.for("react.element"),vT=Symbol.for("react.fragment"),wT=Object.prototype.hasOwnProperty,xT=mT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ST={key:!0,ref:!0,__self:!0,__source:!0};function tA(n,e,t){var s,i={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)wT.call(e,s)&&!ST.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:yT,type:n,key:r,ref:o,props:i,_owner:xT.current}}Ny.Fragment=vT;Ny.jsx=tA;Ny.jsxs=tA;Gb.exports=Ny;var p=Gb.exports,nA={exports:{}},fs={},sA={exports:{}},iA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(D,U){var K=D.length;D.push(U);e:for(;0<K;){var le=K-1>>>1,Z=D[le];if(0<i(Z,U))D[le]=U,D[K]=Z,K=le;else break e}}function t(D){return D.length===0?null:D[0]}function s(D){if(D.length===0)return null;var U=D[0],K=D.pop();if(K!==U){D[0]=K;e:for(var le=0,Z=D.length,se=Z>>>1;le<se;){var _e=2*(le+1)-1,J=D[_e],ie=_e+1,ye=D[ie];if(0>i(J,K))ie<Z&&0>i(ye,J)?(D[le]=ye,D[ie]=K,le=ie):(D[le]=J,D[_e]=K,le=_e);else if(ie<Z&&0>i(ye,K))D[le]=ye,D[ie]=K,le=ie;else break e}}return U}function i(D,U){var K=D.sortIndex-U.sortIndex;return K!==0?K:D.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,m=!1,S=!1,x=!1,C=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(D){for(var U=t(u);U!==null;){if(U.callback===null)s(u);else if(U.startTime<=D)s(u),U.sortIndex=U.expirationTime,e(c,U);else break;U=t(u)}}function E(D){if(x=!1,v(D),!S)if(t(c)!==null)S=!0,z(_);else{var U=t(u);U!==null&&B(E,U.startTime-D)}}function _(D,U){S=!1,x&&(x=!1,y(L),L=-1),m=!0;var K=f;try{for(v(U),d=t(c);d!==null&&(!(d.expirationTime>U)||D&&!M());){var le=d.callback;if(typeof le=="function"){d.callback=null,f=d.priorityLevel;var Z=le(d.expirationTime<=U);U=n.unstable_now(),typeof Z=="function"?d.callback=Z:d===t(c)&&s(c),v(U)}else s(c);d=t(c)}if(d!==null)var se=!0;else{var _e=t(u);_e!==null&&B(E,_e.startTime-U),se=!1}return se}finally{d=null,f=K,m=!1}}var k=!1,T=null,L=-1,R=5,N=-1;function M(){return!(n.unstable_now()-N<R)}function O(){if(T!==null){var D=n.unstable_now();N=D;var U=!0;try{U=T(!0,D)}finally{U?V():(k=!1,T=null)}}else k=!1}var V;if(typeof w=="function")V=function(){w(O)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,te=H.port2;H.port1.onmessage=O,V=function(){te.postMessage(null)}}else V=function(){C(O,0)};function z(D){T=D,k||(k=!0,V())}function B(D,U){L=C(function(){D(n.unstable_now())},U)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(D){D.callback=null},n.unstable_continueExecution=function(){S||m||(S=!0,z(_))},n.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<D?Math.floor(1e3/D):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(D){switch(f){case 1:case 2:case 3:var U=3;break;default:U=f}var K=f;f=U;try{return D()}finally{f=K}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(D,U){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var K=f;f=D;try{return U()}finally{f=K}},n.unstable_scheduleCallback=function(D,U,K){var le=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?le+K:le):K=le,D){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=K+Z,D={id:h++,callback:U,priorityLevel:D,startTime:K,expirationTime:Z,sortIndex:-1},K>le?(D.sortIndex=K,e(u,D),t(c)===null&&D===t(u)&&(x?(y(L),L=-1):x=!0,B(E,K-le))):(D.sortIndex=Z,e(c,D),S||m||(S=!0,z(_))),D},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(D){var U=f;return function(){var K=f;f=U;try{return D.apply(this,arguments)}finally{f=K}}}})(iA);sA.exports=iA;var bT=sA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AT=P,hs=bT;function j(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rA=new Set,Rd={};function ec(n,e){mh(n,e),mh(n+"Capture",e)}function mh(n,e){for(Rd[n]=e,n=0;n<e.length;n++)rA.add(e[n])}var Or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jv=Object.prototype.hasOwnProperty,ET=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,V1={},G1={};function CT(n){return Jv.call(G1,n)?!0:Jv.call(V1,n)?!1:ET.test(n)?G1[n]=!0:(V1[n]=!0,!1)}function _T(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function kT(n,e,t,s){if(e===null||typeof e>"u"||_T(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function En(n,e,t,s,i,r,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var Qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Qt[n]=new En(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Qt[e]=new En(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Qt[n]=new En(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Qt[n]=new En(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Qt[n]=new En(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Qt[n]=new En(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Qt[n]=new En(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Qt[n]=new En(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Qt[n]=new En(n,5,!1,n.toLowerCase(),null,!1,!1)});var Ex=/[\-:]([a-z])/g;function Cx(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Ex,Cx);Qt[e]=new En(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Ex,Cx);Qt[e]=new En(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Ex,Cx);Qt[e]=new En(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Qt[n]=new En(n,1,!1,n.toLowerCase(),null,!1,!1)});Qt.xlinkHref=new En("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Qt[n]=new En(n,1,!1,n.toLowerCase(),null,!0,!0)});function _x(n,e,t,s){var i=Qt.hasOwnProperty(e)?Qt[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(kT(e,t,i,s)&&(t=null),s||i===null?CT(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Wr=AT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,og=Symbol.for("react.element"),yc=Symbol.for("react.portal"),vc=Symbol.for("react.fragment"),kx=Symbol.for("react.strict_mode"),Zv=Symbol.for("react.profiler"),oA=Symbol.for("react.provider"),aA=Symbol.for("react.context"),Tx=Symbol.for("react.forward_ref"),e0=Symbol.for("react.suspense"),t0=Symbol.for("react.suspense_list"),Px=Symbol.for("react.memo"),Zr=Symbol.for("react.lazy"),lA=Symbol.for("react.offscreen"),W1=Symbol.iterator;function Fh(n){return n===null||typeof n!="object"?null:(n=W1&&n[W1]||n["@@iterator"],typeof n=="function"?n:null)}var ot=Object.assign,pv;function Yh(n){if(pv===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);pv=e&&e[1]||""}return`
`+pv+n}var gv=!1;function mv(n,e){if(!n||gv)return"";gv=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),o=i.length-1,l=r.length-1;1<=o&&0<=l&&i[o]!==r[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==r[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==r[l]){var c=`
`+i[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=l);break}}}finally{gv=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Yh(n):""}function TT(n){switch(n.tag){case 5:return Yh(n.type);case 16:return Yh("Lazy");case 13:return Yh("Suspense");case 19:return Yh("SuspenseList");case 0:case 2:case 15:return n=mv(n.type,!1),n;case 11:return n=mv(n.type.render,!1),n;case 1:return n=mv(n.type,!0),n;default:return""}}function n0(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case vc:return"Fragment";case yc:return"Portal";case Zv:return"Profiler";case kx:return"StrictMode";case e0:return"Suspense";case t0:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case aA:return(n.displayName||"Context")+".Consumer";case oA:return(n._context.displayName||"Context")+".Provider";case Tx:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Px:return e=n.displayName||null,e!==null?e:n0(n.type)||"Memo";case Zr:e=n._payload,n=n._init;try{return n0(n(e))}catch{}}return null}function PT(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return n0(e);case 8:return e===kx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ha(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function cA(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function LT(n){var e=cA(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){s=""+o,r.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function ag(n){n._valueTracker||(n._valueTracker=LT(n))}function uA(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=cA(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function _m(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function s0(n,e){var t=e.checked;return ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function X1(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=ha(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hA(n,e){e=e.checked,e!=null&&_x(n,"checked",e,!1)}function i0(n,e){hA(n,e);var t=ha(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?r0(n,e.type,t):e.hasOwnProperty("defaultValue")&&r0(n,e.type,ha(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function q1(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function r0(n,e,t){(e!=="number"||_m(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Kh=Array.isArray;function Dc(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+ha(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function o0(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return ot({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Y1(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(j(92));if(Kh(t)){if(1<t.length)throw Error(j(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:ha(t)}}function dA(n,e){var t=ha(e.value),s=ha(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function K1(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function fA(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function a0(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?fA(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var lg,pA=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(lg=lg||document.createElement("div"),lg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=lg.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Md(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var bd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NT=["Webkit","ms","Moz","O"];Object.keys(bd).forEach(function(n){NT.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),bd[e]=bd[n]})});function gA(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||bd.hasOwnProperty(n)&&bd[n]?(""+e).trim():e+"px"}function mA(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=gA(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var RT=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function l0(n,e){if(e){if(RT[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function c0(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var u0=null;function Lx(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var h0=null,Ic=null,Fc=null;function Q1(n){if(n=Gp(n)){if(typeof h0!="function")throw Error(j(280));var e=n.stateNode;e&&(e=Fy(e),h0(n.stateNode,n.type,e))}}function yA(n){Ic?Fc?Fc.push(n):Fc=[n]:Ic=n}function vA(){if(Ic){var n=Ic,e=Fc;if(Fc=Ic=null,Q1(n),e)for(n=0;n<e.length;n++)Q1(e[n])}}function wA(n,e){return n(e)}function xA(){}var yv=!1;function SA(n,e,t){if(yv)return n(e,t);yv=!0;try{return wA(n,e,t)}finally{yv=!1,(Ic!==null||Fc!==null)&&(xA(),vA())}}function Dd(n,e){var t=n.stateNode;if(t===null)return null;var s=Fy(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(j(231,e,typeof t));return t}var d0=!1;if(Or)try{var jh={};Object.defineProperty(jh,"passive",{get:function(){d0=!0}}),window.addEventListener("test",jh,jh),window.removeEventListener("test",jh,jh)}catch{d0=!1}function MT(n,e,t,s,i,r,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var Ad=!1,km=null,Tm=!1,f0=null,DT={onError:function(n){Ad=!0,km=n}};function IT(n,e,t,s,i,r,o,l,c){Ad=!1,km=null,MT.apply(DT,arguments)}function FT(n,e,t,s,i,r,o,l,c){if(IT.apply(this,arguments),Ad){if(Ad){var u=km;Ad=!1,km=null}else throw Error(j(198));Tm||(Tm=!0,f0=u)}}function tc(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function bA(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function J1(n){if(tc(n)!==n)throw Error(j(188))}function jT(n){var e=n.alternate;if(!e){if(e=tc(n),e===null)throw Error(j(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return J1(i),n;if(r===s)return J1(i),e;r=r.sibling}throw Error(j(188))}if(t.return!==s.return)t=i,s=r;else{for(var o=!1,l=i.child;l;){if(l===t){o=!0,t=i,s=r;break}if(l===s){o=!0,s=i,t=r;break}l=l.sibling}if(!o){for(l=r.child;l;){if(l===t){o=!0,t=r,s=i;break}if(l===s){o=!0,s=r,t=i;break}l=l.sibling}if(!o)throw Error(j(189))}}if(t.alternate!==s)throw Error(j(190))}if(t.tag!==3)throw Error(j(188));return t.stateNode.current===t?n:e}function AA(n){return n=jT(n),n!==null?EA(n):null}function EA(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=EA(n);if(e!==null)return e;n=n.sibling}return null}var CA=hs.unstable_scheduleCallback,Z1=hs.unstable_cancelCallback,OT=hs.unstable_shouldYield,BT=hs.unstable_requestPaint,yt=hs.unstable_now,zT=hs.unstable_getCurrentPriorityLevel,Nx=hs.unstable_ImmediatePriority,_A=hs.unstable_UserBlockingPriority,Pm=hs.unstable_NormalPriority,UT=hs.unstable_LowPriority,kA=hs.unstable_IdlePriority,Ry=null,Ui=null;function $T(n){if(Ui&&typeof Ui.onCommitFiberRoot=="function")try{Ui.onCommitFiberRoot(Ry,n,void 0,(n.current.flags&128)===128)}catch{}}var ri=Math.clz32?Math.clz32:GT,HT=Math.log,VT=Math.LN2;function GT(n){return n>>>=0,n===0?32:31-(HT(n)/VT|0)|0}var cg=64,ug=4194304;function Qh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Lm(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,o=t&268435455;if(o!==0){var l=o&~i;l!==0?s=Qh(l):(r&=o,r!==0&&(s=Qh(r)))}else o=t&~i,o!==0?s=Qh(o):r!==0&&(s=Qh(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-ri(e),i=1<<t,s|=n[t],e&=~i;return s}function WT(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function XT(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var o=31-ri(r),l=1<<o,c=i[o];c===-1?(!(l&t)||l&s)&&(i[o]=WT(l,e)):c<=e&&(n.expiredLanes|=l),r&=~l}}function p0(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function TA(){var n=cg;return cg<<=1,!(cg&4194240)&&(cg=64),n}function vv(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Hp(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ri(e),n[e]=t}function qT(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-ri(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function Rx(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-ri(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var Le=0;function PA(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var LA,Mx,NA,RA,MA,g0=!1,hg=[],na=null,sa=null,ia=null,Id=new Map,Fd=new Map,to=[],YT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eS(n,e){switch(n){case"focusin":case"focusout":na=null;break;case"dragenter":case"dragleave":sa=null;break;case"mouseover":case"mouseout":ia=null;break;case"pointerover":case"pointerout":Id.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fd.delete(e.pointerId)}}function Oh(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=Gp(e),e!==null&&Mx(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function KT(n,e,t,s,i){switch(e){case"focusin":return na=Oh(na,n,e,t,s,i),!0;case"dragenter":return sa=Oh(sa,n,e,t,s,i),!0;case"mouseover":return ia=Oh(ia,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return Id.set(r,Oh(Id.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Fd.set(r,Oh(Fd.get(r)||null,n,e,t,s,i)),!0}return!1}function DA(n){var e=La(n.target);if(e!==null){var t=tc(e);if(t!==null){if(e=t.tag,e===13){if(e=bA(t),e!==null){n.blockedOn=e,MA(n.priority,function(){NA(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Og(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=m0(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);u0=s,t.target.dispatchEvent(s),u0=null}else return e=Gp(t),e!==null&&Mx(e),n.blockedOn=t,!1;e.shift()}return!0}function tS(n,e,t){Og(n)&&t.delete(e)}function QT(){g0=!1,na!==null&&Og(na)&&(na=null),sa!==null&&Og(sa)&&(sa=null),ia!==null&&Og(ia)&&(ia=null),Id.forEach(tS),Fd.forEach(tS)}function Bh(n,e){n.blockedOn===e&&(n.blockedOn=null,g0||(g0=!0,hs.unstable_scheduleCallback(hs.unstable_NormalPriority,QT)))}function jd(n){function e(i){return Bh(i,n)}if(0<hg.length){Bh(hg[0],n);for(var t=1;t<hg.length;t++){var s=hg[t];s.blockedOn===n&&(s.blockedOn=null)}}for(na!==null&&Bh(na,n),sa!==null&&Bh(sa,n),ia!==null&&Bh(ia,n),Id.forEach(e),Fd.forEach(e),t=0;t<to.length;t++)s=to[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<to.length&&(t=to[0],t.blockedOn===null);)DA(t),t.blockedOn===null&&to.shift()}var jc=Wr.ReactCurrentBatchConfig,Nm=!0;function JT(n,e,t,s){var i=Le,r=jc.transition;jc.transition=null;try{Le=1,Dx(n,e,t,s)}finally{Le=i,jc.transition=r}}function ZT(n,e,t,s){var i=Le,r=jc.transition;jc.transition=null;try{Le=4,Dx(n,e,t,s)}finally{Le=i,jc.transition=r}}function Dx(n,e,t,s){if(Nm){var i=m0(n,e,t,s);if(i===null)Tv(n,e,s,Rm,t),eS(n,s);else if(KT(i,n,e,t,s))s.stopPropagation();else if(eS(n,s),e&4&&-1<YT.indexOf(n)){for(;i!==null;){var r=Gp(i);if(r!==null&&LA(r),r=m0(n,e,t,s),r===null&&Tv(n,e,s,Rm,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else Tv(n,e,s,null,t)}}var Rm=null;function m0(n,e,t,s){if(Rm=null,n=Lx(s),n=La(n),n!==null)if(e=tc(n),e===null)n=null;else if(t=e.tag,t===13){if(n=bA(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Rm=n,null}function IA(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zT()){case Nx:return 1;case _A:return 4;case Pm:case UT:return 16;case kA:return 536870912;default:return 16}default:return 16}}var Zo=null,Ix=null,Bg=null;function FA(){if(Bg)return Bg;var n,e=Ix,t=e.length,s,i="value"in Zo?Zo.value:Zo.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(s=1;s<=o&&e[t-s]===i[r-s];s++);return Bg=i.slice(n,1<s?1-s:void 0)}function zg(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function dg(){return!0}function nS(){return!1}function ps(n){function e(t,s,i,r,o){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(r):r[l]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?dg:nS,this.isPropagationStopped=nS,this}return ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=dg)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=dg)},persist:function(){},isPersistent:dg}),e}var Th={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fx=ps(Th),Vp=ot({},Th,{view:0,detail:0}),eP=ps(Vp),wv,xv,zh,My=ot({},Vp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jx,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==zh&&(zh&&n.type==="mousemove"?(wv=n.screenX-zh.screenX,xv=n.screenY-zh.screenY):xv=wv=0,zh=n),wv)},movementY:function(n){return"movementY"in n?n.movementY:xv}}),sS=ps(My),tP=ot({},My,{dataTransfer:0}),nP=ps(tP),sP=ot({},Vp,{relatedTarget:0}),Sv=ps(sP),iP=ot({},Th,{animationName:0,elapsedTime:0,pseudoElement:0}),rP=ps(iP),oP=ot({},Th,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),aP=ps(oP),lP=ot({},Th,{data:0}),iS=ps(lP),cP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dP(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=hP[n])?!!e[n]:!1}function jx(){return dP}var fP=ot({},Vp,{key:function(n){if(n.key){var e=cP[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=zg(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?uP[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jx,charCode:function(n){return n.type==="keypress"?zg(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?zg(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),pP=ps(fP),gP=ot({},My,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rS=ps(gP),mP=ot({},Vp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jx}),yP=ps(mP),vP=ot({},Th,{propertyName:0,elapsedTime:0,pseudoElement:0}),wP=ps(vP),xP=ot({},My,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),SP=ps(xP),bP=[9,13,27,32],Ox=Or&&"CompositionEvent"in window,Ed=null;Or&&"documentMode"in document&&(Ed=document.documentMode);var AP=Or&&"TextEvent"in window&&!Ed,jA=Or&&(!Ox||Ed&&8<Ed&&11>=Ed),oS=" ",aS=!1;function OA(n,e){switch(n){case"keyup":return bP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function BA(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var wc=!1;function EP(n,e){switch(n){case"compositionend":return BA(e);case"keypress":return e.which!==32?null:(aS=!0,oS);case"textInput":return n=e.data,n===oS&&aS?null:n;default:return null}}function CP(n,e){if(wc)return n==="compositionend"||!Ox&&OA(n,e)?(n=FA(),Bg=Ix=Zo=null,wc=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return jA&&e.locale!=="ko"?null:e.data;default:return null}}var _P={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!_P[n.type]:e==="textarea"}function zA(n,e,t,s){yA(s),e=Mm(e,"onChange"),0<e.length&&(t=new Fx("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var Cd=null,Od=null;function kP(n){QA(n,0)}function Dy(n){var e=bc(n);if(uA(e))return n}function TP(n,e){if(n==="change")return e}var UA=!1;if(Or){var bv;if(Or){var Av="oninput"in document;if(!Av){var cS=document.createElement("div");cS.setAttribute("oninput","return;"),Av=typeof cS.oninput=="function"}bv=Av}else bv=!1;UA=bv&&(!document.documentMode||9<document.documentMode)}function uS(){Cd&&(Cd.detachEvent("onpropertychange",$A),Od=Cd=null)}function $A(n){if(n.propertyName==="value"&&Dy(Od)){var e=[];zA(e,Od,n,Lx(n)),SA(kP,e)}}function PP(n,e,t){n==="focusin"?(uS(),Cd=e,Od=t,Cd.attachEvent("onpropertychange",$A)):n==="focusout"&&uS()}function LP(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Dy(Od)}function NP(n,e){if(n==="click")return Dy(e)}function RP(n,e){if(n==="input"||n==="change")return Dy(e)}function MP(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var ai=typeof Object.is=="function"?Object.is:MP;function Bd(n,e){if(ai(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!Jv.call(e,i)||!ai(n[i],e[i]))return!1}return!0}function hS(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function dS(n,e){var t=hS(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=hS(t)}}function HA(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?HA(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function VA(){for(var n=window,e=_m();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=_m(n.document)}return e}function Bx(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function DP(n){var e=VA(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&HA(t.ownerDocument.documentElement,t)){if(s!==null&&Bx(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=dS(t,r);var o=dS(t,s);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var IP=Or&&"documentMode"in document&&11>=document.documentMode,xc=null,y0=null,_d=null,v0=!1;function fS(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;v0||xc==null||xc!==_m(s)||(s=xc,"selectionStart"in s&&Bx(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),_d&&Bd(_d,s)||(_d=s,s=Mm(y0,"onSelect"),0<s.length&&(e=new Fx("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=xc)))}function fg(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Sc={animationend:fg("Animation","AnimationEnd"),animationiteration:fg("Animation","AnimationIteration"),animationstart:fg("Animation","AnimationStart"),transitionend:fg("Transition","TransitionEnd")},Ev={},GA={};Or&&(GA=document.createElement("div").style,"AnimationEvent"in window||(delete Sc.animationend.animation,delete Sc.animationiteration.animation,delete Sc.animationstart.animation),"TransitionEvent"in window||delete Sc.transitionend.transition);function Iy(n){if(Ev[n])return Ev[n];if(!Sc[n])return n;var e=Sc[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in GA)return Ev[n]=e[t];return n}var WA=Iy("animationend"),XA=Iy("animationiteration"),qA=Iy("animationstart"),YA=Iy("transitionend"),KA=new Map,pS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function va(n,e){KA.set(n,e),ec(e,[n])}for(var Cv=0;Cv<pS.length;Cv++){var _v=pS[Cv],FP=_v.toLowerCase(),jP=_v[0].toUpperCase()+_v.slice(1);va(FP,"on"+jP)}va(WA,"onAnimationEnd");va(XA,"onAnimationIteration");va(qA,"onAnimationStart");va("dblclick","onDoubleClick");va("focusin","onFocus");va("focusout","onBlur");va(YA,"onTransitionEnd");mh("onMouseEnter",["mouseout","mouseover"]);mh("onMouseLeave",["mouseout","mouseover"]);mh("onPointerEnter",["pointerout","pointerover"]);mh("onPointerLeave",["pointerout","pointerover"]);ec("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ec("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ec("onBeforeInput",["compositionend","keypress","textInput","paste"]);ec("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ec("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ec("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jh));function gS(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,FT(s,e,void 0,n),n.currentTarget=null}function QA(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==r&&i.isPropagationStopped())break e;gS(i,l,u),r=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==r&&i.isPropagationStopped())break e;gS(i,l,u),r=c}}}if(Tm)throw n=f0,Tm=!1,f0=null,n}function Ge(n,e){var t=e[A0];t===void 0&&(t=e[A0]=new Set);var s=n+"__bubble";t.has(s)||(JA(e,n,2,!1),t.add(s))}function kv(n,e,t){var s=0;e&&(s|=4),JA(t,n,s,e)}var pg="_reactListening"+Math.random().toString(36).slice(2);function zd(n){if(!n[pg]){n[pg]=!0,rA.forEach(function(t){t!=="selectionchange"&&(OP.has(t)||kv(t,!1,n),kv(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[pg]||(e[pg]=!0,kv("selectionchange",!1,e))}}function JA(n,e,t,s){switch(IA(e)){case 1:var i=JT;break;case 4:i=ZT;break;default:i=Dx}t=i.bind(null,e,t,n),i=void 0,!d0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Tv(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=La(l),o===null)return;if(c=o.tag,c===5||c===6){s=r=o;continue e}l=l.parentNode}}s=s.return}SA(function(){var u=r,h=Lx(t),d=[];e:{var f=KA.get(n);if(f!==void 0){var m=Fx,S=n;switch(n){case"keypress":if(zg(t)===0)break e;case"keydown":case"keyup":m=pP;break;case"focusin":S="focus",m=Sv;break;case"focusout":S="blur",m=Sv;break;case"beforeblur":case"afterblur":m=Sv;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=sS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=nP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=yP;break;case WA:case XA:case qA:m=rP;break;case YA:m=wP;break;case"scroll":m=eP;break;case"wheel":m=SP;break;case"copy":case"cut":case"paste":m=aP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=rS}var x=(e&4)!==0,C=!x&&n==="scroll",y=x?f!==null?f+"Capture":null:f;x=[];for(var w=u,v;w!==null;){v=w;var E=v.stateNode;if(v.tag===5&&E!==null&&(v=E,y!==null&&(E=Dd(w,y),E!=null&&x.push(Ud(w,E,v)))),C)break;w=w.return}0<x.length&&(f=new m(f,S,null,t,h),d.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",f&&t!==u0&&(S=t.relatedTarget||t.fromElement)&&(La(S)||S[Br]))break e;if((m||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,m?(S=t.relatedTarget||t.toElement,m=u,S=S?La(S):null,S!==null&&(C=tc(S),S!==C||S.tag!==5&&S.tag!==6)&&(S=null)):(m=null,S=u),m!==S)){if(x=sS,E="onMouseLeave",y="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(x=rS,E="onPointerLeave",y="onPointerEnter",w="pointer"),C=m==null?f:bc(m),v=S==null?f:bc(S),f=new x(E,w+"leave",m,t,h),f.target=C,f.relatedTarget=v,E=null,La(h)===u&&(x=new x(y,w+"enter",S,t,h),x.target=v,x.relatedTarget=C,E=x),C=E,m&&S)t:{for(x=m,y=S,w=0,v=x;v;v=oc(v))w++;for(v=0,E=y;E;E=oc(E))v++;for(;0<w-v;)x=oc(x),w--;for(;0<v-w;)y=oc(y),v--;for(;w--;){if(x===y||y!==null&&x===y.alternate)break t;x=oc(x),y=oc(y)}x=null}else x=null;m!==null&&mS(d,f,m,x,!1),S!==null&&C!==null&&mS(d,C,S,x,!0)}}e:{if(f=u?bc(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var _=TP;else if(lS(f))if(UA)_=RP;else{_=LP;var k=PP}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=NP);if(_&&(_=_(n,u))){zA(d,_,t,h);break e}k&&k(n,f,u),n==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&r0(f,"number",f.value)}switch(k=u?bc(u):window,n){case"focusin":(lS(k)||k.contentEditable==="true")&&(xc=k,y0=u,_d=null);break;case"focusout":_d=y0=xc=null;break;case"mousedown":v0=!0;break;case"contextmenu":case"mouseup":case"dragend":v0=!1,fS(d,t,h);break;case"selectionchange":if(IP)break;case"keydown":case"keyup":fS(d,t,h)}var T;if(Ox)e:{switch(n){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else wc?OA(n,t)&&(L="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(L="onCompositionStart");L&&(jA&&t.locale!=="ko"&&(wc||L!=="onCompositionStart"?L==="onCompositionEnd"&&wc&&(T=FA()):(Zo=h,Ix="value"in Zo?Zo.value:Zo.textContent,wc=!0)),k=Mm(u,L),0<k.length&&(L=new iS(L,n,null,t,h),d.push({event:L,listeners:k}),T?L.data=T:(T=BA(t),T!==null&&(L.data=T)))),(T=AP?EP(n,t):CP(n,t))&&(u=Mm(u,"onBeforeInput"),0<u.length&&(h=new iS("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:u}),h.data=T))}QA(d,e)})}function Ud(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Mm(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=Dd(n,t),r!=null&&s.unshift(Ud(n,r,i)),r=Dd(n,e),r!=null&&s.push(Ud(n,r,i))),n=n.return}return s}function oc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function mS(n,e,t,s,i){for(var r=e._reactName,o=[];t!==null&&t!==s;){var l=t,c=l.alternate,u=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&u!==null&&(l=u,i?(c=Dd(t,r),c!=null&&o.unshift(Ud(t,c,l))):i||(c=Dd(t,r),c!=null&&o.push(Ud(t,c,l)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var BP=/\r\n?/g,zP=/\u0000|\uFFFD/g;function yS(n){return(typeof n=="string"?n:""+n).replace(BP,`
`).replace(zP,"")}function gg(n,e,t){if(e=yS(e),yS(n)!==e&&t)throw Error(j(425))}function Dm(){}var w0=null,x0=null;function S0(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var b0=typeof setTimeout=="function"?setTimeout:void 0,UP=typeof clearTimeout=="function"?clearTimeout:void 0,vS=typeof Promise=="function"?Promise:void 0,$P=typeof queueMicrotask=="function"?queueMicrotask:typeof vS<"u"?function(n){return vS.resolve(null).then(n).catch(HP)}:b0;function HP(n){setTimeout(function(){throw n})}function Pv(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),jd(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);jd(e)}function ra(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function wS(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Ph=Math.random().toString(36).slice(2),Oi="__reactFiber$"+Ph,$d="__reactProps$"+Ph,Br="__reactContainer$"+Ph,A0="__reactEvents$"+Ph,VP="__reactListeners$"+Ph,GP="__reactHandles$"+Ph;function La(n){var e=n[Oi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Br]||t[Oi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=wS(n);n!==null;){if(t=n[Oi])return t;n=wS(n)}return e}n=t,t=n.parentNode}return null}function Gp(n){return n=n[Oi]||n[Br],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function bc(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(j(33))}function Fy(n){return n[$d]||null}var E0=[],Ac=-1;function wa(n){return{current:n}}function Xe(n){0>Ac||(n.current=E0[Ac],E0[Ac]=null,Ac--)}function $e(n,e){Ac++,E0[Ac]=n.current,n.current=e}var da={},hn=wa(da),jn=wa(!1),Xl=da;function yh(n,e){var t=n.type.contextTypes;if(!t)return da;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function On(n){return n=n.childContextTypes,n!=null}function Im(){Xe(jn),Xe(hn)}function xS(n,e,t){if(hn.current!==da)throw Error(j(168));$e(hn,e),$e(jn,t)}function ZA(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(j(108,PT(n)||"Unknown",i));return ot({},t,s)}function Fm(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||da,Xl=hn.current,$e(hn,n),$e(jn,jn.current),!0}function SS(n,e,t){var s=n.stateNode;if(!s)throw Error(j(169));t?(n=ZA(n,e,Xl),s.__reactInternalMemoizedMergedChildContext=n,Xe(jn),Xe(hn),$e(hn,n)):Xe(jn),$e(jn,t)}var Ji=null,jy=!1,Lv=!1;function eE(n){Ji===null?Ji=[n]:Ji.push(n)}function WP(n){jy=!0,eE(n)}function xa(){if(!Lv&&Ji!==null){Lv=!0;var n=0,e=Le;try{var t=Ji;for(Le=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}Ji=null,jy=!1}catch(i){throw Ji!==null&&(Ji=Ji.slice(n+1)),CA(Nx,xa),i}finally{Le=e,Lv=!1}}return null}var Ec=[],Cc=0,jm=null,Om=0,Ts=[],Ps=0,ql=null,Mr=1,Dr="";function ba(n,e){Ec[Cc++]=Om,Ec[Cc++]=jm,jm=n,Om=e}function tE(n,e,t){Ts[Ps++]=Mr,Ts[Ps++]=Dr,Ts[Ps++]=ql,ql=n;var s=Mr;n=Dr;var i=32-ri(s)-1;s&=~(1<<i),t+=1;var r=32-ri(e)+i;if(30<r){var o=i-i%5;r=(s&(1<<o)-1).toString(32),s>>=o,i-=o,Mr=1<<32-ri(e)+i|t<<i|s,Dr=r+n}else Mr=1<<r|t<<i|s,Dr=n}function zx(n){n.return!==null&&(ba(n,1),tE(n,1,0))}function Ux(n){for(;n===jm;)jm=Ec[--Cc],Ec[Cc]=null,Om=Ec[--Cc],Ec[Cc]=null;for(;n===ql;)ql=Ts[--Ps],Ts[Ps]=null,Dr=Ts[--Ps],Ts[Ps]=null,Mr=Ts[--Ps],Ts[Ps]=null}var cs=null,ls=null,Qe=!1,si=null;function nE(n,e){var t=Rs(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function bS(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,cs=n,ls=ra(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,cs=n,ls=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ql!==null?{id:Mr,overflow:Dr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Rs(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,cs=n,ls=null,!0):!1;default:return!1}}function C0(n){return(n.mode&1)!==0&&(n.flags&128)===0}function _0(n){if(Qe){var e=ls;if(e){var t=e;if(!bS(n,e)){if(C0(n))throw Error(j(418));e=ra(t.nextSibling);var s=cs;e&&bS(n,e)?nE(s,t):(n.flags=n.flags&-4097|2,Qe=!1,cs=n)}}else{if(C0(n))throw Error(j(418));n.flags=n.flags&-4097|2,Qe=!1,cs=n}}}function AS(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;cs=n}function mg(n){if(n!==cs)return!1;if(!Qe)return AS(n),Qe=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!S0(n.type,n.memoizedProps)),e&&(e=ls)){if(C0(n))throw sE(),Error(j(418));for(;e;)nE(n,e),e=ra(e.nextSibling)}if(AS(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(j(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ls=ra(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ls=null}}else ls=cs?ra(n.stateNode.nextSibling):null;return!0}function sE(){for(var n=ls;n;)n=ra(n.nextSibling)}function vh(){ls=cs=null,Qe=!1}function $x(n){si===null?si=[n]:si.push(n)}var XP=Wr.ReactCurrentBatchConfig;function Uh(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(j(309));var s=t.stateNode}if(!s)throw Error(j(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(o){var l=i.refs;o===null?delete l[r]:l[r]=o},e._stringRef=r,e)}if(typeof n!="string")throw Error(j(284));if(!t._owner)throw Error(j(290,n))}return n}function yg(n,e){throw n=Object.prototype.toString.call(e),Error(j(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ES(n){var e=n._init;return e(n._payload)}function iE(n){function e(y,w){if(n){var v=y.deletions;v===null?(y.deletions=[w],y.flags|=16):v.push(w)}}function t(y,w){if(!n)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function s(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function i(y,w){return y=ca(y,w),y.index=0,y.sibling=null,y}function r(y,w,v){return y.index=v,n?(v=y.alternate,v!==null?(v=v.index,v<w?(y.flags|=2,w):v):(y.flags|=2,w)):(y.flags|=1048576,w)}function o(y){return n&&y.alternate===null&&(y.flags|=2),y}function l(y,w,v,E){return w===null||w.tag!==6?(w=jv(v,y.mode,E),w.return=y,w):(w=i(w,v),w.return=y,w)}function c(y,w,v,E){var _=v.type;return _===vc?h(y,w,v.props.children,E,v.key):w!==null&&(w.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Zr&&ES(_)===w.type)?(E=i(w,v.props),E.ref=Uh(y,w,v),E.return=y,E):(E=Xg(v.type,v.key,v.props,null,y.mode,E),E.ref=Uh(y,w,v),E.return=y,E)}function u(y,w,v,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=Ov(v,y.mode,E),w.return=y,w):(w=i(w,v.children||[]),w.return=y,w)}function h(y,w,v,E,_){return w===null||w.tag!==7?(w=Wl(v,y.mode,E,_),w.return=y,w):(w=i(w,v),w.return=y,w)}function d(y,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=jv(""+w,y.mode,v),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case og:return v=Xg(w.type,w.key,w.props,null,y.mode,v),v.ref=Uh(y,null,w),v.return=y,v;case yc:return w=Ov(w,y.mode,v),w.return=y,w;case Zr:var E=w._init;return d(y,E(w._payload),v)}if(Kh(w)||Fh(w))return w=Wl(w,y.mode,v,null),w.return=y,w;yg(y,w)}return null}function f(y,w,v,E){var _=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return _!==null?null:l(y,w,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case og:return v.key===_?c(y,w,v,E):null;case yc:return v.key===_?u(y,w,v,E):null;case Zr:return _=v._init,f(y,w,_(v._payload),E)}if(Kh(v)||Fh(v))return _!==null?null:h(y,w,v,E,null);yg(y,v)}return null}function m(y,w,v,E,_){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(v)||null,l(w,y,""+E,_);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case og:return y=y.get(E.key===null?v:E.key)||null,c(w,y,E,_);case yc:return y=y.get(E.key===null?v:E.key)||null,u(w,y,E,_);case Zr:var k=E._init;return m(y,w,v,k(E._payload),_)}if(Kh(E)||Fh(E))return y=y.get(v)||null,h(w,y,E,_,null);yg(w,E)}return null}function S(y,w,v,E){for(var _=null,k=null,T=w,L=w=0,R=null;T!==null&&L<v.length;L++){T.index>L?(R=T,T=null):R=T.sibling;var N=f(y,T,v[L],E);if(N===null){T===null&&(T=R);break}n&&T&&N.alternate===null&&e(y,T),w=r(N,w,L),k===null?_=N:k.sibling=N,k=N,T=R}if(L===v.length)return t(y,T),Qe&&ba(y,L),_;if(T===null){for(;L<v.length;L++)T=d(y,v[L],E),T!==null&&(w=r(T,w,L),k===null?_=T:k.sibling=T,k=T);return Qe&&ba(y,L),_}for(T=s(y,T);L<v.length;L++)R=m(T,y,L,v[L],E),R!==null&&(n&&R.alternate!==null&&T.delete(R.key===null?L:R.key),w=r(R,w,L),k===null?_=R:k.sibling=R,k=R);return n&&T.forEach(function(M){return e(y,M)}),Qe&&ba(y,L),_}function x(y,w,v,E){var _=Fh(v);if(typeof _!="function")throw Error(j(150));if(v=_.call(v),v==null)throw Error(j(151));for(var k=_=null,T=w,L=w=0,R=null,N=v.next();T!==null&&!N.done;L++,N=v.next()){T.index>L?(R=T,T=null):R=T.sibling;var M=f(y,T,N.value,E);if(M===null){T===null&&(T=R);break}n&&T&&M.alternate===null&&e(y,T),w=r(M,w,L),k===null?_=M:k.sibling=M,k=M,T=R}if(N.done)return t(y,T),Qe&&ba(y,L),_;if(T===null){for(;!N.done;L++,N=v.next())N=d(y,N.value,E),N!==null&&(w=r(N,w,L),k===null?_=N:k.sibling=N,k=N);return Qe&&ba(y,L),_}for(T=s(y,T);!N.done;L++,N=v.next())N=m(T,y,L,N.value,E),N!==null&&(n&&N.alternate!==null&&T.delete(N.key===null?L:N.key),w=r(N,w,L),k===null?_=N:k.sibling=N,k=N);return n&&T.forEach(function(O){return e(y,O)}),Qe&&ba(y,L),_}function C(y,w,v,E){if(typeof v=="object"&&v!==null&&v.type===vc&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case og:e:{for(var _=v.key,k=w;k!==null;){if(k.key===_){if(_=v.type,_===vc){if(k.tag===7){t(y,k.sibling),w=i(k,v.props.children),w.return=y,y=w;break e}}else if(k.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Zr&&ES(_)===k.type){t(y,k.sibling),w=i(k,v.props),w.ref=Uh(y,k,v),w.return=y,y=w;break e}t(y,k);break}else e(y,k);k=k.sibling}v.type===vc?(w=Wl(v.props.children,y.mode,E,v.key),w.return=y,y=w):(E=Xg(v.type,v.key,v.props,null,y.mode,E),E.ref=Uh(y,w,v),E.return=y,y=E)}return o(y);case yc:e:{for(k=v.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){t(y,w.sibling),w=i(w,v.children||[]),w.return=y,y=w;break e}else{t(y,w);break}else e(y,w);w=w.sibling}w=Ov(v,y.mode,E),w.return=y,y=w}return o(y);case Zr:return k=v._init,C(y,w,k(v._payload),E)}if(Kh(v))return S(y,w,v,E);if(Fh(v))return x(y,w,v,E);yg(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(t(y,w.sibling),w=i(w,v),w.return=y,y=w):(t(y,w),w=jv(v,y.mode,E),w.return=y,y=w),o(y)):t(y,w)}return C}var wh=iE(!0),rE=iE(!1),Bm=wa(null),zm=null,_c=null,Hx=null;function Vx(){Hx=_c=zm=null}function Gx(n){var e=Bm.current;Xe(Bm),n._currentValue=e}function k0(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function Oc(n,e){zm=n,Hx=_c=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Fn=!0),n.firstContext=null)}function Fs(n){var e=n._currentValue;if(Hx!==n)if(n={context:n,memoizedValue:e,next:null},_c===null){if(zm===null)throw Error(j(308));_c=n,zm.dependencies={lanes:0,firstContext:n}}else _c=_c.next=n;return e}var Na=null;function Wx(n){Na===null?Na=[n]:Na.push(n)}function oE(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,Wx(e)):(t.next=i.next,i.next=t),e.interleaved=t,zr(n,s)}function zr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var eo=!1;function Xx(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aE(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ir(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function oa(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,xe&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,zr(n,t)}return i=s.interleaved,i===null?(e.next=e,Wx(s)):(e.next=i.next,i.next=e),s.interleaved=e,zr(n,t)}function Ug(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,Rx(n,t)}}function CS(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=o:r=r.next=o,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Um(n,e,t,s){var i=n.updateQueue;eo=!1;var r=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?r=u:o.next=u,o=c;var h=n.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(r!==null){var d=i.baseState;o=0,h=u=c=null,l=r;do{var f=l.lane,m=l.eventTime;if((s&f)===f){h!==null&&(h=h.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=n,x=l;switch(f=e,m=t,x.tag){case 1:if(S=x.payload,typeof S=="function"){d=S.call(m,d,f);break e}d=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=x.payload,f=typeof S=="function"?S.call(m,d,f):S,f==null)break e;d=ot({},d,f);break e;case 2:eo=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,f=i.effects,f===null?i.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=m,c=d):h=h.next=m,o|=f;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;f=l,l=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(h===null&&(c=d),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);Kl|=o,n.lanes=o,n.memoizedState=d}}function _S(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(j(191,i));i.call(s)}}}var Wp={},$i=wa(Wp),Hd=wa(Wp),Vd=wa(Wp);function Ra(n){if(n===Wp)throw Error(j(174));return n}function qx(n,e){switch($e(Vd,e),$e(Hd,n),$e($i,Wp),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:a0(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=a0(e,n)}Xe($i),$e($i,e)}function xh(){Xe($i),Xe(Hd),Xe(Vd)}function lE(n){Ra(Vd.current);var e=Ra($i.current),t=a0(e,n.type);e!==t&&($e(Hd,n),$e($i,t))}function Yx(n){Hd.current===n&&(Xe($i),Xe(Hd))}var et=wa(0);function $m(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Nv=[];function Kx(){for(var n=0;n<Nv.length;n++)Nv[n]._workInProgressVersionPrimary=null;Nv.length=0}var $g=Wr.ReactCurrentDispatcher,Rv=Wr.ReactCurrentBatchConfig,Yl=0,st=null,kt=null,jt=null,Hm=!1,kd=!1,Gd=0,qP=0;function Jt(){throw Error(j(321))}function Qx(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!ai(n[t],e[t]))return!1;return!0}function Jx(n,e,t,s,i,r){if(Yl=r,st=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$g.current=n===null||n.memoizedState===null?JP:ZP,n=t(s,i),kd){r=0;do{if(kd=!1,Gd=0,25<=r)throw Error(j(301));r+=1,jt=kt=null,e.updateQueue=null,$g.current=e2,n=t(s,i)}while(kd)}if($g.current=Vm,e=kt!==null&&kt.next!==null,Yl=0,jt=kt=st=null,Hm=!1,e)throw Error(j(300));return n}function Zx(){var n=Gd!==0;return Gd=0,n}function pi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?st.memoizedState=jt=n:jt=jt.next=n,jt}function js(){if(kt===null){var n=st.alternate;n=n!==null?n.memoizedState:null}else n=kt.next;var e=jt===null?st.memoizedState:jt.next;if(e!==null)jt=e,kt=n;else{if(n===null)throw Error(j(310));kt=n,n={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},jt===null?st.memoizedState=jt=n:jt=jt.next=n}return jt}function Wd(n,e){return typeof e=="function"?e(n):e}function Mv(n){var e=js(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var s=kt,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var o=i.next;i.next=r.next,r.next=o}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var l=o=null,c=null,u=r;do{var h=u.lane;if((Yl&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=d,o=s):c=c.next=d,st.lanes|=h,Kl|=h}u=u.next}while(u!==null&&u!==r);c===null?o=s:c.next=l,ai(s,e.memoizedState)||(Fn=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,st.lanes|=r,Kl|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Dv(n){var e=js(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do r=n(r,o.action),o=o.next;while(o!==i);ai(r,e.memoizedState)||(Fn=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function cE(){}function uE(n,e){var t=st,s=js(),i=e(),r=!ai(s.memoizedState,i);if(r&&(s.memoizedState=i,Fn=!0),s=s.queue,e1(fE.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||jt!==null&&jt.memoizedState.tag&1){if(t.flags|=2048,Xd(9,dE.bind(null,t,s,i,e),void 0,null),Ot===null)throw Error(j(349));Yl&30||hE(t,e,i)}return i}function hE(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function dE(n,e,t,s){e.value=t,e.getSnapshot=s,pE(e)&&gE(n)}function fE(n,e,t){return t(function(){pE(e)&&gE(n)})}function pE(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!ai(n,t)}catch{return!0}}function gE(n){var e=zr(n,1);e!==null&&oi(e,n,1,-1)}function kS(n){var e=pi();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wd,lastRenderedState:n},e.queue=n,n=n.dispatch=QP.bind(null,st,n),[e.memoizedState,n]}function Xd(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function mE(){return js().memoizedState}function Hg(n,e,t,s){var i=pi();st.flags|=n,i.memoizedState=Xd(1|e,t,void 0,s===void 0?null:s)}function Oy(n,e,t,s){var i=js();s=s===void 0?null:s;var r=void 0;if(kt!==null){var o=kt.memoizedState;if(r=o.destroy,s!==null&&Qx(s,o.deps)){i.memoizedState=Xd(e,t,r,s);return}}st.flags|=n,i.memoizedState=Xd(1|e,t,r,s)}function TS(n,e){return Hg(8390656,8,n,e)}function e1(n,e){return Oy(2048,8,n,e)}function yE(n,e){return Oy(4,2,n,e)}function vE(n,e){return Oy(4,4,n,e)}function wE(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function xE(n,e,t){return t=t!=null?t.concat([n]):null,Oy(4,4,wE.bind(null,e,n),t)}function t1(){}function SE(n,e){var t=js();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Qx(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function bE(n,e){var t=js();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Qx(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function AE(n,e,t){return Yl&21?(ai(t,e)||(t=TA(),st.lanes|=t,Kl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Fn=!0),n.memoizedState=t)}function YP(n,e){var t=Le;Le=t!==0&&4>t?t:4,n(!0);var s=Rv.transition;Rv.transition={};try{n(!1),e()}finally{Le=t,Rv.transition=s}}function EE(){return js().memoizedState}function KP(n,e,t){var s=la(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},CE(n))_E(e,t);else if(t=oE(n,e,t,s),t!==null){var i=Sn();oi(t,n,s,i),kE(t,e,s)}}function QP(n,e,t){var s=la(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(CE(n))_E(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var o=e.lastRenderedState,l=r(o,t);if(i.hasEagerState=!0,i.eagerState=l,ai(l,o)){var c=e.interleaved;c===null?(i.next=i,Wx(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=oE(n,e,i,s),t!==null&&(i=Sn(),oi(t,n,s,i),kE(t,e,s))}}function CE(n){var e=n.alternate;return n===st||e!==null&&e===st}function _E(n,e){kd=Hm=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function kE(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,Rx(n,t)}}var Vm={readContext:Fs,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},JP={readContext:Fs,useCallback:function(n,e){return pi().memoizedState=[n,e===void 0?null:e],n},useContext:Fs,useEffect:TS,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Hg(4194308,4,wE.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Hg(4194308,4,n,e)},useInsertionEffect:function(n,e){return Hg(4,2,n,e)},useMemo:function(n,e){var t=pi();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=pi();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=KP.bind(null,st,n),[s.memoizedState,n]},useRef:function(n){var e=pi();return n={current:n},e.memoizedState=n},useState:kS,useDebugValue:t1,useDeferredValue:function(n){return pi().memoizedState=n},useTransition:function(){var n=kS(!1),e=n[0];return n=YP.bind(null,n[1]),pi().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=st,i=pi();if(Qe){if(t===void 0)throw Error(j(407));t=t()}else{if(t=e(),Ot===null)throw Error(j(349));Yl&30||hE(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,TS(fE.bind(null,s,r,n),[n]),s.flags|=2048,Xd(9,dE.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=pi(),e=Ot.identifierPrefix;if(Qe){var t=Dr,s=Mr;t=(s&~(1<<32-ri(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Gd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=qP++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},ZP={readContext:Fs,useCallback:SE,useContext:Fs,useEffect:e1,useImperativeHandle:xE,useInsertionEffect:yE,useLayoutEffect:vE,useMemo:bE,useReducer:Mv,useRef:mE,useState:function(){return Mv(Wd)},useDebugValue:t1,useDeferredValue:function(n){var e=js();return AE(e,kt.memoizedState,n)},useTransition:function(){var n=Mv(Wd)[0],e=js().memoizedState;return[n,e]},useMutableSource:cE,useSyncExternalStore:uE,useId:EE,unstable_isNewReconciler:!1},e2={readContext:Fs,useCallback:SE,useContext:Fs,useEffect:e1,useImperativeHandle:xE,useInsertionEffect:yE,useLayoutEffect:vE,useMemo:bE,useReducer:Dv,useRef:mE,useState:function(){return Dv(Wd)},useDebugValue:t1,useDeferredValue:function(n){var e=js();return kt===null?e.memoizedState=n:AE(e,kt.memoizedState,n)},useTransition:function(){var n=Dv(Wd)[0],e=js().memoizedState;return[n,e]},useMutableSource:cE,useSyncExternalStore:uE,useId:EE,unstable_isNewReconciler:!1};function Hs(n,e){if(n&&n.defaultProps){e=ot({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function T0(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:ot({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var By={isMounted:function(n){return(n=n._reactInternals)?tc(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=Sn(),i=la(n),r=Ir(s,i);r.payload=e,t!=null&&(r.callback=t),e=oa(n,r,i),e!==null&&(oi(e,n,i,s),Ug(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=Sn(),i=la(n),r=Ir(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=oa(n,r,i),e!==null&&(oi(e,n,i,s),Ug(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Sn(),s=la(n),i=Ir(t,s);i.tag=2,e!=null&&(i.callback=e),e=oa(n,i,s),e!==null&&(oi(e,n,s,t),Ug(e,n,s))}};function PS(n,e,t,s,i,r,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,o):e.prototype&&e.prototype.isPureReactComponent?!Bd(t,s)||!Bd(i,r):!0}function TE(n,e,t){var s=!1,i=da,r=e.contextType;return typeof r=="object"&&r!==null?r=Fs(r):(i=On(e)?Xl:hn.current,s=e.contextTypes,r=(s=s!=null)?yh(n,i):da),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=By,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function LS(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&By.enqueueReplaceState(e,e.state,null)}function P0(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},Xx(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=Fs(r):(r=On(e)?Xl:hn.current,i.context=yh(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(T0(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&By.enqueueReplaceState(i,i.state,null),Um(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Sh(n,e){try{var t="",s=e;do t+=TT(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function Iv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function L0(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var t2=typeof WeakMap=="function"?WeakMap:Map;function PE(n,e,t){t=Ir(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){Wm||(Wm=!0,z0=s),L0(n,e)},t}function LE(n,e,t){t=Ir(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){L0(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){L0(n,e),typeof s!="function"&&(aa===null?aa=new Set([this]):aa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function NS(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new t2;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=g2.bind(null,n,e,t),e.then(n,n))}function RS(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function MS(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ir(-1,1),e.tag=2,oa(t,e,1))),t.lanes|=1),n)}var n2=Wr.ReactCurrentOwner,Fn=!1;function wn(n,e,t,s){e.child=n===null?rE(e,null,t,s):wh(e,n.child,t,s)}function DS(n,e,t,s,i){t=t.render;var r=e.ref;return Oc(e,i),s=Jx(n,e,t,s,r,i),t=Zx(),n!==null&&!Fn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ur(n,e,i)):(Qe&&t&&zx(e),e.flags|=1,wn(n,e,s,i),e.child)}function IS(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!c1(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,NE(n,e,r,s,i)):(n=Xg(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var o=r.memoizedProps;if(t=t.compare,t=t!==null?t:Bd,t(o,s)&&n.ref===e.ref)return Ur(n,e,i)}return e.flags|=1,n=ca(r,s),n.ref=e.ref,n.return=e,e.child=n}function NE(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Bd(r,s)&&n.ref===e.ref)if(Fn=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(Fn=!0);else return e.lanes=n.lanes,Ur(n,e,i)}return N0(n,e,t,s,i)}function RE(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$e(Tc,rs),rs|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,$e(Tc,rs),rs|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,$e(Tc,rs),rs|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,$e(Tc,rs),rs|=s;return wn(n,e,i,t),e.child}function ME(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function N0(n,e,t,s,i){var r=On(t)?Xl:hn.current;return r=yh(e,r),Oc(e,i),t=Jx(n,e,t,s,r,i),s=Zx(),n!==null&&!Fn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ur(n,e,i)):(Qe&&s&&zx(e),e.flags|=1,wn(n,e,t,i),e.child)}function FS(n,e,t,s,i){if(On(t)){var r=!0;Fm(e)}else r=!1;if(Oc(e,i),e.stateNode===null)Vg(n,e),TE(e,t,s),P0(e,t,s,i),s=!0;else if(n===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Fs(u):(u=On(t)?Xl:hn.current,u=yh(e,u));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==u)&&LS(e,o,s,u),eo=!1;var f=e.memoizedState;o.state=f,Um(e,s,o,i),c=e.memoizedState,l!==s||f!==c||jn.current||eo?(typeof h=="function"&&(T0(e,t,h,s),c=e.memoizedState),(l=eo||PS(e,t,l,s,f,c,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=u,s=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,aE(n,e),l=e.memoizedProps,u=e.type===e.elementType?l:Hs(e.type,l),o.props=u,d=e.pendingProps,f=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=Fs(c):(c=On(t)?Xl:hn.current,c=yh(e,c));var m=t.getDerivedStateFromProps;(h=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==d||f!==c)&&LS(e,o,s,c),eo=!1,f=e.memoizedState,o.state=f,Um(e,s,o,i);var S=e.memoizedState;l!==d||f!==S||jn.current||eo?(typeof m=="function"&&(T0(e,t,m,s),S=e.memoizedState),(u=eo||PS(e,t,u,s,f,S,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,S,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,S,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=S),o.props=s,o.state=S,o.context=c,s=u):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),s=!1)}return R0(n,e,t,s,r,i)}function R0(n,e,t,s,i,r){ME(n,e);var o=(e.flags&128)!==0;if(!s&&!o)return i&&SS(e,t,!1),Ur(n,e,r);s=e.stateNode,n2.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&o?(e.child=wh(e,n.child,null,r),e.child=wh(e,null,l,r)):wn(n,e,l,r),e.memoizedState=s.state,i&&SS(e,t,!0),e.child}function DE(n){var e=n.stateNode;e.pendingContext?xS(n,e.pendingContext,e.pendingContext!==e.context):e.context&&xS(n,e.context,!1),qx(n,e.containerInfo)}function jS(n,e,t,s,i){return vh(),$x(i),e.flags|=256,wn(n,e,t,s),e.child}var M0={dehydrated:null,treeContext:null,retryLane:0};function D0(n){return{baseLanes:n,cachePool:null,transitions:null}}function IE(n,e,t){var s=e.pendingProps,i=et.current,r=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),$e(et,i&1),n===null)return _0(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,n=s.fallback,r?(s=e.mode,r=e.child,o={mode:"hidden",children:o},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=$y(o,s,0,null),n=Wl(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=D0(t),e.memoizedState=M0,n):n1(e,o));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return s2(n,e,o,s,l,i,t);if(r){r=s.fallback,o=e.mode,i=n.child,l=i.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=ca(i,c),s.subtreeFlags=i.subtreeFlags&14680064),l!==null?r=ca(l,r):(r=Wl(r,o,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,o=n.child.memoizedState,o=o===null?D0(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=n.childLanes&~t,e.memoizedState=M0,s}return r=n.child,n=r.sibling,s=ca(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function n1(n,e){return e=$y({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function vg(n,e,t,s){return s!==null&&$x(s),wh(e,n.child,null,t),n=n1(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function s2(n,e,t,s,i,r,o){if(t)return e.flags&256?(e.flags&=-257,s=Iv(Error(j(422))),vg(n,e,o,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=$y({mode:"visible",children:s.children},i,0,null),r=Wl(r,i,o,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&wh(e,n.child,null,o),e.child.memoizedState=D0(o),e.memoizedState=M0,r);if(!(e.mode&1))return vg(n,e,o,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var l=s.dgst;return s=l,r=Error(j(419)),s=Iv(r,s,void 0),vg(n,e,o,s)}if(l=(o&n.childLanes)!==0,Fn||l){if(s=Ot,s!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|o)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,zr(n,i),oi(s,n,i,-1))}return l1(),s=Iv(Error(j(421))),vg(n,e,o,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=m2.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,ls=ra(i.nextSibling),cs=e,Qe=!0,si=null,n!==null&&(Ts[Ps++]=Mr,Ts[Ps++]=Dr,Ts[Ps++]=ql,Mr=n.id,Dr=n.overflow,ql=e),e=n1(e,s.children),e.flags|=4096,e)}function OS(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),k0(n.return,e,t)}function Fv(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function FE(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(wn(n,e,s.children,t),s=et.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&OS(n,t,e);else if(n.tag===19)OS(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if($e(et,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&$m(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),Fv(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&$m(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}Fv(e,!0,t,null,r);break;case"together":Fv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vg(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ur(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Kl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(j(153));if(e.child!==null){for(n=e.child,t=ca(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ca(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function i2(n,e,t){switch(e.tag){case 3:DE(e),vh();break;case 5:lE(e);break;case 1:On(e.type)&&Fm(e);break;case 4:qx(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;$e(Bm,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?($e(et,et.current&1),e.flags|=128,null):t&e.child.childLanes?IE(n,e,t):($e(et,et.current&1),n=Ur(n,e,t),n!==null?n.sibling:null);$e(et,et.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return FE(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),$e(et,et.current),s)break;return null;case 22:case 23:return e.lanes=0,RE(n,e,t)}return Ur(n,e,t)}var jE,I0,OE,BE;jE=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};I0=function(){};OE=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,Ra($i.current);var r=null;switch(t){case"input":i=s0(n,i),s=s0(n,s),r=[];break;case"select":i=ot({},i,{value:void 0}),s=ot({},s,{value:void 0}),r=[];break;case"textarea":i=o0(n,i),s=o0(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=Dm)}l0(t,s);var o;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Rd.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var c=s[u];if(l=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Rd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ge("scroll",n),r||l===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};BE=function(n,e,t,s){t!==s&&(e.flags|=4)};function $h(n,e){if(!Qe)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Zt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function r2(n,e,t){var s=e.pendingProps;switch(Ux(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(e),null;case 1:return On(e.type)&&Im(),Zt(e),null;case 3:return s=e.stateNode,xh(),Xe(jn),Xe(hn),Kx(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(mg(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,si!==null&&(H0(si),si=null))),I0(n,e),Zt(e),null;case 5:Yx(e);var i=Ra(Vd.current);if(t=e.type,n!==null&&e.stateNode!=null)OE(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(j(166));return Zt(e),null}if(n=Ra($i.current),mg(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[Oi]=e,s[$d]=r,n=(e.mode&1)!==0,t){case"dialog":Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":case"embed":Ge("load",s);break;case"video":case"audio":for(i=0;i<Jh.length;i++)Ge(Jh[i],s);break;case"source":Ge("error",s);break;case"img":case"image":case"link":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"input":X1(s,r),Ge("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},Ge("invalid",s);break;case"textarea":Y1(s,r),Ge("invalid",s)}l0(t,r),i=null;for(var o in r)if(r.hasOwnProperty(o)){var l=r[o];o==="children"?typeof l=="string"?s.textContent!==l&&(r.suppressHydrationWarning!==!0&&gg(s.textContent,l,n),i=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(r.suppressHydrationWarning!==!0&&gg(s.textContent,l,n),i=["children",""+l]):Rd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ge("scroll",s)}switch(t){case"input":ag(s),q1(s,r,!0);break;case"textarea":ag(s),K1(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=Dm)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=fA(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=o.createElement(t,{is:s.is}):(n=o.createElement(t),t==="select"&&(o=n,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):n=o.createElementNS(n,t),n[Oi]=e,n[$d]=s,jE(n,e,!1,!1),e.stateNode=n;e:{switch(o=c0(t,s),t){case"dialog":Ge("cancel",n),Ge("close",n),i=s;break;case"iframe":case"object":case"embed":Ge("load",n),i=s;break;case"video":case"audio":for(i=0;i<Jh.length;i++)Ge(Jh[i],n);i=s;break;case"source":Ge("error",n),i=s;break;case"img":case"image":case"link":Ge("error",n),Ge("load",n),i=s;break;case"details":Ge("toggle",n),i=s;break;case"input":X1(n,s),i=s0(n,s),Ge("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=ot({},s,{value:void 0}),Ge("invalid",n);break;case"textarea":Y1(n,s),i=o0(n,s),Ge("invalid",n);break;default:i=s}l0(t,i),l=i;for(r in l)if(l.hasOwnProperty(r)){var c=l[r];r==="style"?mA(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&pA(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Md(n,c):typeof c=="number"&&Md(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Rd.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Ge("scroll",n):c!=null&&_x(n,r,c,o))}switch(t){case"input":ag(n),q1(n,s,!1);break;case"textarea":ag(n),K1(n);break;case"option":s.value!=null&&n.setAttribute("value",""+ha(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?Dc(n,!!s.multiple,r,!1):s.defaultValue!=null&&Dc(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Dm)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zt(e),null;case 6:if(n&&e.stateNode!=null)BE(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(j(166));if(t=Ra(Vd.current),Ra($i.current),mg(e)){if(s=e.stateNode,t=e.memoizedProps,s[Oi]=e,(r=s.nodeValue!==t)&&(n=cs,n!==null))switch(n.tag){case 3:gg(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&gg(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[Oi]=e,e.stateNode=s}return Zt(e),null;case 13:if(Xe(et),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Qe&&ls!==null&&e.mode&1&&!(e.flags&128))sE(),vh(),e.flags|=98560,r=!1;else if(r=mg(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(j(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(j(317));r[Oi]=e}else vh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zt(e),r=!1}else si!==null&&(H0(si),si=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||et.current&1?Tt===0&&(Tt=3):l1())),e.updateQueue!==null&&(e.flags|=4),Zt(e),null);case 4:return xh(),I0(n,e),n===null&&zd(e.stateNode.containerInfo),Zt(e),null;case 10:return Gx(e.type._context),Zt(e),null;case 17:return On(e.type)&&Im(),Zt(e),null;case 19:if(Xe(et),r=e.memoizedState,r===null)return Zt(e),null;if(s=(e.flags&128)!==0,o=r.rendering,o===null)if(s)$h(r,!1);else{if(Tt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=$m(n),o!==null){for(e.flags|=128,$h(r,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return $e(et,et.current&1|2),e.child}n=n.sibling}r.tail!==null&&yt()>bh&&(e.flags|=128,s=!0,$h(r,!1),e.lanes=4194304)}else{if(!s)if(n=$m(o),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),$h(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!Qe)return Zt(e),null}else 2*yt()-r.renderingStartTime>bh&&t!==1073741824&&(e.flags|=128,s=!0,$h(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=yt(),e.sibling=null,t=et.current,$e(et,s?t&1|2:t&1),e):(Zt(e),null);case 22:case 23:return a1(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?rs&1073741824&&(Zt(e),e.subtreeFlags&6&&(e.flags|=8192)):Zt(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function o2(n,e){switch(Ux(e),e.tag){case 1:return On(e.type)&&Im(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return xh(),Xe(jn),Xe(hn),Kx(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Yx(e),null;case 13:if(Xe(et),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(j(340));vh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Xe(et),null;case 4:return xh(),null;case 10:return Gx(e.type._context),null;case 22:case 23:return a1(),null;case 24:return null;default:return null}}var wg=!1,cn=!1,a2=typeof WeakSet=="function"?WeakSet:Set,q=null;function kc(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){ft(n,e,s)}else t.current=null}function F0(n,e,t){try{t()}catch(s){ft(n,e,s)}}var BS=!1;function l2(n,e){if(w0=Nm,n=VA(),Bx(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=n,f=null;t:for(;;){for(var m;d!==t||i!==0&&d.nodeType!==3||(l=o+i),d!==r||s!==0&&d.nodeType!==3||(c=o+s),d.nodeType===3&&(o+=d.nodeValue.length),(m=d.firstChild)!==null;)f=d,d=m;for(;;){if(d===n)break t;if(f===t&&++u===i&&(l=o),f===r&&++h===s&&(c=o),(m=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=m}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(x0={focusedElem:n,selectionRange:t},Nm=!1,q=e;q!==null;)if(e=q,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,q=n;else for(;q!==null;){e=q;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var x=S.memoizedProps,C=S.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:Hs(e.type,x),C);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(E){ft(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,q=n;break}q=e.return}return S=BS,BS=!1,S}function Td(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&F0(e,t,r)}i=i.next}while(i!==s)}}function zy(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function j0(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function zE(n){var e=n.alternate;e!==null&&(n.alternate=null,zE(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Oi],delete e[$d],delete e[A0],delete e[VP],delete e[GP])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function UE(n){return n.tag===5||n.tag===3||n.tag===4}function zS(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||UE(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function O0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Dm));else if(s!==4&&(n=n.child,n!==null))for(O0(n,e,t),n=n.sibling;n!==null;)O0(n,e,t),n=n.sibling}function B0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(B0(n,e,t),n=n.sibling;n!==null;)B0(n,e,t),n=n.sibling}var Wt=null,ni=!1;function Qr(n,e,t){for(t=t.child;t!==null;)$E(n,e,t),t=t.sibling}function $E(n,e,t){if(Ui&&typeof Ui.onCommitFiberUnmount=="function")try{Ui.onCommitFiberUnmount(Ry,t)}catch{}switch(t.tag){case 5:cn||kc(t,e);case 6:var s=Wt,i=ni;Wt=null,Qr(n,e,t),Wt=s,ni=i,Wt!==null&&(ni?(n=Wt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Wt.removeChild(t.stateNode));break;case 18:Wt!==null&&(ni?(n=Wt,t=t.stateNode,n.nodeType===8?Pv(n.parentNode,t):n.nodeType===1&&Pv(n,t),jd(n)):Pv(Wt,t.stateNode));break;case 4:s=Wt,i=ni,Wt=t.stateNode.containerInfo,ni=!0,Qr(n,e,t),Wt=s,ni=i;break;case 0:case 11:case 14:case 15:if(!cn&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&F0(t,e,o),i=i.next}while(i!==s)}Qr(n,e,t);break;case 1:if(!cn&&(kc(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(l){ft(t,e,l)}Qr(n,e,t);break;case 21:Qr(n,e,t);break;case 22:t.mode&1?(cn=(s=cn)||t.memoizedState!==null,Qr(n,e,t),cn=s):Qr(n,e,t);break;default:Qr(n,e,t)}}function US(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new a2),e.forEach(function(s){var i=y2.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function zs(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Wt=l.stateNode,ni=!1;break e;case 3:Wt=l.stateNode.containerInfo,ni=!0;break e;case 4:Wt=l.stateNode.containerInfo,ni=!0;break e}l=l.return}if(Wt===null)throw Error(j(160));$E(r,o,i),Wt=null,ni=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){ft(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)HE(e,n),e=e.sibling}function HE(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(zs(e,n),ui(n),s&4){try{Td(3,n,n.return),zy(3,n)}catch(x){ft(n,n.return,x)}try{Td(5,n,n.return)}catch(x){ft(n,n.return,x)}}break;case 1:zs(e,n),ui(n),s&512&&t!==null&&kc(t,t.return);break;case 5:if(zs(e,n),ui(n),s&512&&t!==null&&kc(t,t.return),n.flags&32){var i=n.stateNode;try{Md(i,"")}catch(x){ft(n,n.return,x)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,o=t!==null?t.memoizedProps:r,l=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{l==="input"&&r.type==="radio"&&r.name!=null&&hA(i,r),c0(l,o);var u=c0(l,r);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];h==="style"?mA(i,d):h==="dangerouslySetInnerHTML"?pA(i,d):h==="children"?Md(i,d):_x(i,h,d,u)}switch(l){case"input":i0(i,r);break;case"textarea":dA(i,r);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var m=r.value;m!=null?Dc(i,!!r.multiple,m,!1):f!==!!r.multiple&&(r.defaultValue!=null?Dc(i,!!r.multiple,r.defaultValue,!0):Dc(i,!!r.multiple,r.multiple?[]:"",!1))}i[$d]=r}catch(x){ft(n,n.return,x)}}break;case 6:if(zs(e,n),ui(n),s&4){if(n.stateNode===null)throw Error(j(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(x){ft(n,n.return,x)}}break;case 3:if(zs(e,n),ui(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{jd(e.containerInfo)}catch(x){ft(n,n.return,x)}break;case 4:zs(e,n),ui(n);break;case 13:zs(e,n),ui(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(r1=yt())),s&4&&US(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(cn=(u=cn)||h,zs(e,n),cn=u):zs(e,n),ui(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(q=n,h=n.child;h!==null;){for(d=q=h;q!==null;){switch(f=q,m=f.child,f.tag){case 0:case 11:case 14:case 15:Td(4,f,f.return);break;case 1:kc(f,f.return);var S=f.stateNode;if(typeof S.componentWillUnmount=="function"){s=f,t=f.return;try{e=s,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(x){ft(s,t,x)}}break;case 5:kc(f,f.return);break;case 22:if(f.memoizedState!==null){HS(d);continue}}m!==null?(m.return=f,q=m):HS(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{i=d.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(l=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=gA("display",o))}catch(x){ft(n,n.return,x)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(x){ft(n,n.return,x)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:zs(e,n),ui(n),s&4&&US(n);break;case 21:break;default:zs(e,n),ui(n)}}function ui(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(UE(t)){var s=t;break e}t=t.return}throw Error(j(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(Md(i,""),s.flags&=-33);var r=zS(n);B0(n,r,i);break;case 3:case 4:var o=s.stateNode.containerInfo,l=zS(n);O0(n,l,o);break;default:throw Error(j(161))}}catch(c){ft(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function c2(n,e,t){q=n,VE(n)}function VE(n,e,t){for(var s=(n.mode&1)!==0;q!==null;){var i=q,r=i.child;if(i.tag===22&&s){var o=i.memoizedState!==null||wg;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||cn;l=wg;var u=cn;if(wg=o,(cn=c)&&!u)for(q=i;q!==null;)o=q,c=o.child,o.tag===22&&o.memoizedState!==null?VS(i):c!==null?(c.return=o,q=c):VS(i);for(;r!==null;)q=r,VE(r),r=r.sibling;q=i,wg=l,cn=u}$S(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,q=r):$S(n)}}function $S(n){for(;q!==null;){var e=q;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:cn||zy(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!cn)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Hs(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&_S(e,r,s);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}_S(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&jd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}cn||e.flags&512&&j0(e)}catch(f){ft(e,e.return,f)}}if(e===n){q=null;break}if(t=e.sibling,t!==null){t.return=e.return,q=t;break}q=e.return}}function HS(n){for(;q!==null;){var e=q;if(e===n){q=null;break}var t=e.sibling;if(t!==null){t.return=e.return,q=t;break}q=e.return}}function VS(n){for(;q!==null;){var e=q;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{zy(4,e)}catch(c){ft(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){ft(e,i,c)}}var r=e.return;try{j0(e)}catch(c){ft(e,r,c)}break;case 5:var o=e.return;try{j0(e)}catch(c){ft(e,o,c)}}}catch(c){ft(e,e.return,c)}if(e===n){q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,q=l;break}q=e.return}}var u2=Math.ceil,Gm=Wr.ReactCurrentDispatcher,s1=Wr.ReactCurrentOwner,Ms=Wr.ReactCurrentBatchConfig,xe=0,Ot=null,St=null,Kt=0,rs=0,Tc=wa(0),Tt=0,qd=null,Kl=0,Uy=0,i1=0,Pd=null,In=null,r1=0,bh=1/0,Yi=null,Wm=!1,z0=null,aa=null,xg=!1,ea=null,Xm=0,Ld=0,U0=null,Gg=-1,Wg=0;function Sn(){return xe&6?yt():Gg!==-1?Gg:Gg=yt()}function la(n){return n.mode&1?xe&2&&Kt!==0?Kt&-Kt:XP.transition!==null?(Wg===0&&(Wg=TA()),Wg):(n=Le,n!==0||(n=window.event,n=n===void 0?16:IA(n.type)),n):1}function oi(n,e,t,s){if(50<Ld)throw Ld=0,U0=null,Error(j(185));Hp(n,t,s),(!(xe&2)||n!==Ot)&&(n===Ot&&(!(xe&2)&&(Uy|=t),Tt===4&&no(n,Kt)),Bn(n,s),t===1&&xe===0&&!(e.mode&1)&&(bh=yt()+500,jy&&xa()))}function Bn(n,e){var t=n.callbackNode;XT(n,e);var s=Lm(n,n===Ot?Kt:0);if(s===0)t!==null&&Z1(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&Z1(t),e===1)n.tag===0?WP(GS.bind(null,n)):eE(GS.bind(null,n)),$P(function(){!(xe&6)&&xa()}),t=null;else{switch(PA(s)){case 1:t=Nx;break;case 4:t=_A;break;case 16:t=Pm;break;case 536870912:t=kA;break;default:t=Pm}t=JE(t,GE.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function GE(n,e){if(Gg=-1,Wg=0,xe&6)throw Error(j(327));var t=n.callbackNode;if(Bc()&&n.callbackNode!==t)return null;var s=Lm(n,n===Ot?Kt:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=qm(n,s);else{e=s;var i=xe;xe|=2;var r=XE();(Ot!==n||Kt!==e)&&(Yi=null,bh=yt()+500,Gl(n,e));do try{f2();break}catch(l){WE(n,l)}while(!0);Vx(),Gm.current=r,xe=i,St!==null?e=0:(Ot=null,Kt=0,e=Tt)}if(e!==0){if(e===2&&(i=p0(n),i!==0&&(s=i,e=$0(n,i))),e===1)throw t=qd,Gl(n,0),no(n,s),Bn(n,yt()),t;if(e===6)no(n,s);else{if(i=n.current.alternate,!(s&30)&&!h2(i)&&(e=qm(n,s),e===2&&(r=p0(n),r!==0&&(s=r,e=$0(n,r))),e===1))throw t=qd,Gl(n,0),no(n,s),Bn(n,yt()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(j(345));case 2:Aa(n,In,Yi);break;case 3:if(no(n,s),(s&130023424)===s&&(e=r1+500-yt(),10<e)){if(Lm(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){Sn(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=b0(Aa.bind(null,n,In,Yi),e);break}Aa(n,In,Yi);break;case 4:if(no(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var o=31-ri(s);r=1<<o,o=e[o],o>i&&(i=o),s&=~r}if(s=i,s=yt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*u2(s/1960))-s,10<s){n.timeoutHandle=b0(Aa.bind(null,n,In,Yi),s);break}Aa(n,In,Yi);break;case 5:Aa(n,In,Yi);break;default:throw Error(j(329))}}}return Bn(n,yt()),n.callbackNode===t?GE.bind(null,n):null}function $0(n,e){var t=Pd;return n.current.memoizedState.isDehydrated&&(Gl(n,e).flags|=256),n=qm(n,e),n!==2&&(e=In,In=t,e!==null&&H0(e)),n}function H0(n){In===null?In=n:In.push.apply(In,n)}function h2(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!ai(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function no(n,e){for(e&=~i1,e&=~Uy,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ri(e),s=1<<t;n[t]=-1,e&=~s}}function GS(n){if(xe&6)throw Error(j(327));Bc();var e=Lm(n,0);if(!(e&1))return Bn(n,yt()),null;var t=qm(n,e);if(n.tag!==0&&t===2){var s=p0(n);s!==0&&(e=s,t=$0(n,s))}if(t===1)throw t=qd,Gl(n,0),no(n,e),Bn(n,yt()),t;if(t===6)throw Error(j(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Aa(n,In,Yi),Bn(n,yt()),null}function o1(n,e){var t=xe;xe|=1;try{return n(e)}finally{xe=t,xe===0&&(bh=yt()+500,jy&&xa())}}function Ql(n){ea!==null&&ea.tag===0&&!(xe&6)&&Bc();var e=xe;xe|=1;var t=Ms.transition,s=Le;try{if(Ms.transition=null,Le=1,n)return n()}finally{Le=s,Ms.transition=t,xe=e,!(xe&6)&&xa()}}function a1(){rs=Tc.current,Xe(Tc)}function Gl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,UP(t)),St!==null)for(t=St.return;t!==null;){var s=t;switch(Ux(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Im();break;case 3:xh(),Xe(jn),Xe(hn),Kx();break;case 5:Yx(s);break;case 4:xh();break;case 13:Xe(et);break;case 19:Xe(et);break;case 10:Gx(s.type._context);break;case 22:case 23:a1()}t=t.return}if(Ot=n,St=n=ca(n.current,null),Kt=rs=e,Tt=0,qd=null,i1=Uy=Kl=0,In=Pd=null,Na!==null){for(e=0;e<Na.length;e++)if(t=Na[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var o=r.next;r.next=i,s.next=o}t.pending=s}Na=null}return n}function WE(n,e){do{var t=St;try{if(Vx(),$g.current=Vm,Hm){for(var s=st.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Hm=!1}if(Yl=0,jt=kt=st=null,kd=!1,Gd=0,s1.current=null,t===null||t.return===null){Tt=1,qd=e,St=null;break}e:{var r=n,o=t.return,l=t,c=e;if(e=Kt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=RS(o);if(m!==null){m.flags&=-257,MS(m,o,l,r,e),m.mode&1&&NS(r,u,e),e=m,c=u;var S=e.updateQueue;if(S===null){var x=new Set;x.add(c),e.updateQueue=x}else S.add(c);break e}else{if(!(e&1)){NS(r,u,e),l1();break e}c=Error(j(426))}}else if(Qe&&l.mode&1){var C=RS(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),MS(C,o,l,r,e),$x(Sh(c,l));break e}}r=c=Sh(c,l),Tt!==4&&(Tt=2),Pd===null?Pd=[r]:Pd.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var y=PE(r,c,e);CS(r,y);break e;case 1:l=c;var w=r.type,v=r.stateNode;if(!(r.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(aa===null||!aa.has(v)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=LE(r,l,e);CS(r,E);break e}}r=r.return}while(r!==null)}YE(t)}catch(_){e=_,St===t&&t!==null&&(St=t=t.return);continue}break}while(!0)}function XE(){var n=Gm.current;return Gm.current=Vm,n===null?Vm:n}function l1(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Ot===null||!(Kl&268435455)&&!(Uy&268435455)||no(Ot,Kt)}function qm(n,e){var t=xe;xe|=2;var s=XE();(Ot!==n||Kt!==e)&&(Yi=null,Gl(n,e));do try{d2();break}catch(i){WE(n,i)}while(!0);if(Vx(),xe=t,Gm.current=s,St!==null)throw Error(j(261));return Ot=null,Kt=0,Tt}function d2(){for(;St!==null;)qE(St)}function f2(){for(;St!==null&&!OT();)qE(St)}function qE(n){var e=QE(n.alternate,n,rs);n.memoizedProps=n.pendingProps,e===null?YE(n):St=e,s1.current=null}function YE(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=o2(t,e),t!==null){t.flags&=32767,St=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Tt=6,St=null;return}}else if(t=r2(t,e,rs),t!==null){St=t;return}if(e=e.sibling,e!==null){St=e;return}St=e=n}while(e!==null);Tt===0&&(Tt=5)}function Aa(n,e,t){var s=Le,i=Ms.transition;try{Ms.transition=null,Le=1,p2(n,e,t,s)}finally{Ms.transition=i,Le=s}return null}function p2(n,e,t,s){do Bc();while(ea!==null);if(xe&6)throw Error(j(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(j(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(qT(n,r),n===Ot&&(St=Ot=null,Kt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||xg||(xg=!0,JE(Pm,function(){return Bc(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Ms.transition,Ms.transition=null;var o=Le;Le=1;var l=xe;xe|=4,s1.current=null,l2(n,t),HE(t,n),DP(x0),Nm=!!w0,x0=w0=null,n.current=t,c2(t),BT(),xe=l,Le=o,Ms.transition=r}else n.current=t;if(xg&&(xg=!1,ea=n,Xm=i),r=n.pendingLanes,r===0&&(aa=null),$T(t.stateNode),Bn(n,yt()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(Wm)throw Wm=!1,n=z0,z0=null,n;return Xm&1&&n.tag!==0&&Bc(),r=n.pendingLanes,r&1?n===U0?Ld++:(Ld=0,U0=n):Ld=0,xa(),null}function Bc(){if(ea!==null){var n=PA(Xm),e=Ms.transition,t=Le;try{if(Ms.transition=null,Le=16>n?16:n,ea===null)var s=!1;else{if(n=ea,ea=null,Xm=0,xe&6)throw Error(j(331));var i=xe;for(xe|=4,q=n.current;q!==null;){var r=q,o=r.child;if(q.flags&16){var l=r.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(q=u;q!==null;){var h=q;switch(h.tag){case 0:case 11:case 15:Td(8,h,r)}var d=h.child;if(d!==null)d.return=h,q=d;else for(;q!==null;){h=q;var f=h.sibling,m=h.return;if(zE(h),h===u){q=null;break}if(f!==null){f.return=m,q=f;break}q=m}}}var S=r.alternate;if(S!==null){var x=S.child;if(x!==null){S.child=null;do{var C=x.sibling;x.sibling=null,x=C}while(x!==null)}}q=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,q=o;else e:for(;q!==null;){if(r=q,r.flags&2048)switch(r.tag){case 0:case 11:case 15:Td(9,r,r.return)}var y=r.sibling;if(y!==null){y.return=r.return,q=y;break e}q=r.return}}var w=n.current;for(q=w;q!==null;){o=q;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,q=v;else e:for(o=w;q!==null;){if(l=q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:zy(9,l)}}catch(_){ft(l,l.return,_)}if(l===o){q=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,q=E;break e}q=l.return}}if(xe=i,xa(),Ui&&typeof Ui.onPostCommitFiberRoot=="function")try{Ui.onPostCommitFiberRoot(Ry,n)}catch{}s=!0}return s}finally{Le=t,Ms.transition=e}}return!1}function WS(n,e,t){e=Sh(t,e),e=PE(n,e,1),n=oa(n,e,1),e=Sn(),n!==null&&(Hp(n,1,e),Bn(n,e))}function ft(n,e,t){if(n.tag===3)WS(n,n,t);else for(;e!==null;){if(e.tag===3){WS(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(aa===null||!aa.has(s))){n=Sh(t,n),n=LE(e,n,1),e=oa(e,n,1),n=Sn(),e!==null&&(Hp(e,1,n),Bn(e,n));break}}e=e.return}}function g2(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=Sn(),n.pingedLanes|=n.suspendedLanes&t,Ot===n&&(Kt&t)===t&&(Tt===4||Tt===3&&(Kt&130023424)===Kt&&500>yt()-r1?Gl(n,0):i1|=t),Bn(n,e)}function KE(n,e){e===0&&(n.mode&1?(e=ug,ug<<=1,!(ug&130023424)&&(ug=4194304)):e=1);var t=Sn();n=zr(n,e),n!==null&&(Hp(n,e,t),Bn(n,t))}function m2(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),KE(n,t)}function y2(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(j(314))}s!==null&&s.delete(e),KE(n,t)}var QE;QE=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||jn.current)Fn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Fn=!1,i2(n,e,t);Fn=!!(n.flags&131072)}else Fn=!1,Qe&&e.flags&1048576&&tE(e,Om,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Vg(n,e),n=e.pendingProps;var i=yh(e,hn.current);Oc(e,t),i=Jx(null,e,s,n,i,t);var r=Zx();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,On(s)?(r=!0,Fm(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Xx(e),i.updater=By,e.stateNode=i,i._reactInternals=e,P0(e,s,n,t),e=R0(null,e,s,!0,r,t)):(e.tag=0,Qe&&r&&zx(e),wn(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(Vg(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=w2(s),n=Hs(s,n),i){case 0:e=N0(null,e,s,n,t);break e;case 1:e=FS(null,e,s,n,t);break e;case 11:e=DS(null,e,s,n,t);break e;case 14:e=IS(null,e,s,Hs(s.type,n),t);break e}throw Error(j(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Hs(s,i),N0(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Hs(s,i),FS(n,e,s,i,t);case 3:e:{if(DE(e),n===null)throw Error(j(387));s=e.pendingProps,r=e.memoizedState,i=r.element,aE(n,e),Um(e,s,null,t);var o=e.memoizedState;if(s=o.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=Sh(Error(j(423)),e),e=jS(n,e,s,t,i);break e}else if(s!==i){i=Sh(Error(j(424)),e),e=jS(n,e,s,t,i);break e}else for(ls=ra(e.stateNode.containerInfo.firstChild),cs=e,Qe=!0,si=null,t=rE(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(vh(),s===i){e=Ur(n,e,t);break e}wn(n,e,s,t)}e=e.child}return e;case 5:return lE(e),n===null&&_0(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,o=i.children,S0(s,i)?o=null:r!==null&&S0(s,r)&&(e.flags|=32),ME(n,e),wn(n,e,o,t),e.child;case 6:return n===null&&_0(e),null;case 13:return IE(n,e,t);case 4:return qx(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=wh(e,null,s,t):wn(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Hs(s,i),DS(n,e,s,i,t);case 7:return wn(n,e,e.pendingProps,t),e.child;case 8:return wn(n,e,e.pendingProps.children,t),e.child;case 12:return wn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,o=i.value,$e(Bm,s._currentValue),s._currentValue=o,r!==null)if(ai(r.value,o)){if(r.children===i.children&&!jn.current){e=Ur(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var l=r.dependencies;if(l!==null){o=r.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=Ir(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),k0(r.return,t,e),l.lanes|=t;break}c=c.next}}else if(r.tag===10)o=r.type===e.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(j(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),k0(o,t,e),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}wn(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,Oc(e,t),i=Fs(i),s=s(i),e.flags|=1,wn(n,e,s,t),e.child;case 14:return s=e.type,i=Hs(s,e.pendingProps),i=Hs(s.type,i),IS(n,e,s,i,t);case 15:return NE(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Hs(s,i),Vg(n,e),e.tag=1,On(s)?(n=!0,Fm(e)):n=!1,Oc(e,t),TE(e,s,i),P0(e,s,i,t),R0(null,e,s,!0,n,t);case 19:return FE(n,e,t);case 22:return RE(n,e,t)}throw Error(j(156,e.tag))};function JE(n,e){return CA(n,e)}function v2(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rs(n,e,t,s){return new v2(n,e,t,s)}function c1(n){return n=n.prototype,!(!n||!n.isReactComponent)}function w2(n){if(typeof n=="function")return c1(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Tx)return 11;if(n===Px)return 14}return 2}function ca(n,e){var t=n.alternate;return t===null?(t=Rs(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Xg(n,e,t,s,i,r){var o=2;if(s=n,typeof n=="function")c1(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case vc:return Wl(t.children,i,r,e);case kx:o=8,i|=8;break;case Zv:return n=Rs(12,t,e,i|2),n.elementType=Zv,n.lanes=r,n;case e0:return n=Rs(13,t,e,i),n.elementType=e0,n.lanes=r,n;case t0:return n=Rs(19,t,e,i),n.elementType=t0,n.lanes=r,n;case lA:return $y(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case oA:o=10;break e;case aA:o=9;break e;case Tx:o=11;break e;case Px:o=14;break e;case Zr:o=16,s=null;break e}throw Error(j(130,n==null?n:typeof n,""))}return e=Rs(o,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function Wl(n,e,t,s){return n=Rs(7,n,s,e),n.lanes=t,n}function $y(n,e,t,s){return n=Rs(22,n,s,e),n.elementType=lA,n.lanes=t,n.stateNode={isHidden:!1},n}function jv(n,e,t){return n=Rs(6,n,null,e),n.lanes=t,n}function Ov(n,e,t){return e=Rs(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function x2(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vv(0),this.expirationTimes=vv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vv(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function u1(n,e,t,s,i,r,o,l,c){return n=new x2(n,e,t,l,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Rs(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xx(r),n}function S2(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yc,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function ZE(n){if(!n)return da;n=n._reactInternals;e:{if(tc(n)!==n||n.tag!==1)throw Error(j(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(On(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(n.tag===1){var t=n.type;if(On(t))return ZA(n,t,e)}return e}function eC(n,e,t,s,i,r,o,l,c){return n=u1(t,s,!0,n,i,r,o,l,c),n.context=ZE(null),t=n.current,s=Sn(),i=la(t),r=Ir(s,i),r.callback=e??null,oa(t,r,i),n.current.lanes=i,Hp(n,i,s),Bn(n,s),n}function Hy(n,e,t,s){var i=e.current,r=Sn(),o=la(i);return t=ZE(t),e.context===null?e.context=t:e.pendingContext=t,e=Ir(r,o),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=oa(i,e,o),n!==null&&(oi(n,i,o,r),Ug(n,i,o)),o}function Ym(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function XS(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function h1(n,e){XS(n,e),(n=n.alternate)&&XS(n,e)}function b2(){return null}var tC=typeof reportError=="function"?reportError:function(n){console.error(n)};function d1(n){this._internalRoot=n}Vy.prototype.render=d1.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(j(409));Hy(n,e,null,null)};Vy.prototype.unmount=d1.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ql(function(){Hy(null,n,null,null)}),e[Br]=null}};function Vy(n){this._internalRoot=n}Vy.prototype.unstable_scheduleHydration=function(n){if(n){var e=RA();n={blockedOn:null,target:n,priority:e};for(var t=0;t<to.length&&e!==0&&e<to[t].priority;t++);to.splice(t,0,n),t===0&&DA(n)}};function f1(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Gy(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function qS(){}function A2(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=Ym(o);r.call(u)}}var o=eC(e,s,n,0,null,!1,!1,"",qS);return n._reactRootContainer=o,n[Br]=o.current,zd(n.nodeType===8?n.parentNode:n),Ql(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var l=s;s=function(){var u=Ym(c);l.call(u)}}var c=u1(n,0,!1,null,null,!1,!1,"",qS);return n._reactRootContainer=c,n[Br]=c.current,zd(n.nodeType===8?n.parentNode:n),Ql(function(){Hy(e,c,t,s)}),c}function Wy(n,e,t,s,i){var r=t._reactRootContainer;if(r){var o=r;if(typeof i=="function"){var l=i;i=function(){var c=Ym(o);l.call(c)}}Hy(e,o,n,i)}else o=A2(t,e,n,i,s);return Ym(o)}LA=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Qh(e.pendingLanes);t!==0&&(Rx(e,t|1),Bn(e,yt()),!(xe&6)&&(bh=yt()+500,xa()))}break;case 13:Ql(function(){var s=zr(n,1);if(s!==null){var i=Sn();oi(s,n,1,i)}}),h1(n,1)}};Mx=function(n){if(n.tag===13){var e=zr(n,134217728);if(e!==null){var t=Sn();oi(e,n,134217728,t)}h1(n,134217728)}};NA=function(n){if(n.tag===13){var e=la(n),t=zr(n,e);if(t!==null){var s=Sn();oi(t,n,e,s)}h1(n,e)}};RA=function(){return Le};MA=function(n,e){var t=Le;try{return Le=n,e()}finally{Le=t}};h0=function(n,e,t){switch(e){case"input":if(i0(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=Fy(s);if(!i)throw Error(j(90));uA(s),i0(s,i)}}}break;case"textarea":dA(n,t);break;case"select":e=t.value,e!=null&&Dc(n,!!t.multiple,e,!1)}};wA=o1;xA=Ql;var E2={usingClientEntryPoint:!1,Events:[Gp,bc,Fy,yA,vA,o1]},Hh={findFiberByHostInstance:La,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},C2={bundleType:Hh.bundleType,version:Hh.version,rendererPackageName:Hh.rendererPackageName,rendererConfig:Hh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=AA(n),n===null?null:n.stateNode},findFiberByHostInstance:Hh.findFiberByHostInstance||b2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sg.isDisabled&&Sg.supportsFiber)try{Ry=Sg.inject(C2),Ui=Sg}catch{}}fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E2;fs.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f1(e))throw Error(j(200));return S2(n,e,null,t)};fs.createRoot=function(n,e){if(!f1(n))throw Error(j(299));var t=!1,s="",i=tC;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=u1(n,1,!1,null,null,t,!1,s,i),n[Br]=e.current,zd(n.nodeType===8?n.parentNode:n),new d1(e)};fs.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(j(188)):(n=Object.keys(n).join(","),Error(j(268,n)));return n=AA(e),n=n===null?null:n.stateNode,n};fs.flushSync=function(n){return Ql(n)};fs.hydrate=function(n,e,t){if(!Gy(e))throw Error(j(200));return Wy(null,n,e,!0,t)};fs.hydrateRoot=function(n,e,t){if(!f1(n))throw Error(j(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",o=tC;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=eC(e,null,n,1,t??null,i,!1,r,o),n[Br]=e.current,zd(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new Vy(e)};fs.render=function(n,e,t){if(!Gy(e))throw Error(j(200));return Wy(null,n,e,!1,t)};fs.unmountComponentAtNode=function(n){if(!Gy(n))throw Error(j(40));return n._reactRootContainer?(Ql(function(){Wy(null,null,n,!1,function(){n._reactRootContainer=null,n[Br]=null})}),!0):!1};fs.unstable_batchedUpdates=o1;fs.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!Gy(t))throw Error(j(200));if(n==null||n._reactInternals===void 0)throw Error(j(38));return Wy(n,e,t,!1,s)};fs.version="18.3.1-next-f1338f8080-20240426";function nC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(nC)}catch(n){console.error(n)}}nC(),nA.exports=fs;var _2=nA.exports,sC,YS=_2;sC=YS.createRoot,YS.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yd(){return Yd=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Yd.apply(this,arguments)}var ta;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(ta||(ta={}));const KS="popstate";function k2(n){n===void 0&&(n={});function e(s,i){let{pathname:r,search:o,hash:l}=s.location;return V0("",{pathname:r,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(s,i){return typeof i=="string"?i:Km(i)}return P2(e,t,null,n)}function it(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function p1(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function T2(){return Math.random().toString(36).substr(2,8)}function QS(n,e){return{usr:n.state,key:n.key,idx:e}}function V0(n,e,t,s){return t===void 0&&(t=null),Yd({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Lh(e):e,{state:t,key:e&&e.key||s||T2()})}function Km(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Lh(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function P2(n,e,t,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:r=!1}=s,o=i.history,l=ta.Pop,c=null,u=h();u==null&&(u=0,o.replaceState(Yd({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function d(){l=ta.Pop;let C=h(),y=C==null?null:C-u;u=C,c&&c({action:l,location:x.location,delta:y})}function f(C,y){l=ta.Push;let w=V0(x.location,C,y);u=h()+1;let v=QS(w,u),E=x.createHref(w);try{o.pushState(v,"",E)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;i.location.assign(E)}r&&c&&c({action:l,location:x.location,delta:1})}function m(C,y){l=ta.Replace;let w=V0(x.location,C,y);u=h();let v=QS(w,u),E=x.createHref(w);o.replaceState(v,"",E),r&&c&&c({action:l,location:x.location,delta:0})}function S(C){let y=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof C=="string"?C:Km(C);return w=w.replace(/ $/,"%20"),it(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let x={get action(){return l},get location(){return n(i,o)},listen(C){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(KS,d),c=C,()=>{i.removeEventListener(KS,d),c=null}},createHref(C){return e(i,C)},createURL:S,encodeLocation(C){let y=S(C);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:m,go(C){return o.go(C)}};return x}var JS;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(JS||(JS={}));function L2(n,e,t){return t===void 0&&(t="/"),N2(n,e,t)}function N2(n,e,t,s){let i=typeof e=="string"?Lh(e):e,r=Ah(i.pathname||"/",t);if(r==null)return null;let o=iC(n);R2(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=H2(r);l=U2(o[c],u)}return l}function iC(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let i=(r,o,l)=>{let c={relativePath:l===void 0?r.path||"":l,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};c.relativePath.startsWith("/")&&(it(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=ua([s,c.relativePath]),h=t.concat(c);r.children&&r.children.length>0&&(it(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),iC(r.children,e,h,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:B2(u,r.index),routesMeta:h})};return n.forEach((r,o)=>{var l;if(r.path===""||!((l=r.path)!=null&&l.includes("?")))i(r,o);else for(let c of rC(r.path))i(r,o,c)}),e}function rC(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,i=t.endsWith("?"),r=t.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let o=rC(s.join("/")),l=[];return l.push(...o.map(c=>c===""?r:[r,c].join("/"))),i&&l.push(...o),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function R2(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:z2(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const M2=/^:[\w-]+$/,D2=3,I2=2,F2=1,j2=10,O2=-2,ZS=n=>n==="*";function B2(n,e){let t=n.split("/"),s=t.length;return t.some(ZS)&&(s+=O2),e&&(s+=I2),t.filter(i=>!ZS(i)).reduce((i,r)=>i+(M2.test(r)?D2:r===""?F2:j2),s)}function z2(n,e){return n.length===e.length&&n.slice(0,-1).every((s,i)=>s===e[i])?n[n.length-1]-e[e.length-1]:0}function U2(n,e,t){let{routesMeta:s}=n,i={},r="/",o=[];for(let l=0;l<s.length;++l){let c=s[l],u=l===s.length-1,h=r==="/"?e:e.slice(r.length)||"/",d=G0({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),f=c.route;if(!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:ua([r,d.pathname]),pathnameBase:q2(ua([r,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(r=ua([r,d.pathnameBase]))}return o}function G0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=$2(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let r=i[0],o=r.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:s.reduce((u,h,d)=>{let{paramName:f,isOptional:m}=h;if(f==="*"){let x=l[d]||"";o=r.slice(0,r.length-x.length).replace(/(.)\/+$/,"$1")}const S=l[d];return m&&!S?u[f]=void 0:u[f]=(S||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:o,pattern:n}}function $2(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),p1(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function H2(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return p1(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Ah(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const V2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,G2=n=>V2.test(n);function W2(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:i=""}=typeof n=="string"?Lh(n):n,r;if(t)if(G2(t))r=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),p1(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+t))}t.startsWith("/")?r=eb(t.substring(1),"/"):r=eb(t,e)}else r=e;return{pathname:r,search:Y2(s),hash:K2(i)}}function eb(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function Bv(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function X2(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function g1(n,e){let t=X2(n);return e?t.map((s,i)=>i===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function m1(n,e,t,s){s===void 0&&(s=!1);let i;typeof n=="string"?i=Lh(n):(i=Yd({},n),it(!i.pathname||!i.pathname.includes("?"),Bv("?","pathname","search",i)),it(!i.pathname||!i.pathname.includes("#"),Bv("#","pathname","hash",i)),it(!i.search||!i.search.includes("#"),Bv("#","search","hash",i)));let r=n===""||i.pathname==="",o=r?"/":i.pathname,l;if(o==null)l=t;else{let d=e.length-1;if(!s&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}l=d>=0?e[d]:"/"}let c=W2(i,l),u=o&&o!=="/"&&o.endsWith("/"),h=(r||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const ua=n=>n.join("/").replace(/\/\/+/g,"/"),q2=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Y2=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,K2=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Q2(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const oC=["post","put","patch","delete"];new Set(oC);const J2=["get",...oC];new Set(J2);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kd(){return Kd=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Kd.apply(this,arguments)}const Xy=P.createContext(null),aC=P.createContext(null),Xr=P.createContext(null),qy=P.createContext(null),Vi=P.createContext({outlet:null,matches:[],isDataRoute:!1}),lC=P.createContext(null);function Z2(n,e){let{relative:t}=e===void 0?{}:e;Nh()||it(!1);let{basename:s,navigator:i}=P.useContext(Xr),{hash:r,pathname:o,search:l}=Yy(n,{relative:t}),c=o;return s!=="/"&&(c=o==="/"?s:ua([s,o])),i.createHref({pathname:c,search:l,hash:r})}function Nh(){return P.useContext(qy)!=null}function nc(){return Nh()||it(!1),P.useContext(qy).location}function cC(n){P.useContext(Xr).static||P.useLayoutEffect(n)}function Xp(){let{isDataRoute:n}=P.useContext(Vi);return n?gL():eL()}function eL(){Nh()||it(!1);let n=P.useContext(Xy),{basename:e,future:t,navigator:s}=P.useContext(Xr),{matches:i}=P.useContext(Vi),{pathname:r}=nc(),o=JSON.stringify(g1(i,t.v7_relativeSplatPath)),l=P.useRef(!1);return cC(()=>{l.current=!0}),P.useCallback(function(u,h){if(h===void 0&&(h={}),!l.current)return;if(typeof u=="number"){s.go(u);return}let d=m1(u,JSON.parse(o),r,h.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:ua([e,d.pathname])),(h.replace?s.replace:s.push)(d,h.state,h)},[e,s,o,r,n])}const tL=P.createContext(null);function nL(n){let e=P.useContext(Vi).outlet;return e&&P.createElement(tL.Provider,{value:n},e)}function sL(){let{matches:n}=P.useContext(Vi),e=n[n.length-1];return e?e.params:{}}function Yy(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=P.useContext(Xr),{matches:i}=P.useContext(Vi),{pathname:r}=nc(),o=JSON.stringify(g1(i,s.v7_relativeSplatPath));return P.useMemo(()=>m1(n,JSON.parse(o),r,t==="path"),[n,o,r,t])}function iL(n,e){return rL(n,e)}function rL(n,e,t,s){Nh()||it(!1);let{navigator:i}=P.useContext(Xr),{matches:r}=P.useContext(Vi),o=r[r.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=nc(),h;if(e){var d;let C=typeof e=="string"?Lh(e):e;c==="/"||(d=C.pathname)!=null&&d.startsWith(c)||it(!1),h=C}else h=u;let f=h.pathname||"/",m=f;if(c!=="/"){let C=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=L2(n,{pathname:m}),x=uL(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},l,C.params),pathname:ua([c,i.encodeLocation?i.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?c:ua([c,i.encodeLocation?i.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),r,t,s);return e&&x?P.createElement(qy.Provider,{value:{location:Kd({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:ta.Pop}},x):x}function oL(){let n=pL(),e=Q2(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),t?P.createElement("pre",{style:i},t):null,null)}const aL=P.createElement(oL,null);class lL extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?P.createElement(Vi.Provider,{value:this.props.routeContext},P.createElement(lC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cL(n){let{routeContext:e,match:t,children:s}=n,i=P.useContext(Xy);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),P.createElement(Vi.Provider,{value:e},s)}function uL(n,e,t,s){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var r;if(!t)return null;if(t.errors)n=t.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,l=(i=t)==null?void 0:i.errors;if(l!=null){let h=o.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);h>=0||it(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,u=-1;if(t&&s&&s.v7_partialHydration)for(let h=0;h<o.length;h++){let d=o[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:m}=t,S=d.route.loader&&f[d.route.id]===void 0&&(!m||m[d.route.id]===void 0);if(d.route.lazy||S){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,d,f)=>{let m,S=!1,x=null,C=null;t&&(m=l&&d.route.id?l[d.route.id]:void 0,x=d.route.errorElement||aL,c&&(u<0&&f===0?(mL("route-fallback"),S=!0,C=null):u===f&&(S=!0,C=d.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,f+1)),w=()=>{let v;return m?v=x:S?v=C:d.route.Component?v=P.createElement(d.route.Component,null):d.route.element?v=d.route.element:v=h,P.createElement(cL,{match:d,routeContext:{outlet:h,matches:y,isDataRoute:t!=null},children:v})};return t&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?P.createElement(lL,{location:t.location,revalidation:t.revalidation,component:x,error:m,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var uC=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(uC||{}),hC=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(hC||{});function hL(n){let e=P.useContext(Xy);return e||it(!1),e}function dL(n){let e=P.useContext(aC);return e||it(!1),e}function fL(n){let e=P.useContext(Vi);return e||it(!1),e}function dC(n){let e=fL(),t=e.matches[e.matches.length-1];return t.route.id||it(!1),t.route.id}function pL(){var n;let e=P.useContext(lC),t=dL(),s=dC();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function gL(){let{router:n}=hL(uC.UseNavigateStable),e=dC(hC.UseNavigateStable),t=P.useRef(!1);return cC(()=>{t.current=!0}),P.useCallback(function(i,r){r===void 0&&(r={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,Kd({fromRouteId:e},r)))},[n,e])}const tb={};function mL(n,e,t){tb[n]||(tb[n]=!0)}function yL(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function so(n){let{to:e,replace:t,state:s,relative:i}=n;Nh()||it(!1);let{future:r,static:o}=P.useContext(Xr),{matches:l}=P.useContext(Vi),{pathname:c}=nc(),u=Xp(),h=m1(e,g1(l,r.v7_relativeSplatPath),c,i==="path"),d=JSON.stringify(h);return P.useEffect(()=>u(JSON.parse(d),{replace:t,state:s,relative:i}),[u,d,i,t,s]),null}function fC(n){return nL(n.context)}function at(n){it(!1)}function vL(n){let{basename:e="/",children:t=null,location:s,navigationType:i=ta.Pop,navigator:r,static:o=!1,future:l}=n;Nh()&&it(!1);let c=e.replace(/^\/*/,"/"),u=P.useMemo(()=>({basename:c,navigator:r,static:o,future:Kd({v7_relativeSplatPath:!1},l)}),[c,l,r,o]);typeof s=="string"&&(s=Lh(s));let{pathname:h="/",search:d="",hash:f="",state:m=null,key:S="default"}=s,x=P.useMemo(()=>{let C=Ah(h,c);return C==null?null:{location:{pathname:C,search:d,hash:f,state:m,key:S},navigationType:i}},[c,h,d,f,m,S,i]);return x==null?null:P.createElement(Xr.Provider,{value:u},P.createElement(qy.Provider,{children:t,value:x}))}function wL(n){let{children:e,location:t}=n;return iL(W0(e),t)}new Promise(()=>{});function W0(n,e){e===void 0&&(e=[]);let t=[];return P.Children.forEach(n,(s,i)=>{if(!P.isValidElement(s))return;let r=[...e,i];if(s.type===P.Fragment){t.push.apply(t,W0(s.props.children,r));return}s.type!==at&&it(!1),!s.props.index||!s.props.children||it(!1);let o={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=W0(s.props.children,r)),t.push(o)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qm(){return Qm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Qm.apply(this,arguments)}function pC(n,e){if(n==null)return{};var t={},s=Object.keys(n),i,r;for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function xL(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function SL(n,e){return n.button===0&&(!e||e==="_self")&&!xL(n)}const bL=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],AL=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],EL="6";try{window.__reactRouterVersion=EL}catch{}const CL=P.createContext({isTransitioning:!1}),_L="startTransition",nb=gT[_L];function kL(n){let{basename:e,children:t,future:s,window:i}=n,r=P.useRef();r.current==null&&(r.current=k2({window:i,v5Compat:!0}));let o=r.current,[l,c]=P.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},h=P.useCallback(d=>{u&&nb?nb(()=>c(d)):c(d)},[c,u]);return P.useLayoutEffect(()=>o.listen(h),[o,h]),P.useEffect(()=>yL(s),[s]),P.createElement(vL,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:s})}const TL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",PL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LL=P.forwardRef(function(e,t){let{onClick:s,relative:i,reloadDocument:r,replace:o,state:l,target:c,to:u,preventScrollReset:h,viewTransition:d}=e,f=pC(e,bL),{basename:m}=P.useContext(Xr),S,x=!1;if(typeof u=="string"&&PL.test(u)&&(S=u,TL))try{let v=new URL(window.location.href),E=u.startsWith("//")?new URL(v.protocol+u):new URL(u),_=Ah(E.pathname,m);E.origin===v.origin&&_!=null?u=_+E.search+E.hash:x=!0}catch{}let C=Z2(u,{relative:i}),y=ML(u,{replace:o,state:l,target:c,preventScrollReset:h,relative:i,viewTransition:d});function w(v){s&&s(v),v.defaultPrevented||y(v)}return P.createElement("a",Qm({},f,{href:S||C,onClick:x||r?s:w,ref:t,target:c}))}),NL=P.forwardRef(function(e,t){let{"aria-current":s="page",caseSensitive:i=!1,className:r="",end:o=!1,style:l,to:c,viewTransition:u,children:h}=e,d=pC(e,AL),f=Yy(c,{relative:d.relative}),m=nc(),S=P.useContext(aC),{navigator:x,basename:C}=P.useContext(Xr),y=S!=null&&DL(f)&&u===!0,w=x.encodeLocation?x.encodeLocation(f).pathname:f.pathname,v=m.pathname,E=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;i||(v=v.toLowerCase(),E=E?E.toLowerCase():null,w=w.toLowerCase()),E&&C&&(E=Ah(E,C)||E);const _=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let k=v===w||!o&&v.startsWith(w)&&v.charAt(_)==="/",T=E!=null&&(E===w||!o&&E.startsWith(w)&&E.charAt(w.length)==="/"),L={isActive:k,isPending:T,isTransitioning:y},R=k?s:void 0,N;typeof r=="function"?N=r(L):N=[r,k?"active":null,T?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let M=typeof l=="function"?l(L):l;return P.createElement(LL,Qm({},d,{"aria-current":R,className:N,ref:t,style:M,to:c,viewTransition:u}),typeof h=="function"?h(L):h)});var X0;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(X0||(X0={}));var sb;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(sb||(sb={}));function RL(n){let e=P.useContext(Xy);return e||it(!1),e}function ML(n,e){let{target:t,replace:s,state:i,preventScrollReset:r,relative:o,viewTransition:l}=e===void 0?{}:e,c=Xp(),u=nc(),h=Yy(n,{relative:o});return P.useCallback(d=>{if(SL(d,t)){d.preventDefault();let f=s!==void 0?s:Km(u)===Km(h);c(n,{replace:f,state:i,preventScrollReset:r,relative:o,viewTransition:l})}},[u,c,h,s,i,t,n,r,o,l])}function DL(n,e){e===void 0&&(e={});let t=P.useContext(CL);t==null&&it(!1);let{basename:s}=RL(X0.useViewTransitionState),i=Yy(n,{relative:e.relative});if(!t.isTransitioning)return!1;let r=Ah(t.currentLocation.pathname,s)||t.currentLocation.pathname,o=Ah(t.nextLocation.pathname,s)||t.nextLocation.pathname;return G0(i.pathname,o)!=null||G0(i.pathname,r)!=null}const Qd="https://sistema-livros-maximiza-edu-backend.gkgtsp.easypanel.host/api",ib=Qd.replace(/\/api\/?$/,"");function Jd(){return localStorage.getItem("maxi-token")}function IL(n){localStorage.setItem("maxi-token",n)}function Jm(){localStorage.removeItem("maxi-token")}async function nt(n,e={}){const t=Jd(),s={"Content-Type":"application/json",...e.headers};t&&(s.Authorization=`Bearer ${t}`);const i=await fetch(`${Qd}${n}`,{...e,headers:s});return i.status===401&&Jm(),i}const zv={async login(n,e){const t=await fetch(`${Qd}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:e})});if(!t.ok){const i=await t.json();throw new Error(i.error||"Erro ao fazer login")}const s=await t.json();return IL(s.token),s},async logout(){await nt("/auth/logout",{method:"POST"}),Jm()},async getCurrentUser(){const n=await nt("/auth/me");if(!n.ok)throw new Error("No autenticado");return n.json()},isAuthenticated(){return!!Jd()}},bg={async getAll(n){const e=new URLSearchParams;n!=null&&n.role&&e.set("role",n.role),n!=null&&n.professor_id&&e.set("professor_id",n.professor_id),n!=null&&n.class_group&&e.set("class_group",n.class_group);const t=await nt(`/users?${e}`);if(!t.ok)throw new Error("Erro ao buscar usurios");return t.json()},async getById(n){const e=await nt(`/users/${n}`);if(!e.ok)throw new Error("Usurio no encontrado");return e.json()},async getByRole(n){const e=await nt(`/users/role/${n}`);if(!e.ok)throw new Error("Erro ao buscar usurios");return e.json()},async getStudentsByProfessor(n){const e=await nt(`/users/professor/${n}/students`);if(!e.ok)throw new Error("Erro ao buscar alunos");return e.json()},async create(n){const e=await nt("/users",{method:"POST",body:JSON.stringify(n)});if(!e.ok){const t=await e.json();throw new Error(t.error||"Erro ao criar usurio")}return e.json()},async update(n,e){const t=await nt(`/users/${n}`,{method:"PUT",body:JSON.stringify(e)});if(!t.ok){const s=await t.json();throw new Error(s.error||"Erro ao atualizar usurio")}return t.json()},async delete(n){if(!(await nt(`/users/${n}`,{method:"DELETE"})).ok)throw new Error("Erro ao deletar usurio")}},lc={async getAll(n){const e=new URLSearchParams;n!=null&&n.search&&e.set("search",n.search),n!=null&&n.curriculum_component&&n.curriculum_component!=="all"&&e.set("curriculum_component",n.curriculum_component),n!=null&&n.class_group&&n.class_group!=="all"&&e.set("class_group",n.class_group),n!=null&&n.professor_id&&n.professor_id!=="all"&&e.set("professor_id",n.professor_id),n!=null&&n.student_id&&n.student_id!=="all"&&e.set("student_id",n.student_id);const t=await nt(`/books?${e}`);if(!t.ok)throw new Error("Erro ao buscar livros");return t.json()},async getById(n){const e=await nt(`/books/${n}`);if(!e.ok)throw new Error("Livro no encontrado");return e.json()},async create(n){const e=await nt("/books",{method:"POST",body:JSON.stringify(n)});if(!e.ok){const t=await e.json();throw new Error(t.error||"Erro ao criar livro")}return e.json()},async update(n,e){const t=await nt(`/books/${n}`,{method:"PUT",body:JSON.stringify(e)});if(!t.ok){const s=await t.json();throw new Error(s.error||"Erro ao atualizar livro")}return t.json()},async delete(n){if(!(await nt(`/books/${n}`,{method:"DELETE"})).ok)throw new Error("Erro ao deletar livro")},async getByStudent(n){const e=await nt(`/books/student/${n}`);if(!e.ok)throw new Error("Erro ao buscar livros do aluno");return e.json()}},zc={async uploadPdf(n){const e=Jd(),t=new FormData;t.append("pdf",n);const s=await fetch(`${Qd}/upload/pdf`,{method:"POST",headers:{Authorization:`Bearer ${e}`},body:t});if(!s.ok){const i=await s.json();throw new Error(i.error||"Erro ao fazer upload do PDF")}return s.json()},async uploadImage(n){const e=Jd(),t=new FormData;t.append("image",n);const s=await fetch(`${Qd}/upload/image`,{method:"POST",headers:{Authorization:`Bearer ${e}`},body:t});if(!s.ok){const i=await s.json();throw new Error(i.error||"Erro ao fazer upload da imagem")}return s.json()},getPdfUrl(n){return n.startsWith("/uploads")?`${ib}${n}`:n},getFileUrl(n){return n?n.startsWith("/uploads")?`${ib}${n}`:n:""}},Zh={async getAll(){const n=await nt("/curriculum-components");if(!n.ok)throw new Error("Erro ao buscar componentes curriculares");return n.json()},async create(n){const e=await nt("/curriculum-components",{method:"POST",body:JSON.stringify({name:n})});if(!e.ok){const t=await e.json();throw new Error(t.error||"Erro ao criar componente")}return e.json()},async update(n,e){const t=await nt(`/curriculum-components/${n}`,{method:"PUT",body:JSON.stringify({name:e})});if(!t.ok){const s=await t.json();throw new Error(s.error||"Erro ao atualizar componente")}return t.json()},async delete(n){const e=await nt(`/curriculum-components/${n}`,{method:"DELETE"});if(!e.ok){const t=await e.json();throw new Error(t.error||"Erro ao excluir componente")}}},ed={async getAll(){const n=await nt("/series");if(!n.ok)throw new Error("Erro ao buscar sries");return n.json()},async create(n){const e=await nt("/series",{method:"POST",body:JSON.stringify({name:n})});if(!e.ok){const t=await e.json();throw new Error(t.error||"Erro ao criar srie")}return e.json()},async update(n,e){const t=await nt(`/series/${n}`,{method:"PUT",body:JSON.stringify({name:e})});if(!t.ok){const s=await t.json();throw new Error(s.error||"Erro ao atualizar srie")}return t.json()},async delete(n){const e=await nt(`/series/${n}`,{method:"DELETE"});if(!e.ok){const t=await e.json();throw new Error(t.error||"Erro ao excluir srie")}}},gC=P.createContext(void 0);function FL({children:n}){const[e,t]=P.useState(null),[s,i]=P.useState([]),[r,o]=P.useState(!0),[l,c]=P.useState(null);P.useEffect(()=>{(async()=>{if(Jd())try{const k=await zv.getCurrentUser();t(k),localStorage.setItem("maxi-current-user",JSON.stringify(k))}catch(k){console.error("Failed to load user:",k),Jm(),localStorage.removeItem("maxi-current-user"),t(null)}else localStorage.removeItem("maxi-current-user"),t(null);o(!1)})()},[]);const u=P.useCallback(async()=>{try{const E=await bg.getAll();i(E.data)}catch(E){console.error("Failed to load users:",E)}},[]);P.useEffect(()=>{e&&u()},[e,u]);const h=async(E,_)=>{c(null);try{const k=await zv.login(E,_);return t(k.user),localStorage.setItem("maxi-current-user",JSON.stringify(k.user)),!0}catch(k){const T=k instanceof Error?k.message:"Erro ao fazer login";return c(T),!1}},d=E=>{const _=s.find(k=>k.role===E);_&&(t(_),localStorage.setItem("maxi-current-user",JSON.stringify(_)))},f=()=>{zv.logout().catch(console.error),t(null),Jm(),localStorage.removeItem("maxi-current-user")},m=async E=>{try{const _=await bg.create({...E,password:E.password||"senha123"});i(k=>[...k,_])}catch(_){const k=_ instanceof Error?_.message:"Erro ao criar usurio";throw new Error(k)}},S=async(E,_)=>{try{const k=await bg.update(E,_);i(T=>T.map(L=>L.id===E?k:L))}catch(k){const T=k instanceof Error?k.message:"Erro ao atualizar usurio";throw new Error(T)}},x=async E=>{try{await bg.delete(E),i(_=>_.filter(k=>k.id!==E))}catch(_){const k=_ instanceof Error?_.message:"Erro ao deletar usurio";throw new Error(k)}},C=E=>s.filter(_=>_.role===E),y=E=>s.filter(_=>_.role==="student"&&_.professor_id===E),w=E=>s.filter(_=>_.role==="student"&&_.class_group===E),v=E=>s.find(_=>_.id===E);return p.jsx(gC.Provider,{value:{user:e,users:s,isAuthenticated:!!e,isLoading:r,error:l,login:h,loginAs:d,logout:f,addUser:m,updateUser:S,deleteUser:x,getUsersByRole:C,getStudentsByProfessor:y,getStudentsByClass:w,getUserById:v,refreshUsers:u},children:n})}function qr(){const n=P.useContext(gC);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}const jL=["Matemtica","Lngua Portuguesa","Cincias","Histria","Geografia","Ingls","Artes","Educao Fsica","Filosofia","Sociologia"],mC=["1 ANO","2 ANO","3 ANO","4 ANO","5 ANO"],yC=P.createContext(void 0);function OL({children:n}){const{user:e}=qr(),[t,s]=P.useState([]),[i,r]=P.useState([]),[o,l]=P.useState(!0),[c,u]=P.useState(null),h=P.useCallback(async()=>{try{const v=await lc.getAll();s(v.data)}catch(v){console.error("Failed to load books:",v),u("Erro ao carregar livros")}},[]),d=P.useCallback(async()=>{if(!(!(e!=null&&e.id)||e.role!=="student"))try{const v=await lc.getByStudent(e.id);r(v)}catch(v){console.error("Failed to load student books:",v)}},[e==null?void 0:e.id,e==null?void 0:e.role]);P.useEffect(()=>{(async()=>{e?(l(!0),await h(),e.role==="student"&&await d(),l(!1)):(s([]),r([]),l(!1))})()},[e,h,d]);const f=async v=>{try{const E=await lc.create(v);s(_=>[..._,E])}catch(E){const _=E instanceof Error?E.message:"Erro ao criar livro";throw new Error(_)}},m=async(v,E)=>{try{const _=await lc.update(v,E);s(k=>k.map(T=>T.id===v?_:T))}catch(_){const k=_ instanceof Error?_.message:"Erro ao atualizar livro";throw new Error(k)}},S=async v=>{try{await lc.delete(v),s(E=>E.filter(_=>_.id!==v))}catch(E){const _=E instanceof Error?E.message:"Erro ao deletar livro";throw new Error(_)}},x=v=>t.find(E=>E.id===v),C=v=>t.filter(E=>{if(v.search){const _=v.search.toLowerCase();if(!(E.title.toLowerCase().includes(_)||E.author.toLowerCase().includes(_)||E.description.toLowerCase().includes(_)))return!1}return!(v.curriculumComponent&&v.curriculumComponent!=="all"&&E.curriculum_component!==v.curriculumComponent||v.classGroup&&v.classGroup!=="all"&&!E.class_groups.includes(v.classGroup))}),y=v=>t.filter(E=>E.curriculum_component===v),w=v=>t.filter(E=>E.class_groups.includes(v));return p.jsx(yC.Provider,{value:{books:t,studentBooks:i,isLoading:o,error:c,addBook:f,updateBook:m,deleteBook:S,getBookById:x,filterBooks:C,getBooksByComponent:y,getBooksByClass:w,refreshBooks:h},children:n})}function y1(){const n=P.useContext(yC);if(n===void 0)throw new Error("useBooks must be used within a BooksProvider");return n}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var BL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ae=(n,e)=>{const t=P.forwardRef(({color:s="currentColor",size:i=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:l="",children:c,...u},h)=>P.createElement("svg",{ref:h,...BL,width:i,height:i,stroke:s,strokeWidth:o?Number(r)*24/Number(i):r,className:["lucide",`lucide-${zL(n)}`,l].join(" "),...u},[...e.map(([d,f])=>P.createElement(d,f)),...Array.isArray(c)?c:[c]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=Ae("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=Ae("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $L=Ae("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HL=Ae("BookMarked",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["polyline",{points:"10 2 10 10 13 7 16 10 16 2",key:"13o6vz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=Ae("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=Ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GL=Ae("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=Ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=Ae("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XL=Ae("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vh=Ae("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qL=Ae("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=Ae("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YL=Ae("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KL=Ae("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=Ae("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QL=Ae("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=Ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=Ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eN=Ae("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=Ae("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=Ae("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=Ae("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jy=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sN=Ae("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ag=Ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wC=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=Ae("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=Ae("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function Eg({allowedRoles:n}){const{isAuthenticated:e,user:t,isLoading:s}=qr();if(s)return p.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)"},children:p.jsx(Ds,{size:48,className:"spin",style:{color:"#6366f1"}})});if(!e||!t)return p.jsx(so,{to:"/login",replace:!0});if(!n.includes(t.role)){const i={admin:"/admin",professor:"/professor",student:"/student"};return p.jsx(so,{to:i[t.role],replace:!0})}return p.jsx(fC,{})}const oN=[{path:"/admin/books",label:"Gerenciar Livros",icon:p.jsx(fa,{size:20})},{path:"/admin/users",label:"Gerenciar Usurios",icon:p.jsx(wC,{size:20})},{path:"/admin/curriculum",label:"Componentes Curriculares",icon:p.jsx(YL,{size:20})},{path:"/admin/series",label:"Sries",icon:p.jsx(Zm,{size:20})}],aN=[{path:"/professor/my-books",label:"Meus Livros",icon:p.jsx(HL,{size:20})},{path:"/professor/students",label:"Meus Alunos",icon:p.jsx(Zm,{size:20})}],lN=[{path:"/student/library",label:"Minha Biblioteca",icon:p.jsx(KL,{size:20})}];function cN(){const{user:n}=qr(),e=nc(),t=()=>{switch(n==null?void 0:n.role){case"admin":return oN;case"professor":return aN;case"student":return lN;default:return[]}},s=()=>{switch(n==null?void 0:n.role){case"admin":return"var(--color-admin)";case"professor":return"var(--color-professor)";case"student":return"var(--color-student)";default:return"var(--color-accent-primary)"}},i=()=>{switch(n==null?void 0:n.role){case"admin":return"Administrador";case"professor":return"Professor";case"student":return"Aluno";default:return""}};return p.jsxs("aside",{className:"sidebar",children:[p.jsx("div",{className:"sidebar-header",children:p.jsx("div",{className:"logo",children:p.jsx("img",{src:"/logo-maximiza.png",alt:"Maximiza - Solues Educacionais",className:"logo-image"})})}),p.jsxs("div",{className:"sidebar-user",children:[p.jsx("div",{className:"user-avatar",children:n!=null&&n.avatar?p.jsx("img",{src:n.avatar,alt:n.name}):p.jsx(WL,{size:40})}),p.jsxs("div",{className:"user-info",children:[p.jsx("span",{className:"user-name",children:n==null?void 0:n.name}),p.jsx("span",{className:"user-role",style:{color:s()},children:i()})]})]}),p.jsx("nav",{className:"sidebar-nav",children:t().map(r=>p.jsxs(NL,{to:r.path,className:({isActive:o})=>`nav-item ${o||e.pathname===r.path?"active":""}`,end:r.path==="/admin"||r.path==="/professor"||r.path==="/student",children:[p.jsx("span",{className:"nav-icon",children:r.icon}),p.jsx("span",{className:"nav-label",children:r.label})]},r.path))}),p.jsx("div",{className:"sidebar-footer",children:p.jsx("div",{className:"version-info",children:p.jsx("span",{children:"MaxiEducao v1.0"})})})]})}function uN(){const[n,e]=P.useState(()=>{const s=localStorage.getItem("theme");return s==="light"||s==="dark"?s:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"});P.useEffect(()=>{document.documentElement.setAttribute("data-theme",n),localStorage.setItem("theme",n)},[n]);const t=()=>{e(s=>s==="light"?"dark":"light")};return p.jsx("button",{className:"theme-toggle",onClick:t,title:n==="light"?"Modo Escuro":"Modo Claro","aria-label":n==="light"?"Ativar modo escuro":"Ativar modo claro",children:p.jsx("span",{className:"theme-toggle-icon",children:n==="light"?p.jsx(nN,{size:18}):p.jsx(sN,{size:18})})})}function hN({title:n}){const{user:e,logout:t}=qr();return p.jsxs("header",{className:"header",children:[p.jsx("div",{className:"header-left",children:n&&p.jsx("h1",{className:"header-title",children:n})}),p.jsx("div",{className:"header-center",children:p.jsxs("div",{className:"search-box",children:[p.jsx(Jy,{size:18,className:"search-icon"}),p.jsx("input",{type:"text",placeholder:"Buscar livros, alunos...",className:"search-input"})]})}),p.jsxs("div",{className:"header-right",children:[p.jsx(uN,{}),p.jsxs("button",{className:"header-btn notification-btn",children:[p.jsx($L,{size:20}),p.jsx("span",{className:"notification-badge",children:"3"})]}),p.jsxs("div",{className:"header-user",children:[p.jsx("span",{className:"header-user-name",children:e==null?void 0:e.name}),p.jsx("button",{className:"header-btn logout-btn",onClick:t,title:"Sair",children:p.jsx(JL,{size:20})})]})]})]})}function $v(){return p.jsxs("div",{className:"main-layout",children:[p.jsx(cN,{}),p.jsxs("div",{className:"main-content-wrapper",children:[p.jsx(hN,{}),p.jsx("main",{className:"main-content",children:p.jsx(fC,{})})]})]})}function dN(){const{isAuthenticated:n,user:e,login:t,error:s,isLoading:i}=qr(),[r,o]=P.useState(""),[l,c]=P.useState(""),[u,h]=P.useState(!1),[d,f]=P.useState(null);if(i)return p.jsx("div",{className:"login-page",children:p.jsxs("div",{className:"login-loading",children:[p.jsx(Ds,{size:48,className:"spin"}),p.jsx("p",{children:"Carregando..."})]})});if(n&&e){const S={admin:"/admin/books",professor:"/professor/my-books",student:"/student/library"};return p.jsx(so,{to:S[e.role],replace:!0})}const m=async S=>{if(S.preventDefault(),!r||!l){f("Preencha email e senha");return}h(!0),f(null),await t(r,l)||f(s||"Email ou senha invlidos"),h(!1)};return p.jsxs("div",{className:"login-page",children:[p.jsxs("div",{className:"login-background",children:[p.jsx("div",{className:"bg-gradient-1"}),p.jsx("div",{className:"bg-gradient-2"}),p.jsx("div",{className:"bg-gradient-3"})]}),p.jsxs("div",{className:"login-container",children:[p.jsxs("div",{className:"login-header",children:[p.jsx("div",{className:"login-logo",children:p.jsx("img",{src:"/logo-maximiza.png",alt:"Maximiza - Solues Educacionais",className:"login-logo-image"})}),p.jsx("h1",{children:"Bem-vindo  Plataforma"}),p.jsx("p",{children:"Faa login para acessar o sistema"})]}),p.jsxs("form",{className:"email-login-form",onSubmit:m,children:[p.jsxs("div",{className:"form-group",children:[p.jsxs("label",{htmlFor:"email",children:[p.jsx(ZL,{size:18}),"Email"]}),p.jsx("input",{type:"email",id:"email",value:r,onChange:S=>o(S.target.value),placeholder:"seu.email@maxieducacao.com",autoComplete:"email"})]}),p.jsxs("div",{className:"form-group",children:[p.jsxs("label",{htmlFor:"password",children:[p.jsx(QL,{size:18}),"Senha"]}),p.jsx("input",{type:"password",id:"password",value:l,onChange:S=>c(S.target.value),placeholder:"",autoComplete:"current-password"})]}),p.jsx("button",{type:"submit",className:"login-btn",disabled:u,children:u?p.jsxs(p.Fragment,{children:[p.jsx(Ds,{size:20,className:"spin"}),p.jsx("span",{children:"Entrando..."})]}):p.jsxs(p.Fragment,{children:[p.jsx("span",{children:"Entrar"}),p.jsx(UL,{size:20})]})})]}),d&&p.jsx("p",{className:"login-error",children:d})]})]})}const vn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),q0=[.001,0,0,.001,0,0],Hv=1.35,is={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Bi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Zd="pdfjs_internal_editor_",oe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},me={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},xC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},zt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Nd={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},pt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},cc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Yp={ERRORS:0,WARNINGS:1,INFOS:5},Eh={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Cg={moveTo:0,lineTo:1,curveTo:2,closePath:3},SC={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ev=Yp.WARNINGS;function fN(n){Number.isInteger(n)&&(ev=n)}function pN(){return ev}function tv(n){ev>=Yp.INFOS&&console.info(`Info: ${n}`)}function ae(n){ev>=Yp.WARNINGS&&console.warn(`Warning: ${n}`)}function ze(n){throw new Error(n)}function we(n,e){n||ze(e)}function gN(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function v1(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=xN(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return gN(s)?s:null}function w1(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&v1(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function he(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const sc=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class rb extends sc{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Vv extends sc{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ey extends sc{constructor(e){super(e,"InvalidPDFException")}}class ef extends sc{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class mN extends sc{constructor(e){super(e,"FormatError")}}class $r extends sc{constructor(e){super(e,"AbortException")}}function bC(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&ze("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),o=n.subarray(i,r);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function Kp(n){typeof n!="string"&&ze("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function yN(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function vN(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function wN(){try{return new Function(""),!0}catch{return!1}}class Bt{static get isLittleEndian(){return he(this,"isLittleEndian",vN())}static get isEvalSupported(){return he(this,"isEvalSupported",wN())}static get isOffscreenCanvasSupported(){return he(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return he(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return he(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return he(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Gv=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Fr,qg,Y0;class X{static makeHexColor(e,t,s){return`#${Gv[e]}${Gv[t]}${Gv[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const i=e[s],r=e[s+1];e[s]=i*t[0]+r*t[2]+t[4],e[s+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],r=t[1],o=t[2],l=t[3],c=t[4],u=t[5];for(let h=0;h<6;h+=2){const d=e[s+h],f=e[s+h+1];e[s+h]=d*i+f*o+c,e[s+h+1]=d*r+f*l+u}}static applyInverseTransform(e,t){const s=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,s){const i=t[0],r=t[1],o=t[2],l=t[3],c=t[4],u=t[5],h=e[0],d=e[1],f=e[2],m=e[3];let S=i*h+c,x=S,C=i*f+c,y=C,w=l*d+u,v=w,E=l*m+u,_=E;if(r!==0||o!==0){const k=r*h,T=r*f,L=o*d,R=o*m;S+=L,y+=L,C+=R,x+=R,w+=k,_+=k,E+=T,v+=T}s[0]=Math.min(s[0],S,C,x,y),s[1]=Math.min(s[1],w,E,v,_),s[2]=Math.max(s[2],S,C,x,y),s[3]=Math.max(s[3],w,E,v,_)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],r=e[2],o=e[3],l=s**2+i**2,c=s*r+i*o,u=r**2+o**2,h=(l+u)/2,d=Math.sqrt(h**2-(l*u-c**2));t[0]=Math.sqrt(h+d||1),t[1]=Math.sqrt(h-d||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>o?null:[s,r,i,o]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,r){r[0]=Math.min(r[0],e,s),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,s),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(e,t,s,i,r,o,l,c,u){u[0]=Math.min(u[0],e,l),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,l),u[3]=Math.max(u[3],t,c),A(this,Fr,Y0).call(this,e,s,r,l,t,i,o,c,3*(-e+3*(s-r)+l),6*(e-2*s+r),3*(s-e),u),A(this,Fr,Y0).call(this,e,s,r,l,t,i,o,c,3*(-t+3*(i-o)+c),6*(t-2*i+o),3*(i-t),u)}}Fr=new WeakSet,qg=function(e,t,s,i,r,o,l,c,u,h){if(u<=0||u>=1)return;const d=1-u,f=u*u,m=f*u,S=d*(d*(d*e+3*u*t)+3*f*s)+m*i,x=d*(d*(d*r+3*u*o)+3*f*l)+m*c;h[0]=Math.min(h[0],S),h[1]=Math.min(h[1],x),h[2]=Math.max(h[2],S),h[3]=Math.max(h[3],x)},Y0=function(e,t,s,i,r,o,l,c,u,h,d,f){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&A(this,Fr,qg).call(this,e,t,s,i,r,o,l,c,-d/h,f);return}const m=h**2-4*d*u;if(m<0)return;const S=Math.sqrt(m),x=2*u;A(this,Fr,qg).call(this,e,t,s,i,r,o,l,c,(-h+S)/x,f),A(this,Fr,qg).call(this,e,t,s,i,r,o,l,c,(-h-S)/x,f)},b(X,Fr);function xN(n){return decodeURIComponent(escape(n))}let Wv=null,ob=null;function AC(n){return Wv||(Wv=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,ob=new Map([["","t"]])),n.replaceAll(Wv,(e,t,s)=>t?t.normalize("NFKC"):ob.get(s))}function x1(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),bC(n)}const S1="pdfjs_internal_id_";function SN(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...r]=t;if(!n(s)&&!Number.isInteger(s)||!e(i))return!1;const o=r.length;let l=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;l=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||l&&c===null))return!1;return!0}function ln(n,e,t){return Math.min(Math.max(n,e),t)}function EC(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(bC(n))}function bN(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):Kp(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class tf{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let o=null;const l=r.name;if(l==="#text")o=r.value;else if(tf.shouldBuildText(l))(c=r==null?void 0:r.attributes)!=null&&c.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&t.push({str:o}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class b1{static setupStorage(e,t,s,i,r){const o=i.getValue(t,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),r==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?e.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",l=>{i.setValue(t,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),r==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const l of s.children)l.attributes.value===o.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}e.addEventListener("input",l=>{const c=l.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:o}=t,l=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[c,u]of Object.entries(o))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!l||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}l&&r.addLinkAttributes(e,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(e,o.dataId,t,s)}static render(e){var d,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:r,linkService:s});const l=r!=="richText",c=e.div;if(c.append(o),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=m}l&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const m=document.createTextNode(i.value);o.append(m),l&&tf.shouldBuildText(i.name)&&u.push(m)}return{textDivs:u}}const h=[[i,-1,o]];for(;h.length>0;){const[m,S,x]=h.at(-1);if(S+1===m.children.length){h.pop();continue}const C=m.children[++h.at(-1)[1]];if(C===null)continue;const{name:y}=C;if(y==="#text"){const v=document.createTextNode(C.value);u.push(v),x.append(v);continue}const w=(d=C==null?void 0:C.attributes)!=null&&d.xmlns?document.createElementNS(C.attributes.xmlns,y):document.createElement(y);if(x.append(w),C.attributes&&this.setAttributes({html:w,element:C,storage:t,intent:r,linkService:s}),((f=C.children)==null?void 0:f.length)>0)h.push([C,-1,w]);else if(C.value){const v=document.createTextNode(C.value);l&&tf.shouldBuildText(y)&&u.push(v),w.append(v)}}for(const m of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Wi="http://www.w3.org/2000/svg",ka=class ka{};F(ka,"CSS",96),F(ka,"PDF",72),F(ka,"PDF_TO_CSS_UNITS",ka.CSS/ka.PDF);let Hr=ka;async function Rh(n,e="text"){if(td(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Qp{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:o=0,dontFlip:l=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=o,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,d,f,m;switch(i%=360,i<0&&(i+=360),i){case 180:h=-1,d=0,f=0,m=1;break;case 90:h=0,d=1,f=1,m=0;break;case 270:h=0,d=-1,f=-1,m=0;break;case 0:h=1,d=0,f=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(f=-f,m=-m);let S,x,C,y;h===0?(S=Math.abs(u-e[1])*s+r,x=Math.abs(c-e[0])*s+o,C=(e[3]-e[1])*s,y=(e[2]-e[0])*s):(S=Math.abs(c-e[0])*s+r,x=Math.abs(u-e[1])*s+o,C=(e[2]-e[0])*s,y=(e[3]-e[1])*s),this.transform=[h*s,d*s,f*s,m*s,S-h*s*c-f*s*u,x-d*s*c-m*s*u],this.width=C,this.height=y}get rawDims(){const e=this.viewBox;return he(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Qp({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const s=[e,t];return X.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];X.applyTransform(t,this.transform);const s=[e[2],e[3]];return X.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return X.applyInverseTransform(s,this.transform),s}}class nv extends sc{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Jp(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function sv(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function CC(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function _C(n,e="document.pdf"){if(typeof n!="string")return e;if(Jp(n))return ae('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(l=>{try{return new URL(l)}catch{try{return new URL(decodeURIComponent(l))}catch{try{return new URL(l,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(l),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const i=l=>{try{let c=decodeURIComponent(l);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:l):c}catch{return l}},r=/\.pdf$/i,o=s.pathname.split("/").at(-1);if(r.test(o))return i(o);if(s.searchParams.size>0){const l=Array.from(s.searchParams.values()).reverse();for(const u of l)if(r.test(u))return i(u);const c=Array.from(s.searchParams.keys()).reverse();for(const u of c)if(r.test(u))return i(u)}if(s.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(c)return i(c[0])}return e}class ab{constructor(){F(this,"started",Object.create(null));F(this,"times",[])}time(e){e in this.started&&ae(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ae(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function td(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function ds(n){n.preventDefault()}function tt(n){n.preventDefault(),n.stopPropagation()}function AN(n){console.log("Deprecated API usage: "+n)}var lf;class nf{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;a(this,lf)||g(this,lf,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=a(this,lf).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let l=parseInt(t[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(o+=h,l+=d):u==="+"&&(o-=h,l-=d),new Date(Date.UTC(s,i,r,o,l,c))}}lf=new WeakMap,b(nf,lf);function kC(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new Qp({viewBox:r,userUnit:1,scale:e,rotation:t})}function Mh(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ae(`Not a valid color format: "${n}"`),[0,0,0])}function EN(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Mh(s))}e.remove()}function Ze(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform();return[e,t,s,i,r,o]}function hi(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform().invertSelf();return[e,t,s,i,r,o]}function pa(n,e,t=!1,s=!0){if(e instanceof Qp){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:o}=n,l=Bt.isCSSRoundSupported,c=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${r}px`,h=l?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,d=l?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=h,o.height=d):(o.width=d,o.height=h)}s&&n.setAttribute("data-main-rotation",e.rotation)}class li{constructor(){const{pixelRatio:e}=li;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,r=-1){let o=1/0,l=1/0,c=1/0;s=li.capPixels(s,r),s>0&&(o=Math.sqrt(s/(e*t))),i!==-1&&(l=i/e,c=i/t);const u=Math.min(o,l,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const ty=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class CN{static get isDarkMode(){var e;return he(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class TC{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:s}=window.getComputedStyle(e);return e.remove(),he(this,"commentForegroundColor",Mh(s))}}function PC(n,e,t,s){s=Math.min(Math.max(s??1,0),1);const i=255*(1-s);return n=Math.round(n*s+i),e=Math.round(e*s+i),t=Math.round(t*s+i),[n,e,t]}function lb(n,e){const t=n[0]/255,s=n[1]/255,i=n[2]/255,r=Math.max(t,s,i),o=Math.min(t,s,i),l=(r+o)/2;if(r===o)e[0]=e[1]=0;else{const c=r-o;switch(e[1]=l<.5?c/(r+o):c/(2-r-o),r){case t:e[0]=((s-i)/c+(s<i?6:0))*60;break;case s:e[0]=((i-t)/c+2)*60;break;case i:e[0]=((t-s)/c+4)*60;break}}e[2]=l}function K0(n,e){const t=n[0],s=n[1],i=n[2],r=(1-Math.abs(2*i-1))*s,o=r*(1-Math.abs(t/60%2-1)),l=i-r/2;switch(Math.floor(t/60)){case 0:e[0]=r+l,e[1]=o+l,e[2]=l;break;case 1:e[0]=o+l,e[1]=r+l,e[2]=l;break;case 2:e[0]=l,e[1]=r+l,e[2]=o+l;break;case 3:e[0]=l,e[1]=o+l,e[2]=r+l;break;case 4:e[0]=o+l,e[1]=l,e[2]=r+l;break;case 5:case 6:e[0]=r+l,e[1]=l,e[2]=o+l;break}}function cb(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function ub(n,e,t){K0(n,t),t.map(cb);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];K0(e,t),t.map(cb);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return s>i?(s+.05)/(i+.05):(i+.05)/(s+.05)}const hb=new Map;function LC(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let s=hb.get(t);if(s)return s;const i=new Float32Array(9),r=i.subarray(0,3),o=i.subarray(3,6);lb(n,o);const l=i.subarray(6,9);lb(e,l);const c=l[2]<.5,u=c?12:4.5;if(o[2]=c?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),ub(o,l,r)<u){let h,d;c?(h=o[2],d=1):(h=0,d=o[2]);const f=.005;for(;d-h>f;){const m=o[2]=(h+d)/2;c===ub(o,l,r)<u?h=m:d=m}o[2]=c?d:h}return K0(o,r),s=X.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),hb.set(t,s),s}function A1({html:n,dir:e,className:t},s){const i=document.createDocumentFragment();if(typeof n=="string"){const r=document.createElement("p");r.dir=e||"auto";const o=n.split(/(?:\r\n?|\n)/);for(let l=0,c=o.length;l<c;++l){const u=o[l];r.append(document.createTextNode(u)),l<c-1&&r.append(document.createElement("br"))}i.append(r)}else b1.render({xfaHtml:n,div:i,intent:"richText"});i.firstChild.classList.add("richText",t),s.append(i)}var io,ro,ys,vs,cf,oo,Vc,Gc,uf,dy,NC,Yt,RC,MC,uc,nd;const Ki=class Ki{constructor(e){b(this,Yt);b(this,io,null);b(this,ro,null);b(this,ys);b(this,vs,null);b(this,cf,null);b(this,oo,null);b(this,Vc,null);b(this,Gc,null);g(this,ys,e),a(Ki,uf)||g(Ki,uf,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=g(this,io,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=a(this,ys)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",ds,{signal:t}),e.addEventListener("pointerdown",A(Ki,dy,NC),{signal:t}));const s=g(this,vs,document.createElement("div"));s.className="buttons",e.append(s);const i=a(this,ys).toolbarPosition;if(i){const{style:r}=e,o=a(this,ys)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return a(this,io)}hide(){var e;a(this,io).classList.add("hidden"),(e=a(this,ro))==null||e.hideDropdown()}show(){var e,t;a(this,io).classList.remove("hidden"),(e=a(this,cf))==null||e.shown(),(t=a(this,oo))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=a(this,ys),s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",a(Ki,uf)[e]),A(this,Yt,uc).call(this,s)&&s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),a(this,vs).append(s)}async addAltText(e){const t=await e.render();A(this,Yt,uc).call(this,t),a(this,vs).append(t,a(this,Yt,nd)),g(this,cf,e)}addComment(e,t=null){if(a(this,oo))return;const s=e.renderForToolbar();if(!s)return;A(this,Yt,uc).call(this,s);const i=g(this,Vc,a(this,Yt,nd));t?(a(this,vs).insertBefore(s,t),a(this,vs).insertBefore(i,t)):a(this,vs).append(s,i),g(this,oo,e),e.toolbar=this}addColorPicker(e){if(a(this,ro))return;g(this,ro,e);const t=e.renderButton();A(this,Yt,uc).call(this,t),a(this,vs).append(t,a(this,Yt,nd))}async addEditSignatureButton(e){const t=g(this,Gc,await e.renderEditButton(a(this,ys)));A(this,Yt,uc).call(this,t),a(this,vs).append(t,a(this,Yt,nd))}removeButton(e){var t,s;switch(e){case"comment":(t=a(this,oo))==null||t.removeToolbarCommentButton(),g(this,oo,null),(s=a(this,Vc))==null||s.remove(),g(this,Vc,null);break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,s){const i=a(this,vs).querySelector(s);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){a(this,Gc)&&(a(this,Gc).title=e)}remove(){var e;a(this,io).remove(),(e=a(this,ro))==null||e.destroy(),g(this,ro,null)}};io=new WeakMap,ro=new WeakMap,ys=new WeakMap,vs=new WeakMap,cf=new WeakMap,oo=new WeakMap,Vc=new WeakMap,Gc=new WeakMap,uf=new WeakMap,dy=new WeakSet,NC=function(e){e.stopPropagation()},Yt=new WeakSet,RC=function(e){a(this,ys)._focusEventsAllowed=!1,tt(e)},MC=function(e){a(this,ys)._focusEventsAllowed=!0,tt(e)},uc=function(e){const t=a(this,ys)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",A(this,Yt,RC).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",A(this,Yt,MC).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ds,{signal:t}),!0)},nd=function(){const e=document.createElement("div");return e.className="divider",e},b(Ki,dy),b(Ki,uf,null);let Q0=Ki;var hf,Ma,Zi,Vr,DC,IC,J0;class _N{constructor(e){b(this,Vr);b(this,hf,null);b(this,Ma,null);b(this,Zi);g(this,Zi,e)}show(e,t,s){const[i,r]=A(this,Vr,IC).call(this,t,s),{style:o}=a(this,Ma)||g(this,Ma,A(this,Vr,DC).call(this));e.append(a(this,Ma)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){a(this,Ma).remove()}}hf=new WeakMap,Ma=new WeakMap,Zi=new WeakMap,Vr=new WeakSet,DC=function(){const e=g(this,Ma,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=a(this,Zi)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",ds,{signal:t});const s=g(this,hf,document.createElement("div"));return s.className="buttons",e.append(s),a(this,Zi).hasCommentManager()&&A(this,Vr,J0).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{a(this,Zi).commentSelection("floating_button")}),A(this,Vr,J0).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{a(this,Zi).highlightSelection("floating_button")}),e},IC=function(e,t){let s=0,i=0;for(const r of e){const o=r.y+r.height;if(o<s)continue;const l=r.x+(t?r.width:0);if(o>s){i=l,s=o;continue}t?l>i&&(i=l):l<i&&(i=l)}return[t?1-i:i,s]},J0=function(e,t,s,i){const r=document.createElement("button");r.classList.add("basic",e),r.tabIndex=0,r.setAttribute("data-l10n-id",t);const o=document.createElement("span");r.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",s);const l=a(this,Zi)._signal;l instanceof AbortSignal&&!l.aborted&&(r.addEventListener("contextmenu",ds,{signal:l}),r.addEventListener("click",i,{signal:l})),a(this,hf).append(r)};function FC(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var fy;class kN{constructor(){b(this,fy,0)}get id(){return`${Zd}${At(this,fy)._++}`}}fy=new WeakMap;var Wc,df,tn,Xc,Yg;const I1=class I1{constructor(){b(this,Xc);b(this,Wc,x1());b(this,df,0);b(this,tn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return he(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return A(this,Xc,Yg).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return A(this,Xc,Yg).call(this,e,e)}async getFromBlob(e,t){const s=await t;return A(this,Xc,Yg).call(this,e,s)}async getFromId(e){a(this,tn)||g(this,tn,new Map);const t=a(this,tn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){a(this,tn)||g(this,tn,new Map);let s=a(this,tn).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${a(this,Wc)}_${At(this,df)._++}`,refCounter:1,isSvg:!1},a(this,tn).set(e,s),a(this,tn).set(s.id,s),s}getSvgUrl(e){const t=a(this,tn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;a(this,tn)||g(this,tn,new Map);const t=a(this,tn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${a(this,Wc)}_`)}};Wc=new WeakMap,df=new WeakMap,tn=new WeakMap,Xc=new WeakSet,Yg=async function(e,t){a(this,tn)||g(this,tn,new Map);let s=a(this,tn).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${a(this,Wc)}_${At(this,df)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Rh(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=I1._isSVGFittingCanvas,o=new FileReader,l=new Image,c=new Promise((u,h)=>{l.onload=()=>{s.bitmap=l,s.isSvg=!0,u()},o.onload=async()=>{const d=s.svgUrl=o.result;l.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},l.onerror=o.onerror=h});o.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){ae(i),s=null}return a(this,tn).set(e,s),s&&a(this,tn).set(s.id,s),s};let Z0=I1;var gt,ao,ff,Je;class TN{constructor(e=128){b(this,gt,[]);b(this,ao,!1);b(this,ff);b(this,Je,-1);g(this,ff,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:l=!1}){if(i&&e(),a(this,ao))return;const c={cmd:e,undo:t,post:s,type:r};if(a(this,Je)===-1){a(this,gt).length>0&&(a(this,gt).length=0),g(this,Je,0),a(this,gt).push(c);return}if(o&&a(this,gt)[a(this,Je)].type===r){l&&(c.undo=a(this,gt)[a(this,Je)].undo),a(this,gt)[a(this,Je)]=c;return}const u=a(this,Je)+1;u===a(this,ff)?a(this,gt).splice(0,1):(g(this,Je,u),u<a(this,gt).length&&a(this,gt).splice(u)),a(this,gt).push(c)}undo(){if(a(this,Je)===-1)return;g(this,ao,!0);const{undo:e,post:t}=a(this,gt)[a(this,Je)];e(),t==null||t(),g(this,ao,!1),g(this,Je,a(this,Je)-1)}redo(){if(a(this,Je)<a(this,gt).length-1){g(this,Je,a(this,Je)+1),g(this,ao,!0);const{cmd:e,post:t}=a(this,gt)[a(this,Je)];e(),t==null||t(),g(this,ao,!1)}}hasSomethingToUndo(){return a(this,Je)!==-1}hasSomethingToRedo(){return a(this,Je)<a(this,gt).length-1}cleanType(e){if(a(this,Je)!==-1){for(let t=a(this,Je);t>=0;t--)if(a(this,gt)[t].type!==e){a(this,gt).splice(t+1,a(this,Je)-t),g(this,Je,t);return}a(this,gt).length=0,g(this,Je,-1)}}destroy(){g(this,gt,null)}}gt=new WeakMap,ao=new WeakMap,ff=new WeakMap,Je=new WeakMap;var py,jC;class Zp{constructor(e){b(this,py);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Bt.platform;for(const[s,i,r={}]of e)for(const o of s){const l=o.startsWith("mac+");t&&l?(this.callbacks.set(o.slice(4),{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1))):!t&&!l&&(this.callbacks.set(o,{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(A(this,py,jC).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:o=[],checker:l=null}}=s;l&&!l(e,t)||(i.bind(e,...o,t)(),r||tt(t))}}py=new WeakSet,jC=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const gy=class gy{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return EN(e),he(this,"_colors",e)}convert(e){const t=Mh(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,o)=>r===t[o]))return gy._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?X.makeHexColor(...t):e}};F(gy,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let ew=gy;var qc,Un,Yc,lt,Ct,Kc,ws,Qc,xs,nn,lo,co,Jc,uo,gi,Ss,Da,pf,gf,Zc,mf,mi,ho,eu,fo,yi,my,po,tu,yf,go,Ia,nu,mo,vf,xt,Te,er,yo,vo,wf,su,xf,wo,vi,tr,Sf,bf,bs,$,Kg,tw,OC,BC,sd,zC,UC,$C,nw,HC,sw,iw,VC,fn,Xi,GC,WC,rw,XC,id,ow;const Lc=class Lc{constructor(e,t,s,i,r,o,l,c,u,h,d,f,m,S,x,C){b(this,$);b(this,qc,new AbortController);b(this,Un,null);b(this,Yc,null);b(this,lt,new Map);b(this,Ct,new Map);b(this,Kc,null);b(this,ws,null);b(this,Qc,null);b(this,xs,new TN);b(this,nn,null);b(this,lo,null);b(this,co,null);b(this,Jc,0);b(this,uo,new Set);b(this,gi,null);b(this,Ss,null);b(this,Da,new Set);F(this,"_editorUndoBar",null);b(this,pf,!1);b(this,gf,!1);b(this,Zc,!1);b(this,mf,null);b(this,mi,null);b(this,ho,null);b(this,eu,null);b(this,fo,!1);b(this,yi,null);b(this,my,new kN);b(this,po,!1);b(this,tu,!1);b(this,yf,!1);b(this,go,null);b(this,Ia,null);b(this,nu,null);b(this,mo,null);b(this,vf,null);b(this,xt,oe.NONE);b(this,Te,new Set);b(this,er,null);b(this,yo,null);b(this,vo,null);b(this,wf,null);b(this,su,null);b(this,xf,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});b(this,wo,[0,0]);b(this,vi,null);b(this,tr,null);b(this,Sf,null);b(this,bf,null);b(this,bs,null);const y=this._signal=a(this,qc).signal;g(this,tr,e),g(this,Sf,t),g(this,bf,s),g(this,Kc,i),g(this,nn,r),g(this,yo,o),g(this,su,c),this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:y}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:y}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:y}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:y}),l._on("setpreference",this.onSetPreference.bind(this),{signal:y}),l._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:y}),window.addEventListener("pointerdown",()=>{g(this,tu,!0)},{capture:!0,signal:y}),window.addEventListener("pointerup",()=>{g(this,tu,!1)},{capture:!0,signal:y}),A(this,$,zC).call(this),A(this,$,VC).call(this),A(this,$,nw).call(this),g(this,ws,c.annotationStorage),g(this,mf,c.filterFactory),g(this,vo,u),g(this,eu,h||null),g(this,pf,d),g(this,gf,f),g(this,Zc,m),g(this,vf,S||null),this.viewParameters={realScale:Hr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=x||null,this._supportsPinchToZoom=C!==!1,r==null||r.setSidebarUiManager(this)}static get _keyboardManager(){const e=Lc.prototype,t=o=>a(o,tr).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return he(this,"_keyboardManager",new Zp([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&a(o,tr).contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&a(o,tr).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r,o,l,c,u;(e=a(this,bs))==null||e.resolve(),g(this,bs,null),(t=a(this,qc))==null||t.abort(),g(this,qc,null),this._signal=null;for(const h of a(this,Ct).values())h.destroy();a(this,Ct).clear(),a(this,lt).clear(),a(this,Da).clear(),(s=a(this,mo))==null||s.clear(),g(this,Un,null),a(this,Te).clear(),a(this,xs).destroy(),(i=a(this,Kc))==null||i.destroy(),(r=a(this,nn))==null||r.destroy(),(o=a(this,yo))==null||o.destroy(),(l=a(this,yi))==null||l.hide(),g(this,yi,null),(c=a(this,nu))==null||c.destroy(),g(this,nu,null),g(this,Yc,null),a(this,mi)&&(clearTimeout(a(this,mi)),g(this,mi,null)),a(this,vi)&&(clearTimeout(a(this,vi)),g(this,vi,null)),(u=this._editorUndoBar)==null||u.destroy(),g(this,su,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return a(this,vf)}get useNewAltTextFlow(){return a(this,gf)}get useNewAltTextWhenAddingImage(){return a(this,Zc)}get hcmFilter(){return he(this,"hcmFilter",a(this,vo)?a(this,mf).addHCMFilter(a(this,vo).foreground,a(this,vo).background):"none")}get direction(){return he(this,"direction",getComputedStyle(a(this,tr)).direction)}get _highlightColors(){return he(this,"_highlightColors",a(this,eu)?new Map(a(this,eu).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return he(this,"highlightColors",null);const t=new Map,s=!!a(this,vo);for(const[i,r]of e){const o=i.endsWith("_HCM");if(s&&o){t.set(i.replace("_HCM",""),r);continue}!s&&!o&&t.set(i,r)}return he(this,"highlightColors",t)}get highlightColorNames(){return he(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),g(this,co,e)}setMainHighlightColorPicker(e){g(this,nu,e)}editAltText(e,t=!1){var s;(s=a(this,Kc))==null||s.editAltText(this,e,t)}hasCommentManager(){return!!a(this,nn)}editComment(e,t,s,i){var r;(r=a(this,nn))==null||r.showDialog(this,e,t,s,i)}selectComment(e,t){const s=a(this,Ct).get(e),i=s==null?void 0:s.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=a(this,nn))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=a(this,nn))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=a(this,nn))==null||t.removeComments([e.uid])}toggleComment(e,t,s=void 0){var i;(i=a(this,nn))==null||i.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){var s;return e&&((s=a(this,nn))==null?void 0:s.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=a(this,nn))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(a(this,Ct).has(e-1))return;const{resolve:t,promise:s}=Promise.withResolvers(),i=r=>{r.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await s}getSignature(e){var t;(t=a(this,yo))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return a(this,yo)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":g(this,Zc,t);break}}onPageChanging({pageNumber:e}){g(this,Jc,e-1)}focusMainContainer(){a(this,tr).focus()}findParent(e,t){for(const s of a(this,Ct).values()){const{x:i,y:r,width:o,height:l}=s.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=r&&t<=r+l)return s}return null}disableUserSelect(e=!1){a(this,Sf).classList.toggle("noUserSelect",e)}addShouldRescale(e){a(this,Da).add(e)}removeShouldRescale(e){a(this,Da).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Hr.PDF_TO_CSS_UNITS;for(const s of a(this,Da))s.onScaleChanging();(t=a(this,co))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:o,focusOffset:l}=s,c=s.toString(),h=A(this,$,Kg).call(this,s).closest(".textLayer"),d=this.getSelectionBoxes(h);if(!d)return;s.empty();const f=A(this,$,tw).call(this,h),m=a(this,xt)===oe.NONE,S=()=>{const x=f==null?void 0:f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:i,anchorOffset:r,focusNode:o,focusOffset:l,text:c});m&&this.showAllEditors("highlight",!0,!0),t&&(x==null||x.editComment())};if(m){this.switchToMode(oe.HIGHLIGHT,S);return}S()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!a(this,ws))return null;const t=`${Zd}${e}`,s=a(this,ws).getRawValue(t);return s&&a(this,ws).remove(t),s}addToAnnotationStorage(e){!e.isEmpty()&&a(this,ws)&&!a(this,ws).has(e.id)&&a(this,ws).setValue(e.id,e)}a11yAlert(e,t=null){const s=a(this,bf);s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,a(this,fo)&&(g(this,fo,!1),A(this,$,sd).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of a(this,Te))if(t.div.contains(e)){g(this,Ia,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!a(this,Ia))return;const[e,t]=a(this,Ia);g(this,Ia,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){A(this,$,nw).call(this),A(this,$,sw).call(this)}removeEditListeners(){A(this,$,HC).call(this),A(this,$,iw).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of a(this,Ss))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of a(this,Ss))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=a(this,Un))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of a(this,Te)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const o of a(this,Ss))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){ae(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const u=await i.deserialize(c);if(!u)return;r.push(u)}const o=()=>{for(const c of r)A(this,$,rw).call(this,c);A(this,$,ow).call(this,r)},l=()=>{for(const c of r)c.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(r){ae(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),a(this,xt)!==oe.NONE&&!this.isEditorHandlingKeyboard&&Lc._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,a(this,fo)&&(g(this,fo,!1),A(this,$,sd).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(A(this,$,UC).call(this),A(this,$,sw).call(this),A(this,$,fn).call(this,{isEditing:a(this,xt)!==oe.NONE,isEmpty:A(this,$,id).call(this),hasSomethingToUndo:a(this,xs).hasSomethingToUndo(),hasSomethingToRedo:a(this,xs).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,$,$C).call(this),A(this,$,iw).call(this),A(this,$,fn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!a(this,Ss)){g(this,Ss,e);for(const t of a(this,Ss))A(this,$,Xi).call(this,t.defaultPropertiesToUpdate)}}getId(){return a(this,my).id}get currentLayer(){return a(this,Ct).get(a(this,Jc))}getLayer(e){return a(this,Ct).get(e)}get currentPageIndex(){return a(this,Jc)}addLayer(e){a(this,Ct).set(e.pageIndex,e),a(this,po)?e.enable():e.disable()}removeLayer(e){a(this,Ct).delete(e.pageIndex)}async updateMode(e,t=null,s=!1,i=!1,r=!1){var o,l,c,u,h,d;if(a(this,xt)!==e&&!(a(this,bs)&&(await a(this,bs).promise,!a(this,bs)))){if(g(this,bs,Promise.withResolvers()),(o=a(this,co))==null||o.commitOrRemove(),a(this,xt)===oe.POPUP&&((l=a(this,nn))==null||l.hideSidebar()),(c=a(this,nn))==null||c.destroyPopup(),g(this,xt,e),e===oe.NONE){this.setEditingState(!1),A(this,$,WC).call(this);for(const f of a(this,lt).values())f.hideStandaloneCommentButton();(u=this._editorUndoBar)==null||u.hide(),this.toggleComment(null),a(this,bs).resolve();return}for(const f of a(this,lt).values())f.addStandaloneCommentButton();e===oe.SIGNATURE&&await((h=a(this,yo))==null?void 0:h.loadSignatures()),this.setEditingState(!0),await A(this,$,GC).call(this),this.unselectAll();for(const f of a(this,Ct).values())f.updateMode(e);if(e===oe.POPUP){a(this,Yc)||g(this,Yc,await a(this,su).getAnnotationsByType(new Set(a(this,Ss).map(S=>S._editorType))));const f=new Set,m=[];for(const S of a(this,lt).values()){const{annotationElementId:x,hasComment:C,deleted:y}=S;x&&f.add(x),C&&!y&&m.push(S.getData())}for(const S of a(this,Yc)){const{id:x,popupRef:C,contentsObj:y}=S;C&&(y!=null&&y.str)&&!f.has(x)&&!a(this,uo).has(x)&&m.push(S)}(d=a(this,nn))==null||d.showSidebar(m)}if(!t){s&&this.addNewEditorFromKeyboard(),a(this,bs).resolve();return}for(const f of a(this,lt).values())f.uid===t?(this.setSelected(f),r?f.editComment():i?f.enterInEditMode():f.focus()):f.unselect();a(this,bs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==a(this,xt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(a(this,Ss)){switch(e){case me.CREATE:this.currentLayer.addNewEditor(t);return;case me.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(a(this,wf)||g(this,wf,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of a(this,Te))s.updateParams(e,t);else for(const s of a(this,Ss))s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const o of a(this,lt).values())o.editorType===e&&o.show(t);(((r=a(this,wf))==null?void 0:r.get(me.HIGHLIGHT_SHOW_ALL))??!0)!==t&&A(this,$,Xi).call(this,[[me.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(a(this,yf)!==e){g(this,yf,e);for(const t of a(this,Ct).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of a(this,lt).values())t.pageIndex===e&&(yield t)}getEditor(e){return a(this,lt).get(e)}addEditor(e){a(this,lt).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(a(this,mi)&&clearTimeout(a(this,mi)),g(this,mi,setTimeout(()=>{this.focusMainContainer(),g(this,mi,null)},0))),a(this,lt).delete(e.id),e.annotationElementId&&((t=a(this,mo))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!a(this,uo).has(e.annotationElementId))&&((s=a(this,ws))==null||s.remove(e.id))}addDeletedAnnotationElement(e){a(this,uo).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return a(this,uo).has(e)}removeDeletedAnnotationElement(e){a(this,uo).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){a(this,Un)!==e&&(g(this,Un,e),e&&A(this,$,Xi).call(this,e.propertiesToUpdate))}updateUI(e){a(this,$,XC)===e&&A(this,$,Xi).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){A(this,$,Xi).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(a(this,Te).has(e)){a(this,Te).delete(e),e.unselect(),A(this,$,fn).call(this,{hasSelectedEditor:this.hasSelection});return}a(this,Te).add(e),e.select(),A(this,$,Xi).call(this,e.propertiesToUpdate),A(this,$,fn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=a(this,co))==null||t.commitOrRemove();for(const s of a(this,Te))s!==e&&s.unselect();a(this,Te).clear(),a(this,Te).add(e),e.select(),A(this,$,Xi).call(this,e.propertiesToUpdate),A(this,$,fn).call(this,{hasSelectedEditor:!0})}isSelected(e){return a(this,Te).has(e)}get firstSelectedEditor(){return a(this,Te).values().next().value}unselect(e){e.unselect(),a(this,Te).delete(e),A(this,$,fn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return a(this,Te).size!==0}get isEnterHandled(){return a(this,Te).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;a(this,xs).undo(),A(this,$,fn).call(this,{hasSomethingToUndo:a(this,xs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,$,id).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){a(this,xs).redo(),A(this,$,fn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:a(this,xs).hasSomethingToRedo(),isEmpty:A(this,$,id).call(this)})}addCommands(e){a(this,xs).add(e),A(this,$,fn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,$,id).call(this)})}cleanUndoStack(e){a(this,xs).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...a(this,Te)],s=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,t.length===1?t[0].editorType:t.length);for(const l of t)l.remove()},i=()=>{for(const o of t)A(this,$,rw).call(this,o)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=a(this,Un))==null||e.commitOrRemove()}hasSomethingToControl(){return a(this,Un)||this.hasSelection}selectAll(){for(const e of a(this,Te))e.commit();A(this,$,ow).call(this,a(this,lt).values())}unselectAll(){var e;if(!(a(this,Un)&&(a(this,Un).commitOrRemove(),a(this,xt)!==oe.NONE))&&!((e=a(this,co))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of a(this,Te))t.unselect();a(this,Te).clear(),A(this,$,fn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;a(this,wo)[0]+=e,a(this,wo)[1]+=t;const[i,r]=a(this,wo),o=[...a(this,Te)],l=1e3;a(this,vi)&&clearTimeout(a(this,vi)),g(this,vi,setTimeout(()=>{g(this,vi,null),a(this,wo)[0]=a(this,wo)[1]=0,this.addCommands({cmd:()=>{for(const c of o)a(this,lt).has(c.id)&&(c.translateInPage(i,r),c.translationDone())},undo:()=>{for(const c of o)a(this,lt).has(c.id)&&(c.translateInPage(-i,-r),c.translationDone())},mustExec:!1})},l));for(const c of o)c.translateInPage(e,t),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),g(this,gi,new Map);for(const e of a(this,Te))a(this,gi).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!a(this,gi))return!1;this.disableUserSelect(!1);const e=a(this,gi);g(this,gi,null);let t=!1;for(const[{x:i,y:r,pageIndex:o},l]of e)l.newX=i,l.newY=r,l.newPageIndex=o,t||(t=i!==l.savedX||r!==l.savedY||o!==l.savedPageIndex);if(!t)return!1;const s=(i,r,o,l)=>{if(a(this,lt).has(i.id)){const c=a(this,Ct).get(l);c?i._setParentAndPosition(c,r,o):(i.pageIndex=l,i.x=r,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:o,newPageIndex:l}]of e)s(i,r,o,l)},undo:()=>{for(const[i,{savedX:r,savedY:o,savedPageIndex:l}]of e)s(i,r,o,l)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(a(this,gi))for(const s of a(this,gi).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||a(this,Te).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return a(this,Un)===e}getActive(){return a(this,Un)}getMode(){return a(this,xt)}isEditingMode(){return a(this,xt)!==oe.NONE}get imageManager(){return he(this,"imageManager",new Z0)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:o}=e.getBoundingClientRect();let l;switch(e.getAttribute("data-main-rotation")){case"90":l=(u,h,d,f)=>({x:(h-i)/o,y:1-(u+d-s)/r,width:f/o,height:d/r});break;case"180":l=(u,h,d,f)=>({x:1-(u+d-s)/r,y:1-(h+f-i)/o,width:d/r,height:f/o});break;case"270":l=(u,h,d,f)=>({x:1-(h+f-i)/o,y:(u-s)/r,width:f/o,height:d/r});break;default:l=(u,h,d,f)=>({x:(u-s)/r,y:(h-i)/o,width:d/r,height:f/o});break}const c=[];for(let u=0,h=t.rangeCount;u<h;u++){const d=t.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:m,width:S,height:x}of d.getClientRects())S===0||x===0||c.push(l(f,m,S,x))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(a(this,Qc)||g(this,Qc,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=a(this,Qc))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=a(this,Qc))==null?void 0:i.get(e.data.id);if(!t)return;const s=a(this,ws).getRawValue(t);s&&(a(this,xt)===oe.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var r;const i=(r=a(this,mo))==null?void 0:r.get(e);i&&(i.setCanvas(t,s),a(this,mo).delete(e))}addMissingCanvas(e,t){(a(this,mo)||g(this,mo,new Map)).set(e,t)}};qc=new WeakMap,Un=new WeakMap,Yc=new WeakMap,lt=new WeakMap,Ct=new WeakMap,Kc=new WeakMap,ws=new WeakMap,Qc=new WeakMap,xs=new WeakMap,nn=new WeakMap,lo=new WeakMap,co=new WeakMap,Jc=new WeakMap,uo=new WeakMap,gi=new WeakMap,Ss=new WeakMap,Da=new WeakMap,pf=new WeakMap,gf=new WeakMap,Zc=new WeakMap,mf=new WeakMap,mi=new WeakMap,ho=new WeakMap,eu=new WeakMap,fo=new WeakMap,yi=new WeakMap,my=new WeakMap,po=new WeakMap,tu=new WeakMap,yf=new WeakMap,go=new WeakMap,Ia=new WeakMap,nu=new WeakMap,mo=new WeakMap,vf=new WeakMap,xt=new WeakMap,Te=new WeakMap,er=new WeakMap,yo=new WeakMap,vo=new WeakMap,wf=new WeakMap,su=new WeakMap,xf=new WeakMap,wo=new WeakMap,vi=new WeakMap,tr=new WeakMap,Sf=new WeakMap,bf=new WeakMap,bs=new WeakMap,$=new WeakSet,Kg=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},tw=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of a(this,Ct).values())if(s.hasTextLayer(e))return s;return null},OC=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=A(this,$,Kg).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(a(this,yi)||g(this,yi,new _N(this)),a(this,yi).show(s,i,this.direction==="ltr"))},BC=function(){var r,o,l;const e=document.getSelection();if(!e||e.isCollapsed){a(this,er)&&((r=a(this,yi))==null||r.hide(),g(this,er,null),A(this,$,fn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===a(this,er))return;const i=A(this,$,Kg).call(this,e).closest(".textLayer");if(!i){a(this,er)&&((o=a(this,yi))==null||o.hide(),g(this,er,null),A(this,$,fn).call(this,{hasSelectedText:!1}));return}if((l=a(this,yi))==null||l.hide(),g(this,er,t),A(this,$,fn).call(this,{hasSelectedText:!0}),!(a(this,xt)!==oe.HIGHLIGHT&&a(this,xt)!==oe.NONE)&&(a(this,xt)===oe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),g(this,fo,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=a(this,xt)===oe.HIGHLIGHT?A(this,$,tw).call(this,i):null;if(c==null||c.toggleDrawing(),a(this,tu)){const u=new AbortController,h=this.combinedSignal(u),d=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&A(this,$,sd).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}else c==null||c.toggleDrawing(!0),A(this,$,sd).call(this,"main_toolbar")}},sd=function(e=""){a(this,xt)===oe.HIGHLIGHT?this.highlightSelection(e):a(this,pf)&&A(this,$,OC).call(this)},zC=function(){document.addEventListener("selectionchange",A(this,$,BC).bind(this),{signal:this._signal})},UC=function(){if(a(this,ho))return;g(this,ho,new AbortController);const e=this.combinedSignal(a(this,ho));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},$C=function(){var e;(e=a(this,ho))==null||e.abort(),g(this,ho,null)},nw=function(){if(a(this,go))return;g(this,go,new AbortController);const e=this.combinedSignal(a(this,go));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},HC=function(){var e;(e=a(this,go))==null||e.abort(),g(this,go,null)},sw=function(){if(a(this,lo))return;g(this,lo,new AbortController);const e=this.combinedSignal(a(this,lo));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},iw=function(){var e;(e=a(this,lo))==null||e.abort(),g(this,lo,null)},VC=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},fn=function(e){Object.entries(e).some(([s,i])=>a(this,xf)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(a(this,xf),e)}),a(this,xt)===oe.HIGHLIGHT&&e.hasSelectedEditor===!1&&A(this,$,Xi).call(this,[[me.HIGHLIGHT_FREE,!0]]))},Xi=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},GC=async function(){if(!a(this,po)){g(this,po,!0);const e=[];for(const t of a(this,Ct).values())e.push(t.enable());await Promise.all(e);for(const t of a(this,lt).values())t.enable()}},WC=function(){if(this.unselectAll(),a(this,po)){g(this,po,!1);for(const e of a(this,Ct).values())e.disable();for(const e of a(this,lt).values())e.disable()}},rw=function(e){const t=a(this,Ct).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},XC=function(){let e=null;for(e of a(this,Te));return e},id=function(){if(a(this,lt).size===0)return!0;if(a(this,lt).size===1)for(const e of a(this,lt).values())return e.isEmpty();return!1},ow=function(e){for(const t of a(this,Te))t.unselect();a(this,Te).clear();for(const t of e)t.isEmpty()||(a(this,Te).add(t),t.select());A(this,$,fn).call(this,{hasSelectedEditor:this.hasSelection})},F(Lc,"TRANSLATE_SMALL",1),F(Lc,"TRANSLATE_BIG",10);let ga=Lc;var Lt,wi,Vs,iu,xi,$n,ru,Si,kn,nr,Fa,bi,xo,ii,rd,Qg;const pn=class pn{constructor(e){b(this,ii);b(this,Lt,null);b(this,wi,!1);b(this,Vs,null);b(this,iu,null);b(this,xi,null);b(this,$n,null);b(this,ru,!1);b(this,Si,null);b(this,kn,null);b(this,nr,null);b(this,Fa,null);b(this,bi,!1);g(this,kn,e),g(this,bi,e._uiManager.useNewAltTextFlow),a(pn,xo)||g(pn,xo,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){pn._l10n??(pn._l10n=e)}async render(){const e=g(this,Vs,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=g(this,iu,document.createElement("span"));e.append(t),a(this,bi)?(e.classList.add("new"),e.setAttribute("data-l10n-id",a(pn,xo).missing),t.setAttribute("data-l10n-id",a(pn,xo)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=a(this,kn)._uiManager._signal;e.addEventListener("contextmenu",ds,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),a(this,kn)._uiManager.editAltText(a(this,kn)),a(this,bi)&&a(this,kn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:a(this,ii,rd)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(g(this,ru,!0),i(r))},{signal:s}),await A(this,ii,Qg).call(this),e}finish(){a(this,Vs)&&(a(this,Vs).focus({focusVisible:a(this,ru)}),g(this,ru,!1))}isEmpty(){return a(this,bi)?a(this,Lt)===null:!a(this,Lt)&&!a(this,wi)}hasData(){return a(this,bi)?a(this,Lt)!==null||!!a(this,nr):this.isEmpty()}get guessedText(){return a(this,nr)}async setGuessedText(e){a(this,Lt)===null&&(g(this,nr,e),g(this,Fa,await pn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),A(this,ii,Qg).call(this))}toggleAltTextBadge(e=!1){var t;if(!a(this,bi)||a(this,Lt)){(t=a(this,Si))==null||t.remove(),g(this,Si,null);return}if(!a(this,Si)){const s=g(this,Si,document.createElement("div"));s.className="noAltTextBadge",a(this,kn).div.append(s)}a(this,Si).classList.toggle("hidden",!e)}serialize(e){let t=a(this,Lt);return!e&&a(this,nr)===t&&(t=a(this,Fa)),{altText:t,decorative:a(this,wi),guessedText:a(this,nr),textWithDisclaimer:a(this,Fa)}}get data(){return{altText:a(this,Lt),decorative:a(this,wi)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(g(this,nr,s),g(this,Fa,i)),!(a(this,Lt)===e&&a(this,wi)===t)&&(r||(g(this,Lt,e),g(this,wi,t)),A(this,ii,Qg).call(this))}toggle(e=!1){a(this,Vs)&&(!e&&a(this,$n)&&(clearTimeout(a(this,$n)),g(this,$n,null)),a(this,Vs).disabled=!e)}shown(){a(this,kn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:a(this,ii,rd)}})}destroy(){var e,t;(e=a(this,Vs))==null||e.remove(),g(this,Vs,null),g(this,iu,null),g(this,xi,null),(t=a(this,Si))==null||t.remove(),g(this,Si,null)}};Lt=new WeakMap,wi=new WeakMap,Vs=new WeakMap,iu=new WeakMap,xi=new WeakMap,$n=new WeakMap,ru=new WeakMap,Si=new WeakMap,kn=new WeakMap,nr=new WeakMap,Fa=new WeakMap,bi=new WeakMap,xo=new WeakMap,ii=new WeakSet,rd=function(){return a(this,Lt)&&"added"||a(this,Lt)===null&&this.guessedText&&"review"||"missing"},Qg=async function(){var i,r,o;const e=a(this,Vs);if(!e)return;if(a(this,bi)){if(e.classList.toggle("done",!!a(this,Lt)),e.setAttribute("data-l10n-id",a(pn,xo)[a(this,ii,rd)]),(i=a(this,iu))==null||i.setAttribute("data-l10n-id",a(pn,xo)[`${a(this,ii,rd)}-label`]),!a(this,Lt)){(r=a(this,xi))==null||r.remove();return}}else{if(!a(this,Lt)&&!a(this,wi)){e.classList.remove("done"),(o=a(this,xi))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=a(this,xi);if(!t){g(this,xi,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${a(this,kn).id}`;const l=100,c=a(this,kn)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(a(this,$n)),g(this,$n,null)},{once:!0}),e.addEventListener("mouseenter",()=>{g(this,$n,setTimeout(()=>{g(this,$n,null),a(this,xi).classList.add("show"),a(this,kn)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;a(this,$n)&&(clearTimeout(a(this,$n)),g(this,$n,null)),(u=a(this,xi))==null||u.classList.remove("show")},{signal:c})}a(this,wi)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=a(this,Lt)),t.parentNode||e.append(t);const s=a(this,kn).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},b(pn,xo,null),F(pn,"_l10n",null);let ny=pn;var Ut,As,ja,Ue,Af,Oa,Gs,Ba,za,Ua,Ef,aw;class _g{constructor(e){b(this,Ef);b(this,Ut,null);b(this,As,null);b(this,ja,!1);b(this,Ue,null);b(this,Af,null);b(this,Oa,null);b(this,Gs,null);b(this,Ba,null);b(this,za,!1);b(this,Ua,null);g(this,Ue,e)}renderForToolbar(){const e=g(this,As,document.createElement("button"));return e.className="comment",A(this,Ef,aw).call(this,e,!1)}renderForStandalone(){const e=g(this,Ut,document.createElement("button"));e.className="annotationCommentButton";const t=a(this,Ue).commentButtonPosition;if(t){const{style:s}=e;s.insetInlineEnd=`calc(${100*(a(this,Ue)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=a(this,Ue).commentButtonColor;i&&(s.backgroundColor=i)}return A(this,Ef,aw).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=a(this,Ut)??a(this,As))==null||e.focus()},0)}onUpdatedColor(){if(!a(this,Ut))return;const e=a(this,Ue).commentButtonColor;e&&(a(this,Ut).style.backgroundColor=e),a(this,Ue)._uiManager.updatePopupColor(a(this,Ue))}get commentButtonWidth(){var e;return(((e=a(this,Ut))==null?void 0:e.getBoundingClientRect().width)??0)/a(this,Ue).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(a(this,Ua))return a(this,Ua);if(!a(this,Ut))return null;const{x:e,y:t,height:s}=a(this,Ut).getBoundingClientRect(),{x:i,y:r,width:o,height:l}=a(this,Ue).parent.boundingClientRect;return[(e-i)/o,(t+s-r)/l]}set commentPopupPositionInLayer(e){g(this,Ua,e)}hasDefaultPopupPosition(){return a(this,Ua)===null}removeStandaloneCommentButton(){var e;(e=a(this,Ut))==null||e.remove(),g(this,Ut,null)}removeToolbarCommentButton(){var e;(e=a(this,As))==null||e.remove(),g(this,As,null)}setCommentButtonStates({selected:e,hasPopup:t}){a(this,Ut)&&(a(this,Ut).classList.toggle("selected",e),a(this,Ut).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let s,i;if(t)[s,i]=t;else{[s,i]=a(this,Ue).commentButtonPosition;const{width:h,height:d,x:f,y:m}=a(this,Ue);s=f+s*h,i=m+i*d}const r=a(this,Ue).parent.boundingClientRect,{x:o,y:l,width:c,height:u}=r;a(this,Ue)._uiManager.editComment(a(this,Ue),o+s*c,l+i*u,{...e,parentDimensions:r})}finish(){a(this,As)&&(a(this,As).focus({focusVisible:a(this,ja)}),g(this,ja,!1))}isDeleted(){return a(this,za)||a(this,Gs)===""}isEmpty(){return a(this,Gs)===null}hasBeenEdited(){return this.isDeleted()||a(this,Gs)!==a(this,Af)}serialize(){return this.data}get data(){return{text:a(this,Gs),richText:a(this,Oa),date:a(this,Ba),deleted:this.isDeleted()}}set data(e){if(e!==a(this,Gs)&&g(this,Oa,null),e===null){g(this,Gs,""),g(this,za,!0);return}g(this,Gs,e),g(this,Ba,new Date),g(this,za,!1)}setInitialText(e,t=null){g(this,Af,e),this.data=e,g(this,Ba,null),g(this,Oa,t)}shown(){}destroy(){var e,t;(e=a(this,As))==null||e.remove(),g(this,As,null),(t=a(this,Ut))==null||t.remove(),g(this,Ut,null),g(this,Gs,""),g(this,Oa,null),g(this,Ba,null),g(this,Ue,null),g(this,ja,!1),g(this,za,!1)}}Ut=new WeakMap,As=new WeakMap,ja=new WeakMap,Ue=new WeakMap,Af=new WeakMap,Oa=new WeakMap,Gs=new WeakMap,Ba=new WeakMap,za=new WeakMap,Ua=new WeakMap,Ef=new WeakSet,aw=function(e,t){if(!a(this,Ue)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[a(this,Ue)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const s=a(this,Ue)._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return e;e.addEventListener("contextmenu",ds,{signal:s}),t&&(e.addEventListener("focusin",r=>{a(this,Ue)._focusEventsAllowed=!1,tt(r)},{capture:!0,signal:s}),e.addEventListener("focusout",r=>{a(this,Ue)._focusEventsAllowed=!0,tt(r)},{capture:!0,signal:s})),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),e===a(this,As)?this.edit():a(this,Ue).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(g(this,ja,!0),i(r))},{signal:s}),e.addEventListener("pointerenter",()=>{a(this,Ue).toggleComment(!1,!0)},{signal:s}),e.addEventListener("pointerleave",()=>{a(this,Ue).toggleComment(!1,!1)},{signal:s}),e};var ou,$a,Cf,_f,kf,Tf,Pf,sr,Ha,ir,Va,rr,ma,qC,YC,KC;const F1=class F1{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:o=null,signal:l}){b(this,ma);b(this,ou);b(this,$a,!1);b(this,Cf,null);b(this,_f);b(this,kf);b(this,Tf);b(this,Pf);b(this,sr,null);b(this,Ha);b(this,ir,null);b(this,Va);b(this,rr,null);g(this,ou,e),g(this,Cf,s),g(this,_f,t),g(this,kf,i),g(this,Tf,r),g(this,Pf,o),g(this,Va,new AbortController),g(this,Ha,AbortSignal.any([l,a(this,Va).signal])),e.addEventListener("touchstart",A(this,ma,qC).bind(this),{passive:!1,signal:a(this,Ha)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/li.pixelRatio}destroy(){var e,t;(e=a(this,Va))==null||e.abort(),g(this,Va,null),(t=a(this,sr))==null||t.abort(),g(this,sr,null)}};ou=new WeakMap,$a=new WeakMap,Cf=new WeakMap,_f=new WeakMap,kf=new WeakMap,Tf=new WeakMap,Pf=new WeakMap,sr=new WeakMap,Ha=new WeakMap,ir=new WeakMap,Va=new WeakMap,rr=new WeakMap,ma=new WeakSet,qC=function(e){var i,r,o;if((i=a(this,_f))!=null&&i.call(this))return;if(e.touches.length===1){if(a(this,sr))return;const l=g(this,sr,new AbortController),c=AbortSignal.any([a(this,Ha),l.signal]),u=a(this,ou),h={capture:!0,signal:c,passive:!1},d=f=>{var m;f.pointerType==="touch"&&((m=a(this,sr))==null||m.abort(),g(this,sr,null))};u.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(tt(f),d(f))},h),u.addEventListener("pointerup",d,h),u.addEventListener("pointercancel",d,h);return}if(!a(this,rr)){g(this,rr,new AbortController);const l=AbortSignal.any([a(this,Ha),a(this,rr).signal]),c=a(this,ou),u={signal:l,capture:!1,passive:!1};c.addEventListener("touchmove",A(this,ma,YC).bind(this),u);const h=A(this,ma,KC).bind(this);c.addEventListener("touchend",h,u),c.addEventListener("touchcancel",h,u),u.capture=!0,c.addEventListener("pointerdown",tt,u),c.addEventListener("pointermove",tt,u),c.addEventListener("pointercancel",tt,u),c.addEventListener("pointerup",tt,u),(r=a(this,kf))==null||r.call(this)}if(tt(e),e.touches.length!==2||(o=a(this,Cf))!=null&&o.call(this)){g(this,ir,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),g(this,ir,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},YC=function(e){var E;if(!a(this,ir)||e.touches.length!==2)return;tt(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:o,screenY:l}=s,c=a(this,ir),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=c,m=d-u,S=f-h,x=o-i,C=l-r,y=Math.hypot(x,C)||1,w=Math.hypot(m,S)||1;if(!a(this,$a)&&Math.abs(w-y)<=F1.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=o,c.touch1Y=l,!a(this,$a)){g(this,$a,!0);return}const v=[(i+o)/2,(r+l)/2];(E=a(this,Tf))==null||E.call(this,v,w,y)},KC=function(e){var t;e.touches.length>=2||(a(this,rr)&&(a(this,rr).abort(),g(this,rr,null),(t=a(this,Pf))==null||t.call(this)),a(this,ir)&&(tt(e),g(this,ir,null),g(this,$a,!1)))};let sf=F1;var Ga,Ws,Ye,Fe,or,au,So,Lf,$t,Wa,ar,Ai,bo,Nf,Xa,Hn,Rf,qa,lr,Ei,lu,cu,Es,Ya,Mf,yy,ne,lw,Df,cw,Jg,QC,JC,uw,Zg,hw,ZC,e_,t_,dw,n_,fw,s_,i_,r_,pw,od;const ce=class ce{constructor(e){b(this,ne);b(this,Ga,null);b(this,Ws,null);b(this,Ye,null);b(this,Fe,null);b(this,or,null);b(this,au,!1);b(this,So,null);b(this,Lf,"");b(this,$t,null);b(this,Wa,null);b(this,ar,null);b(this,Ai,null);b(this,bo,null);b(this,Nf,"");b(this,Xa,!1);b(this,Hn,null);b(this,Rf,!1);b(this,qa,!1);b(this,lr,!1);b(this,Ei,null);b(this,lu,0);b(this,cu,0);b(this,Es,null);b(this,Ya,null);F(this,"isSelected",!1);F(this,"_isCopy",!1);F(this,"_editToolbar",null);F(this,"_initialOptions",Object.create(null));F(this,"_initialData",null);F(this,"_isVisible",!0);F(this,"_uiManager",null);F(this,"_focusEventsAllowed",!0);b(this,Mf,!1);b(this,yy,ce._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,o];const[l,c]=this.parentDimensions;this.x=e.x/l,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ce.prototype._resizeWithKeyboard,t=ga.TRANSLATE_SMALL,s=ga.TRANSLATE_BIG;return he(this,"_resizerKeyboardManager",new Zp([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],ce.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return he(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new PN({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ce._l10n??(ce._l10n=e),ce._l10nResizer||(ce._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ce._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ce._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){ze("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return a(this,Mf)}set _isDraggable(e){var t;g(this,Mf,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=a(this,yy)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(A(this,ne,od).call(this),(t=a(this,Ai))==null||t.remove(),g(this,Ai,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(a(this,Xa)?g(this,Xa,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,o]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}translate(e,t){A(this,ne,lw).call(this,this.parentDimensions,e,t)}translateInPage(e,t){a(this,Hn)||g(this,Hn,[this.x,this.y,this.width,this.height]),A(this,ne,lw).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){a(this,Hn)||g(this,Hn,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:l}=this;const[c,u]=this.getBaseTranslation();o+=c,l+=u;const{style:h}=s;h.left=`${(100*o).toFixed(2)}%`,h.top=`${(100*l).toFixed(2)}%`,this._onTranslating(o,l),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!a(this,Hn)&&(a(this,Hn)[0]!==this.x||a(this,Hn)[1]!==this.y)}get _hasBeenResized(){return!!a(this,Hn)&&(a(this,Hn)[2]!==this.width||a(this,Hn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=ce,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:o,width:l,height:c}=this;if(l*=s,c*=i,r*=s,o*=i,this._mustFixPosition)switch(e){case 0:r=ln(r,0,s-l),o=ln(o,0,i-c);break;case 90:r=ln(r,0,s-c),o=ln(o,l,i);break;case 180:r=ln(r,l,s),o=ln(o,c,i);break;case 270:r=ln(r,c,s),o=ln(o,0,i-l);break}this.x=r/=s,this.y=o/=i;const[u,h]=this.getBaseTranslation();r+=u,o+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return A(s=ce,Df,cw).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return A(s=ce,Df,cw).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(){const{div:{style:e},width:t,height:s}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=a(this,Ye))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||a(this,qa))return this._editToolbar;this._editToolbar=new Q0(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=a(this,Ye))==null||t.destroy()}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return a(this,Ye)||(ny.initialize(ce._l10n),g(this,Ye,new ny(this)),a(this,Ga)&&(a(this,Ye).data=a(this,Ga),g(this,Ga,null))),a(this,Ye)}get altTextData(){var e;return(e=a(this,Ye))==null?void 0:e.data}set altTextData(e){a(this,Ye)&&(a(this,Ye).data=e)}get guessedAltText(){var e;return(e=a(this,Ye))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=a(this,Ye))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=a(this,Ye))==null?void 0:t.serialize(e)}hasAltText(){return!!a(this,Ye)&&!a(this,Ye).isEmpty()}hasAltTextData(){var e;return((e=a(this,Ye))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=a(this,Fe))==null||e.focusButton()}addCommentButton(){return a(this,Fe)||g(this,Fe,new _g(this))}addStandaloneCommentButton(){if(a(this,or)){this._uiManager.isEditingMode()&&a(this,or).classList.remove("hidden");return}this.hasComment&&(g(this,or,a(this,Fe).renderForStandalone()),this.div.append(a(this,or)))}removeStandaloneCommentButton(){a(this,Fe).removeStandaloneCommentButton(),g(this,or,null)}hideStandaloneCommentButton(){var e;(e=a(this,or))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:s,deleted:i}}=a(this,Fe);return{text:t,richText:e,date:s,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){a(this,Fe)||g(this,Fe,new _g(this)),a(this,Fe).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:s}){if(!t||(a(this,Fe)||g(this,Fe,new _g(this)),a(this,Fe).setInitialText(e,s),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=a(this,Fe))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=a(this,Fe))==null?void 0:e.isDeleted()}get hasComment(){return!!a(this,Fe)&&!a(this,Fe).isEmpty()&&!a(this,Fe).isDeleted()}async editComment(e){a(this,Fe)||g(this,Fe,new _g(this)),a(this,Fe).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){a(this,Fe).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[r]=this.pageDimensions,[o]=this.pageTranslation,l=o+r+1,c=i-100,u=l+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[l,c,u,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){a(this,Fe).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=a(this,au)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),A(this,ne,fw).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),FC(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(a(this,Ya)||g(this,Ya,new sf({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:A(this,ne,ZC).bind(this),onPinching:A(this,ne,e_).bind(this),onPinchEnd:A(this,ne,t_).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=Bt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(g(this,Xa,!0),this._isDraggable){A(this,ne,n_).call(this,e);return}A(this,ne,dw).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){a(this,Ei)&&clearTimeout(a(this,Ei)),g(this,Ei,setTimeout(()=>{var e;g(this,Ei,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,o]=this.pageDimensions,[l,c]=this.pageTranslation,u=e/i,h=t/i,d=this.x*r,f=this.y*o,m=this.width*r,S=this.height*o;switch(s){case 0:return[d+u+l,o-f-h-S+c,d+u+m+l,o-f-h+c];case 90:return[d+h+l,o-f+u+c,d+h+S+l,o-f+u+m+c];case 180:return[d-u-m+l,o-f+h+c,d-u+l,o-f+h+S+c];case 270:return[d-h-S+l,o-f-u-m+c,d-h+l,o-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,o]=e,l=r-s,c=o-i;switch(this.rotation){case 0:return[s,t-o,l,c];case 90:return[s,t-i,c,l];case 180:return[r,t-i,l,c];case 270:return[r,t-o,c,l];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ce._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=a(this,Fe))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:s,opacity:i,deleted:r,richText:o},uid:l,pageIndex:c,creationDate:u,modificationDate:h}=this;return{id:l,pageIndex:c,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:u,modificationDate:s||h,popupRef:!r,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),g(this,qa,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),g(this,qa,!1),!0):!1}isInEditMode(){return a(this,qa)}shouldGetKeyboardEvents(){return a(this,lr)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return t<o&&i>0&&e<r&&s>0}rebuild(){A(this,ne,fw).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var s;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((s=this._initialData)==null?void 0:s.popupRef)||""}}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,g(i,Ga,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,o]=i.pageDimensions,[l,c,u,h]=i.getRectInCurrentCoords(e.rect,o);return i.x=l/r,i.y=c/o,i.width=u/r,i.height=h/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=a(this,bo))==null||e.abort(),g(this,bo,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),a(this,Ei)&&(clearTimeout(a(this,Ei)),g(this,Ei,null)),A(this,ne,od).call(this),this.removeEditToolbar(),a(this,Es)){for(const s of a(this,Es).values())clearTimeout(s);g(this,Es,null)}this.parent=null,(t=a(this,Ya))==null||t.destroy(),g(this,Ya,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,ne,QC).call(this),a(this,$t).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[s,i,r,o]=this.getPDFRect();return[ce._round(s+(r-s)*e),ce._round(i+(o-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return a(this,Fe).commentPopupPositionInLayer}set commentPopupPosition(e){a(this,Fe).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return a(this,Fe).hasDefaultPopupPosition()}get commentButtonWidth(){return a(this,Fe).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){a(this,Fe).setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),g(this,ar,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=a(this,$t).children;if(!a(this,Ws)){g(this,Ws,Array.from(t));const o=A(this,ne,s_).bind(this),l=A(this,ne,i_).bind(this),c=this._uiManager._signal;for(const u of a(this,Ws)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:c}),u.addEventListener("blur",l,{signal:c}),u.addEventListener("focus",A(this,ne,r_).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",ce._l10nResizer[h])}}const s=a(this,Ws)[0];let i=0;for(const o of t){if(o===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(a(this,Ws).length/4);if(r!==i){if(r<i)for(let l=0;l<i-r;l++)a(this,$t).append(a(this,$t).firstChild);else if(r>i)for(let l=0;l<r-i;l++)a(this,$t).firstChild.before(a(this,$t).lastChild);let o=0;for(const l of t){const u=a(this,Ws)[o++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",ce._l10nResizer[u])}}A(this,ne,pw).call(this,0),g(this,lr,!0),a(this,$t).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){a(this,lr)&&A(this,ne,hw).call(this,a(this,Nf),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){A(this,ne,od).call(this),this.div.focus()}select(){var e,t,s;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=a(this,Ye))==null||s.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,s,i,r;this.isSelected&&(this.isSelected=!1,(e=a(this,$t))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=a(this,Ye))==null||r.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return a(this,Rf)}set isEditing(e){g(this,Rf,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){a(this,Es)||g(this,Es,new Map);const{action:s}=e;let i=a(this,Es).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),a(this,Es).delete(s),a(this,Es).size===0&&g(this,Es,null)},ce._telemetryTimeout),a(this,Es).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),g(this,au,!1)}disable(){this.div&&(this.div.tabIndex=-1),g(this,au,!0)}updateFakeAnnotationElement(e){if(!a(this,Ai)&&!this.deleted){g(this,Ai,e.addFakeAnnotation(this));return}if(this.deleted){a(this,Ai).remove(),g(this,Ai,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&a(this,Ai).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Ga=new WeakMap,Ws=new WeakMap,Ye=new WeakMap,Fe=new WeakMap,or=new WeakMap,au=new WeakMap,So=new WeakMap,Lf=new WeakMap,$t=new WeakMap,Wa=new WeakMap,ar=new WeakMap,Ai=new WeakMap,bo=new WeakMap,Nf=new WeakMap,Xa=new WeakMap,Hn=new WeakMap,Rf=new WeakMap,qa=new WeakMap,lr=new WeakMap,Ei=new WeakMap,lu=new WeakMap,cu=new WeakMap,Es=new WeakMap,Ya=new WeakMap,Mf=new WeakMap,yy=new WeakMap,ne=new WeakSet,lw=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Df=new WeakSet,cw=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Jg=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},QC=function(){if(a(this,$t))return;g(this,$t,document.createElement("div")),a(this,$t).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");a(this,$t).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",A(this,ne,JC).bind(this,s),{signal:t}),i.addEventListener("contextmenu",ds,{signal:t}),i.tabIndex=-1}this.div.prepend(a(this,$t))},JC=function(e,t){var h;t.preventDefault();const{isMac:s}=Bt.platform;if(t.button!==0||t.ctrlKey&&s)return;(h=a(this,Ye))==null||h.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,g(this,Wa,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,ne,hw).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",tt,{passive:!1,signal:o}),window.addEventListener("contextmenu",ds,{signal:o}),g(this,ar,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var d;r.abort(),this.parent.togglePointerEvents(!0),(d=a(this,Ye))==null||d.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=c,A(this,ne,Zg).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},uw=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},Zg=function(){if(!a(this,ar))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=a(this,ar);g(this,ar,null);const r=this.x,o=this.y,l=this.width,c=this.height;r===e&&o===t&&l===s&&c===i||this.addCommands({cmd:A(this,ne,uw).bind(this,r,o,l,c),undo:A(this,ne,uw).bind(this,e,t,s,i),mustExec:!0})},hw=function(e,t){const[s,i]=this.parentDimensions,r=this.x,o=this.y,l=this.width,c=this.height,u=ce.MIN_SIZE/s,h=ce.MIN_SIZE/i,d=A(this,ne,Jg).call(this,this.rotation),f=(z,B)=>[d[0]*z+d[2]*B,d[1]*z+d[3]*B],m=A(this,ne,Jg).call(this,360-this.rotation),S=(z,B)=>[m[0]*z+m[2]*B,m[1]*z+m[3]*B];let x,C,y=!1,w=!1;switch(e){case"topLeft":y=!0,x=(z,B)=>[0,0],C=(z,B)=>[z,B];break;case"topMiddle":x=(z,B)=>[z/2,0],C=(z,B)=>[z/2,B];break;case"topRight":y=!0,x=(z,B)=>[z,0],C=(z,B)=>[0,B];break;case"middleRight":w=!0,x=(z,B)=>[z,B/2],C=(z,B)=>[0,B/2];break;case"bottomRight":y=!0,x=(z,B)=>[z,B],C=(z,B)=>[0,0];break;case"bottomMiddle":x=(z,B)=>[z/2,B],C=(z,B)=>[z/2,0];break;case"bottomLeft":y=!0,x=(z,B)=>[0,B],C=(z,B)=>[z,0];break;case"middleLeft":w=!0,x=(z,B)=>[0,B/2],C=(z,B)=>[z,B/2];break}const v=x(l,c),E=C(l,c);let _=f(...E);const k=ce._round(r+_[0]),T=ce._round(o+_[1]);let L=1,R=1,N,M;if(t.fromKeyboard)({deltaX:N,deltaY:M}=t);else{const{screenX:z,screenY:B}=t,[D,U]=a(this,Wa);[N,M]=this.screenToPageTranslation(z-D,B-U),a(this,Wa)[0]=z,a(this,Wa)[1]=B}if([N,M]=S(N/s,M/i),y){const z=Math.hypot(l,c);L=R=Math.max(Math.min(Math.hypot(E[0]-v[0]-N,E[1]-v[1]-M)/z,1/l,1/c),u/l,h/c)}else w?L=ln(Math.abs(E[0]-v[0]-N),u,1)/l:R=ln(Math.abs(E[1]-v[1]-M),h,1)/c;const O=ce._round(l*L),V=ce._round(c*R);_=f(...C(O,V));const H=k-_[0],te=T-_[1];a(this,Hn)||g(this,Hn,[this.x,this.y,this.width,this.height]),this.width=O,this.height=V,this.x=H,this.y=te,this.setDims(),this.fixAndSetPosition(),this._onResizing()},ZC=function(){var e;g(this,ar,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=a(this,Ye))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},e_=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const o=A(this,ne,Jg).call(this,this.rotation),l=(k,T)=>[o[0]*k+o[2]*T,o[1]*k+o[3]*T],[c,u]=this.parentDimensions,h=this.x,d=this.y,f=this.width,m=this.height,S=ce.MIN_SIZE/c,x=ce.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/m),S/f,x/m);const C=ce._round(f*r),y=ce._round(m*r);if(C===f&&y===m)return;a(this,Hn)||g(this,Hn,[h,d,f,m]);const w=l(f/2,m/2),v=ce._round(h+w[0]),E=ce._round(d+w[1]),_=l(C/2,y/2);this.x=v-_[0],this.y=E-_[1],this.width=C,this.height=y,this.setDims(),this.fixAndSetPosition(),this._onResizing()},t_=function(){var e;(e=a(this,Ye))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),A(this,ne,Zg).call(this)},dw=function(e){const{isMac:t}=Bt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},n_=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:r},l=u=>{i.abort(),g(this,So,null),g(this,Xa,!1),this._uiManager.endDragSession()||A(this,ne,dw).call(this,u),s&&this._onStopDragging()};t&&(g(this,lu,e.clientX),g(this,cu,e.clientY),g(this,So,e.pointerId),g(this,Lf,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:h,clientY:d,pointerId:f}=u;if(f!==a(this,So)){tt(u);return}const[m,S]=this.screenToPageTranslation(h-a(this,lu),d-a(this,cu));g(this,lu,h),g(this,cu,d),this._uiManager.dragSelectedEditors(m,S)},o),window.addEventListener("touchmove",tt,o),window.addEventListener("pointerdown",u=>{u.pointerType===a(this,Lf)&&(a(this,Ya)||u.isPrimary)&&l(u),tt(u)},o));const c=u=>{if(!a(this,So)||a(this,So)===u.pointerId){l(u);return}tt(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},fw=function(){if(a(this,bo)||!this.div)return;g(this,bo,new AbortController);const e=this._uiManager.combinedSignal(a(this,bo));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},s_=function(e){ce._resizerKeyboardManager.exec(this,e)},i_=function(e){var t;a(this,lr)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==a(this,$t)&&A(this,ne,od).call(this)},r_=function(e){g(this,Nf,a(this,lr)?e:"")},pw=function(e){if(a(this,Ws))for(const t of a(this,Ws))t.tabIndex=e},od=function(){g(this,lr,!1),A(this,ne,pw).call(this,-1),A(this,ne,Zg).call(this)},b(ce,Df),F(ce,"_l10n",null),F(ce,"_l10nResizer",null),F(ce,"_borderLineWidth",-1),F(ce,"_colorManager",new ew),F(ce,"_zIndex",1),F(ce,"_telemetryTimeout",1e3);let He=ce;class PN extends He{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const db=3285377520,gs=4294901760,di=65535;class o_{constructor(e){this.h1=e?e&4294967295:db,this.h2=e?e&4294967295:db}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let x=0,C=e.length;x<C;x++){const y=e.charCodeAt(x);y<=255?t[s++]=y:(t[s++]=y>>>8,t[s++]=y&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,o=new Uint32Array(t.buffer,0,i);let l=0,c=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,m=d&di,S=f&di;for(let x=0;x<i;x++)x&1?(l=o[x],l=l*d&gs|l*m&di,l=l<<15|l>>>17,l=l*f&gs|l*S&di,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(c=o[x],c=c*d&gs|c*m&di,c=c<<15|c>>>17,c=c*f&gs|c*S&di,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(l=0,r){case 3:l^=t[i*4+2]<<16;case 2:l^=t[i*4+1]<<8;case 1:l^=t[i*4],l=l*d&gs|l*m&di,l=l<<15|l>>>17,l=l*f&gs|l*S&di,i&1?u^=l:h^=l}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&gs|e*36045&di,t=t*4283543511&gs|((t<<16|e>>>16)*2950163797&gs)>>>16,e^=t>>>1,e=e*444984403&gs|e*60499&di,t=t*3301882366&gs|((t<<16|e>>>16)*3120437893&gs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const gw=Object.freeze({map:null,hash:"",transfer:void 0});var Ka,Qa,cr,Ht,vy,a_;class E1{constructor(){b(this,vy);b(this,Ka,!1);b(this,Qa,null);b(this,cr,null);b(this,Ht,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=a(this,Ht).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return a(this,Ht).get(e)}remove(e){const t=a(this,Ht).get(e);if(t!==void 0&&(t instanceof He&&a(this,cr).delete(t.annotationElementId),a(this,Ht).delete(e),a(this,Ht).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of a(this,Ht).values())if(s instanceof He)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=a(this,Ht).get(e);let i=!1;if(s!==void 0)for(const[r,o]of Object.entries(t))s[r]!==o&&(i=!0,s[r]=o);else i=!0,a(this,Ht).set(e,t);i&&A(this,vy,a_).call(this),t instanceof He&&((a(this,cr)||g(this,cr,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return a(this,Ht).has(e)}get size(){return a(this,Ht).size}resetModified(){a(this,Ka)&&(g(this,Ka,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new l_(this)}get serializable(){if(a(this,Ht).size===0)return gw;const e=new Map,t=new o_,s=[],i=Object.create(null);let r=!1;for(const[o,l]of a(this,Ht)){const c=l instanceof He?l.serialize(!1,i):l;c&&(e.set(o,c),t.update(`${o}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const o of e.values())o.bitmap&&s.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:gw}get editorStats(){let e=null;const t=new Map;let s=0,i=0;for(const r of a(this,Ht).values()){if(!(r instanceof He)){r.popup&&(r.popup.deleted?i+=1:s+=1);continue}r.isCommentDeleted?i+=1:r.hasEditedComment&&(s+=1);const o=r.telemetryFinalData;if(!o)continue;const{type:l}=o;t.has(l)||t.set(l,Object.getPrototypeOf(r).constructor),e||(e=Object.create(null));const c=e[l]||(e[l]=new Map);for(const[u,h]of Object.entries(o)){if(u==="type")continue;let d=c.get(u);d||(d=new Map,c.set(u,d));const f=d.get(h)??0;d.set(h,f+1)}}if((i>0||s>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:s}),!e)return null;for(const[r,o]of t)e[r]=o.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){g(this,Qa,null)}updateEditor(e,t){var i;const s=(i=a(this,cr))==null?void 0:i.get(e);return s?(s.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=a(this,cr))==null?void 0:t.get(e))||null}get modifiedIds(){if(a(this,Qa))return a(this,Qa);const e=[];if(a(this,cr))for(const t of a(this,cr).values())t.serialize()&&e.push(t.annotationElementId);return g(this,Qa,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return a(this,Ht).entries()}}Ka=new WeakMap,Qa=new WeakMap,cr=new WeakMap,Ht=new WeakMap,vy=new WeakSet,a_=function(){a(this,Ka)||(g(this,Ka,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var If;class l_ extends E1{constructor(t){super();b(this,If);const{map:s,hash:i,transfer:r}=t.serializable,o=structuredClone(s,r?{transfer:r}:null);g(this,If,{map:o,hash:i,transfer:r})}get print(){ze("Should not call PrintAnnotationStorage.print")}get serializable(){return a(this,If)}get modifiedIds(){return he(this,"modifiedIds",{ids:new Set,hash:""})}}If=new WeakMap;var uu;class LN{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){b(this,uu,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),a(this,uu).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||a(this,uu).has(e.loadedName))){if(we(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:o}=e,l=new FontFace(i,r,o);this.addNativeFontFace(l);try{await l.load(),a(this,uu).add(i),s==null||s(e)}catch{ae(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}ze("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw ae(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return he(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return he(this,"isSyncFontLoadingSupported",vn||Bt.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(we(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return he(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,_){return E.charCodeAt(_)<<24|E.charCodeAt(_+1)<<16|E.charCodeAt(_+2)<<8|E.charCodeAt(_+3)&255}function i(E,_,k,T){const L=E.substring(0,_),R=E.substring(_+k);return L+T+R}let r,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let u=0;function h(E,_){if(++u>30){ae("Load test font never loaded."),_();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){_();return}setTimeout(h.bind(null,E,_))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,d.length,d);const S=16,x=1482184792;let C=s(f,S);for(r=0,o=d.length-3;r<o;r+=4)C=C-x+s(d,r)|0;r<d.length&&(C=C-x+s(d+"XXX",r)|0),f=i(f,S,4,yN(C));const y=`url(data:font/opentype;base64,${btoa(f)});`,w=`@font-face {font-family:"${d}";src:${y}}`;this.insertRule(w);const v=this._document.createElement("div");v.style.visibility="hidden",v.style.width=v.style.height="10px",v.style.position="absolute",v.style.top=v.style.left="0px";for(const E of[e.loadedName,d]){const _=this._document.createElement("span");_.textContent="Hi",_.style.fontFamily=E,v.append(_)}this._document.body.append(v),h(d,()=>{v.remove(),t.complete()})}}uu=new WeakMap;var Ne;class NN{constructor(e,t=null,s,i){b(this,Ne);this.compiledGlyphs=Object.create(null),g(this,Ne,e),this._inspectFont=t,s&&Object.assign(this,s),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${EC(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(o){ae(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}get black(){return a(this,Ne).black}get bold(){return a(this,Ne).bold}get disableFontFace(){return a(this,Ne).disableFontFace??!1}get fontExtraProperties(){return a(this,Ne).fontExtraProperties??!1}get isInvalidPDFjsFont(){return a(this,Ne).isInvalidPDFjsFont}get isType3Font(){return a(this,Ne).isType3Font}get italic(){return a(this,Ne).italic}get missingFile(){return a(this,Ne).missingFile}get remeasure(){return a(this,Ne).remeasure}get vertical(){return a(this,Ne).vertical}get ascent(){return a(this,Ne).ascent}get defaultWidth(){return a(this,Ne).defaultWidth}get descent(){return a(this,Ne).descent}get bbox(){return a(this,Ne).bbox}get fontMatrix(){return a(this,Ne).fontMatrix}get fallbackName(){return a(this,Ne).fallbackName}get loadedName(){return a(this,Ne).loadedName}get mimetype(){return a(this,Ne).mimetype}get name(){return a(this,Ne).name}get data(){return a(this,Ne).data}clearData(){a(this,Ne).clearData()}get cssFontInfo(){return a(this,Ne).cssFontInfo}get systemFontInfo(){return a(this,Ne).systemFontInfo}get defaultVMetrics(){return a(this,Ne).defaultVMetrics}}Ne=new WeakMap;function RN(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(vn)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function MN(n){if(vn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Kp(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function kg(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const mw=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,DN=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",c_=SN.bind(null,mw,DN);var ur,wy;class IN{constructor(){b(this,ur,new Map);b(this,wy,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};a(this,wy).then(()=>{for(const[i]of a(this,ur))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){ae("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}a(this,ur).set(t,i)}removeEventListener(e,t){const s=a(this,ur).get(t);s==null||s(),a(this,ur).delete(t)}terminate(){for(const[,e]of a(this,ur))e==null||e();a(this,ur).clear()}}ur=new WeakMap,wy=new WeakMap;const Tg={DATA:1,ERROR:2},wt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function fb(){}function Cn(n){if(n instanceof $r||n instanceof ey||n instanceof rb||n instanceof ef||n instanceof Vv)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||ze('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new $r(n.message);case"InvalidPDFException":return new ey(n.message);case"PasswordException":return new rb(n.message,n.code);case"ResponseException":return new ef(n.message,n.status,n.missing);case"UnknownErrorException":return new Vv(n.message,n.details)}return new Vv(n.message,n.toString())}var hu,Is,u_,h_,d_,em;class ad{constructor(e,t,s){b(this,Is);b(this,hu,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",A(this,Is,u_).bind(this),{signal:a(this,hu).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(o){r.reject(o)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,o=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:l,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,c.postMessage({sourceName:o,targetName:l,stream:wt.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{we(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:o,targetName:l,stream:wt.CANCEL,streamId:r,reason:Cn(u)}),h.promise}},s)}destroy(){var e;(e=a(this,hu))==null||e.abort(),g(this,hu,null)}}hu=new WeakMap,Is=new WeakSet,u_=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){A(this,Is,d_).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Tg.DATA)i.resolve(e.data);else if(e.callback===Tg.ERROR)i.reject(Cn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(o){r.postMessage({sourceName:s,targetName:i,callback:Tg.DATA,callbackId:e.callbackId,data:o})},function(o){r.postMessage({sourceName:s,targetName:i,callback:Tg.ERROR,callbackId:e.callbackId,reason:Cn(o)})});return}if(e.streamId){A(this,Is,h_).call(this,e);return}t(e.data)},h_=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this,l=this.actionHandler[e.action],c={enqueue(u,h=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=h,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:wt.ENQUEUE,streamId:t,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:wt.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){we(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:wt.ERROR,streamId:t,reason:Cn(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(l,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:wt.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:wt.START_COMPLETE,streamId:t,reason:Cn(u)})})},d_=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this.streamControllers[t],l=this.streamSinks[t];switch(e.stream){case wt.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Cn(e.reason));break;case wt.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Cn(e.reason));break;case wt.PULL:if(!l){r.postMessage({sourceName:s,targetName:i,stream:wt.PULL_COMPLETE,streamId:t,success:!0});break}l.desiredSize<=0&&e.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=e.desiredSize,Promise.try(l.onPull||fb).then(function(){r.postMessage({sourceName:s,targetName:i,stream:wt.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:wt.PULL_COMPLETE,streamId:t,reason:Cn(u)})});break;case wt.ENQUEUE:if(we(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case wt.CLOSE:if(we(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),A(this,Is,em).call(this,o,t);break;case wt.ERROR:we(o,"error should have stream controller"),o.controller.error(Cn(e.reason)),A(this,Is,em).call(this,o,t);break;case wt.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Cn(e.reason)),A(this,Is,em).call(this,o,t);break;case wt.CANCEL:if(!l)break;const c=Cn(e.reason);Promise.try(l.onCancel||fb,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:wt.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:wt.CANCEL_COMPLETE,streamId:t,reason:Cn(u)})}),l.sinkCapability.reject(c),l.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},em=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var Ff;class f_{constructor({enableHWA:e=!1}){b(this,Ff,!1);g(this,Ff,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!a(this,Ff)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){ze("Abstract method `_createCanvas` called.")}}Ff=new WeakMap;class FN extends f_{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class p_{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){ze("Abstract method `_fetch` called.")}}class pb extends p_{async _fetch(e){const t=await Rh(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Kp(t)}}class g_{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var Ja,du,hr,dr,sn,Za,el,G,en,ld,hc,tm,dc,m_,yw,fc,cd,ud,vw,hd;class jN extends g_{constructor({docId:t,ownerDocument:s=globalThis.document}){super();b(this,G);b(this,Ja);b(this,du);b(this,hr);b(this,dr);b(this,sn);b(this,Za);b(this,el,0);g(this,dr,t),g(this,sn,s)}addFilter(t){if(!t)return"none";let s=a(this,G,en).get(t);if(s)return s;const[i,r,o]=A(this,G,tm).call(this,t),l=t.length===1?i:`${i}${r}${o}`;if(s=a(this,G,en).get(l),s)return a(this,G,en).set(t,s),s;const c=`g_${a(this,dr)}_transfer_map_${At(this,el)._++}`,u=A(this,G,dc).call(this,c);a(this,G,en).set(t,u),a(this,G,en).set(l,u);const h=A(this,G,fc).call(this,c);return A(this,G,ud).call(this,i,r,o,h),u}addHCMFilter(t,s){var S;const i=`${t}-${s}`,r="base";let o=a(this,G,ld).get(r);if((o==null?void 0:o.key)===i||(o?((S=o.filter)==null||S.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},a(this,G,ld).set(r,o)),!t||!s))return o.url;const l=A(this,G,hd).call(this,t);t=X.makeHexColor(...l);const c=A(this,G,hd).call(this,s);if(s=X.makeHexColor(...c),a(this,G,hc).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return o.url;const u=new Array(256);for(let x=0;x<=255;x++){const C=x/255;u[x]=C<=.03928?C/12.92:((C+.055)/1.055)**2.4}const h=u.join(","),d=`g_${a(this,dr)}_hcm_filter`,f=o.filter=A(this,G,fc).call(this,d);A(this,G,ud).call(this,h,h,h,f),A(this,G,yw).call(this,f);const m=(x,C)=>{const y=l[x]/255,w=c[x]/255,v=new Array(C+1);for(let E=0;E<=C;E++)v[E]=y+E/C*(w-y);return v.join(",")};return A(this,G,ud).call(this,m(0,5),m(1,5),m(2,5),f),o.url=A(this,G,dc).call(this,d),o.url}addAlphaFilter(t){let s=a(this,G,en).get(t);if(s)return s;const[i]=A(this,G,tm).call(this,[t]),r=`alpha_${i}`;if(s=a(this,G,en).get(r),s)return a(this,G,en).set(t,s),s;const o=`g_${a(this,dr)}_alpha_map_${At(this,el)._++}`,l=A(this,G,dc).call(this,o);a(this,G,en).set(t,l),a(this,G,en).set(r,l);const c=A(this,G,fc).call(this,o);return A(this,G,vw).call(this,i,c),l}addLuminosityFilter(t){let s=a(this,G,en).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=A(this,G,tm).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=a(this,G,en).get(r),s)return a(this,G,en).set(t,s),s;const o=`g_${a(this,dr)}_luminosity_map_${At(this,el)._++}`,l=A(this,G,dc).call(this,o);a(this,G,en).set(t,l),a(this,G,en).set(r,l);const c=A(this,G,fc).call(this,o);return A(this,G,m_).call(this,c),t&&A(this,G,vw).call(this,i,c),l}addHighlightHCMFilter(t,s,i,r,o){var w;const l=`${s}-${i}-${r}-${o}`;let c=a(this,G,ld).get(t);if((c==null?void 0:c.key)===l||(c?((w=c.filter)==null||w.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},a(this,G,ld).set(t,c)),!s||!i))return c.url;const[u,h]=[s,i].map(A(this,G,hd).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,S]=[r,o].map(A(this,G,hd).bind(this));f<d&&([d,f,m,S]=[f,d,S,m]),a(this,G,hc).style.color="";const x=(v,E,_)=>{const k=new Array(256),T=(f-d)/_,L=v/255,R=(E-v)/(255*_);let N=0;for(let M=0;M<=_;M++){const O=Math.round(d+M*T),V=L+M*R;for(let H=N;H<=O;H++)k[H]=V;N=O+1}for(let M=N;M<256;M++)k[M]=k[N-1];return k.join(",")},C=`g_${a(this,dr)}_hcm_${t}_filter`,y=c.filter=A(this,G,fc).call(this,C);return A(this,G,yw).call(this,y),A(this,G,ud).call(this,x(m[0],S[0],5),x(m[1],S[1],5),x(m[2],S[2],5),y),c.url=A(this,G,dc).call(this,C),c.url}destroy(t=!1){var s,i,r,o;t&&((s=a(this,Za))!=null&&s.size)||((i=a(this,hr))==null||i.parentNode.parentNode.remove(),g(this,hr,null),(r=a(this,du))==null||r.clear(),g(this,du,null),(o=a(this,Za))==null||o.clear(),g(this,Za,null),g(this,el,0))}}Ja=new WeakMap,du=new WeakMap,hr=new WeakMap,dr=new WeakMap,sn=new WeakMap,Za=new WeakMap,el=new WeakMap,G=new WeakSet,en=function(){return a(this,du)||g(this,du,new Map)},ld=function(){return a(this,Za)||g(this,Za,new Map)},hc=function(){if(!a(this,hr)){const t=a(this,sn).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=a(this,sn).createElementNS(Wi,"svg");i.setAttribute("width",0),i.setAttribute("height",0),g(this,hr,a(this,sn).createElementNS(Wi,"defs")),t.append(i),i.append(a(this,hr)),a(this,sn).body.append(t)}return a(this,hr)},tm=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=u[f]/255;const d=h.join(",");return[d,d,d]}const[s,i,r]=t,o=new Array(256),l=new Array(256),c=new Array(256);for(let u=0;u<256;u++)o[u]=s[u]/255,l[u]=i[u]/255,c[u]=r[u]/255;return[o.join(","),l.join(","),c.join(",")]},dc=function(t){if(a(this,Ja)===void 0){g(this,Ja,"");const s=a(this,sn).URL;s!==a(this,sn).baseURI&&(Jp(s)?ae('#createUrl: ignore "data:"-URL for performance reasons.'):g(this,Ja,w1(s,"")))}return`url(${a(this,Ja)}#${t})`},m_=function(t){const s=a(this,sn).createElementNS(Wi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},yw=function(t){const s=a(this,sn).createElementNS(Wi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},fc=function(t){const s=a(this,sn).createElementNS(Wi,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),a(this,G,hc).append(s),s},cd=function(t,s,i){const r=a(this,sn).createElementNS(Wi,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},ud=function(t,s,i,r){const o=a(this,sn).createElementNS(Wi,"feComponentTransfer");r.append(o),A(this,G,cd).call(this,o,"feFuncR",t),A(this,G,cd).call(this,o,"feFuncG",s),A(this,G,cd).call(this,o,"feFuncB",i)},vw=function(t,s){const i=a(this,sn).createElementNS(Wi,"feComponentTransfer");s.append(i),A(this,G,cd).call(this,i,"feFuncA",t)},hd=function(t){return a(this,G,hc).style.color=t,Mh(getComputedStyle(a(this,G,hc)).getPropertyValue("color"))};class y_{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){ze("Abstract method `_fetch` called.")}}class gb extends y_{async _fetch(e){const t=await Rh(e,"arraybuffer");return new Uint8Array(t)}}class v_{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){ze("Abstract method `_fetch` called.")}}class mb extends v_{async _fetch(e){const t=await Rh(e,"arraybuffer");return new Uint8Array(t)}}vn&&ae("Please use the `legacy` build in Node.js environments.");async function C1(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class ON extends g_{}class BN extends f_{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class zN extends p_{async _fetch(e){return C1(e)}}class UN extends y_{async _fetch(e){return C1(e)}}class $N extends v_{async _fetch(e){return C1(e)}}const ac="__forcedDependency",{floor:yb,ceil:vb}=Math;function Pg(n,e,t,s,i,r){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],s),n[e*4+2]=Math.max(n[e*4+2],i),n[e*4+3]=Math.max(n[e*4+3],r)}const ww=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var fu,Ao;class HN{constructor(e,t){b(this,fu);b(this,Ao);g(this,fu,e),g(this,Ao,t)}get length(){return a(this,fu).length}isEmpty(e){return a(this,fu)[e]===ww}minX(e){return a(this,Ao)[e*4+0]/256}minY(e){return a(this,Ao)[e*4+1]/256}maxX(e){return(a(this,Ao)[e*4+2]+1)/256}maxY(e){return(a(this,Ao)[e*4+3]+1)/256}}fu=new WeakMap,Ao=new WeakMap;const Lg=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var Tn,Pn,tl,Xs,nl,fr,Pe,Re,pr,Ln,jf,pu,sl,il,gr,rn,Ci,Of,xw;class VN{constructor(e,t,s=!1){b(this,Of);b(this,Tn,{__proto__:null});b(this,Pn,{__proto__:null,transform:[],moveText:[],sameLineText:[],[ac]:[]});b(this,tl,new Map);b(this,Xs,[]);b(this,nl,[]);b(this,fr,[[1,0,0,1,0,0]]);b(this,Pe,[-1/0,-1/0,1/0,1/0]);b(this,Re,new Float64Array([1/0,1/0,-1/0,-1/0]));b(this,pr,-1);b(this,Ln,new Set);b(this,jf,new Map);b(this,pu,new Map);b(this,sl);b(this,il);b(this,gr);b(this,rn);b(this,Ci);g(this,sl,e.width),g(this,il,e.height),A(this,Of,xw).call(this,t),s&&g(this,Ci,new Map)}growOperationsCount(e){e>=a(this,rn).length&&A(this,Of,xw).call(this,e,a(this,rn))}save(e){return g(this,Tn,{__proto__:a(this,Tn)}),g(this,Pn,{__proto__:a(this,Pn),transform:{__proto__:a(this,Pn).transform},moveText:{__proto__:a(this,Pn).moveText},sameLineText:{__proto__:a(this,Pn).sameLineText},[ac]:{__proto__:a(this,Pn)[ac]}}),g(this,Pe,{__proto__:a(this,Pe)}),a(this,Xs).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(a(this,Tn));if(t===null)return this;g(this,Tn,t),g(this,Pn,Object.getPrototypeOf(a(this,Pn))),g(this,Pe,Object.getPrototypeOf(a(this,Pe)));const s=a(this,Xs).pop();return s!==void 0&&((i=Lg(a(this,Ci),e))==null||i.dependencies.add(s),a(this,rn)[e]=a(this,rn)[s]),this}recordOpenMarker(e){return a(this,Xs).push(e),this}getOpenMarker(){return a(this,Xs).length===0?null:a(this,Xs).at(-1)}recordCloseMarker(e){var s;const t=a(this,Xs).pop();return t!==void 0&&((s=Lg(a(this,Ci),e))==null||s.dependencies.add(t),a(this,rn)[e]=a(this,rn)[t]),this}beginMarkedContent(e){return a(this,nl).push(e),this}endMarkedContent(e){var s;const t=a(this,nl).pop();return t!==void 0&&((s=Lg(a(this,Ci),e))==null||s.dependencies.add(t),a(this,rn)[e]=a(this,rn)[t]),this}pushBaseTransform(e){return a(this,fr).push(X.multiplyByDOMMatrix(a(this,fr).at(-1),e.getTransform())),this}popBaseTransform(){return a(this,fr).length>1&&a(this,fr).pop(),this}recordSimpleData(e,t){return a(this,Tn)[e]=t,this}recordIncrementalData(e,t){return a(this,Pn)[e].push(t),this}resetIncrementalData(e,t){return a(this,Pn)[e].length=0,this}recordNamedData(e,t){return a(this,tl).set(e,t),this}recordSimpleDataFromNamed(e,t,s){a(this,Tn)[e]=a(this,tl).get(t)??s}recordFutureForcedDependency(e,t){return this.recordIncrementalData(ac,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in a(this,Tn)&&this.recordFutureForcedDependency(t,a(this,Tn)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of a(this,Ln))this.recordFutureForcedDependency(ac,e);return this}resetBBox(e){return a(this,pr)!==e&&(g(this,pr,e),a(this,Re)[0]=1/0,a(this,Re)[1]=1/0,a(this,Re)[2]=-1/0,a(this,Re)[3]=-1/0),this}recordClipBox(e,t,s,i,r,o){const l=X.multiplyByDOMMatrix(a(this,fr).at(-1),t.getTransform()),c=[1/0,1/0,-1/0,-1/0];X.axialAlignedBoundingBox([s,r,i,o],l,c);const u=X.intersect(a(this,Pe),c);return u?(a(this,Pe)[0]=u[0],a(this,Pe)[1]=u[1],a(this,Pe)[2]=u[2],a(this,Pe)[3]=u[3]):(a(this,Pe)[0]=a(this,Pe)[1]=1/0,a(this,Pe)[2]=a(this,Pe)[3]=-1/0),this}recordBBox(e,t,s,i,r,o){const l=a(this,Pe);if(l[0]===1/0)return this;const c=X.multiplyByDOMMatrix(a(this,fr).at(-1),t.getTransform());if(l[0]===-1/0)return X.axialAlignedBoundingBox([s,r,i,o],c,a(this,Re)),this;const u=[1/0,1/0,-1/0,-1/0];return X.axialAlignedBoundingBox([s,r,i,o],c,u),a(this,Re)[0]=Math.min(a(this,Re)[0],Math.max(u[0],l[0])),a(this,Re)[1]=Math.min(a(this,Re)[1],Math.max(u[1],l[1])),a(this,Re)[2]=Math.max(a(this,Re)[2],Math.min(u[2],l[2])),a(this,Re)[3]=Math.max(a(this,Re)[3],Math.min(u[3],l[3])),this}recordCharacterBBox(e,t,s,i=1,r=0,o=0,l){const c=s.bbox;let u,h;if(c&&(u=c[2]!==c[0]&&c[3]!==c[1]&&a(this,pu).get(s),u!==!1&&(h=[0,0,0,0],X.axialAlignedBoundingBox(c,s.fontMatrix,h),(i!==1||r!==0||o!==0)&&X.scaleMinMax([i,0,0,-i,r,o],h),u)))return this.recordBBox(e,t,h[0],h[2],h[1],h[3]);if(!l)return this.recordFullPageBBox(e);const d=l();return c&&h&&u===void 0&&(u=h[0]<=r-d.actualBoundingBoxLeft&&h[2]>=r+d.actualBoundingBoxRight&&h[1]<=o-d.actualBoundingBoxAscent&&h[3]>=o+d.actualBoundingBoxDescent,a(this,pu).set(s,u),u)?this.recordBBox(e,t,h[0],h[2],h[1],h[3]):this.recordBBox(e,t,r-d.actualBoundingBoxLeft,r+d.actualBoundingBoxRight,o-d.actualBoundingBoxAscent,o+d.actualBoundingBoxDescent)}recordFullPageBBox(e){return a(this,Re)[0]=Math.max(0,a(this,Pe)[0]),a(this,Re)[1]=Math.max(0,a(this,Pe)[1]),a(this,Re)[2]=Math.min(a(this,sl),a(this,Pe)[2]),a(this,Re)[3]=Math.min(a(this,il),a(this,Pe)[3]),this}getSimpleIndex(e){return a(this,Tn)[e]}recordDependencies(e,t){const s=a(this,Ln),i=a(this,Tn),r=a(this,Pn);for(const o of t)o in a(this,Tn)?s.add(i[o]):o in r&&r[o].forEach(s.add,s);return this}recordNamedDependency(e,t){return a(this,tl).has(t)&&a(this,Ln).add(a(this,tl).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[ac]),a(this,Ci)){const s=Lg(a(this,Ci),e),{dependencies:i}=s;a(this,Ln).forEach(i.add,i),a(this,Xs).forEach(i.add,i),a(this,nl).forEach(i.add,i),i.delete(e),s.isRenderingOperation=!0}if(a(this,pr)===e){const s=yb(a(this,Re)[0]*256/a(this,sl)),i=yb(a(this,Re)[1]*256/a(this,il)),r=vb(a(this,Re)[2]*256/a(this,sl)),o=vb(a(this,Re)[3]*256/a(this,il));Pg(a(this,gr),e,s,i,r,o);for(const l of a(this,Ln))l!==e&&Pg(a(this,gr),l,s,i,r,o);for(const l of a(this,Xs))l!==e&&Pg(a(this,gr),l,s,i,r,o);for(const l of a(this,nl))l!==e&&Pg(a(this,gr),l,s,i,r,o);t||(a(this,Ln).clear(),g(this,pr,-1))}return this}recordShowTextOperation(e,t=!1){const s=Array.from(a(this,Ln));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of s)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return a(this,pr)===e&&(g(this,pr,-1),a(this,Pe)[0]=Math.max(a(this,Pe)[0],a(this,Re)[0]),a(this,Pe)[1]=Math.max(a(this,Pe)[1],a(this,Re)[1]),a(this,Pe)[2]=Math.min(a(this,Pe)[2],a(this,Re)[2]),a(this,Pe)[3]=Math.min(a(this,Pe)[3],a(this,Re)[3]),t||a(this,Ln).clear()),this}_takePendingDependencies(){const e=a(this,Ln);return g(this,Ln,new Set),e}_extractOperation(e){const t=a(this,jf).get(e);return a(this,jf).delete(e),t}_pushPendingDependencies(e){for(const t of e)a(this,Ln).add(t)}take(){return a(this,pu).clear(),new HN(a(this,rn),a(this,gr))}takeDebugMetadata(){return a(this,Ci)}}Tn=new WeakMap,Pn=new WeakMap,tl=new WeakMap,Xs=new WeakMap,nl=new WeakMap,fr=new WeakMap,Pe=new WeakMap,Re=new WeakMap,pr=new WeakMap,Ln=new WeakMap,jf=new WeakMap,pu=new WeakMap,sl=new WeakMap,il=new WeakMap,gr=new WeakMap,rn=new WeakMap,Ci=new WeakMap,Of=new WeakSet,xw=function(e,t){const s=new ArrayBuffer(e*4);g(this,gr,new Uint8ClampedArray(s)),g(this,rn,new Uint32Array(s)),t&&t.length>0?(a(this,rn).set(t),a(this,rn).fill(ww,t.length)):a(this,rn).fill(ww)};var je,ct,qs,gu,mu;const j1=class j1{constructor(e,t,s){b(this,je);b(this,ct);b(this,qs);b(this,gu,0);b(this,mu,0);if(e instanceof j1&&a(e,qs)===!!s)return e;g(this,je,e),g(this,ct,t),g(this,qs,!!s)}growOperationsCount(){throw new Error("Unreachable")}save(e){return At(this,mu)._++,a(this,je).save(a(this,ct)),this}restore(e){return a(this,mu)>0&&(a(this,je).restore(a(this,ct)),At(this,mu)._--),this}recordOpenMarker(e){return At(this,gu)._++,this}getOpenMarker(){return a(this,gu)>0?a(this,ct):a(this,je).getOpenMarker()}recordCloseMarker(e){return At(this,gu)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return a(this,je).pushBaseTransform(e),this}popBaseTransform(){return a(this,je).popBaseTransform(),this}recordSimpleData(e,t){return a(this,je).recordSimpleData(e,a(this,ct)),this}recordIncrementalData(e,t){return a(this,je).recordIncrementalData(e,a(this,ct)),this}resetIncrementalData(e,t){return a(this,je).resetIncrementalData(e,a(this,ct)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,s){return a(this,je).recordSimpleDataFromNamed(e,t,a(this,ct)),this}recordFutureForcedDependency(e,t){return a(this,je).recordFutureForcedDependency(e,a(this,ct)),this}inheritSimpleDataAsFutureForcedDependencies(e){return a(this,je).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return a(this,je).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return a(this,qs)||a(this,je).resetBBox(a(this,ct)),this}recordClipBox(e,t,s,i,r,o){return a(this,qs)||a(this,je).recordClipBox(a(this,ct),t,s,i,r,o),this}recordBBox(e,t,s,i,r,o){return a(this,qs)||a(this,je).recordBBox(a(this,ct),t,s,i,r,o),this}recordCharacterBBox(e,t,s,i,r,o,l){return a(this,qs)||a(this,je).recordCharacterBBox(a(this,ct),t,s,i,r,o,l),this}recordFullPageBBox(e){return a(this,qs)||a(this,je).recordFullPageBBox(a(this,ct)),this}getSimpleIndex(e){return a(this,je).getSimpleIndex(e)}recordDependencies(e,t){return a(this,je).recordDependencies(a(this,ct),t),this}recordNamedDependency(e,t){return a(this,je).recordNamedDependency(a(this,ct),t),this}recordOperation(e){return a(this,je).recordOperation(a(this,ct),!0),this}recordShowTextOperation(e){return a(this,je).recordShowTextOperation(a(this,ct),!0),this}bboxToClipBoxDropOperation(e){return a(this,qs)||a(this,je).bboxToClipBoxDropOperation(a(this,ct),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};je=new WeakMap,ct=new WeakMap,qs=new WeakMap,gu=new WeakMap,mu=new WeakMap;let sy=j1;const ms={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Xt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Sw(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class _1{isModifyingCurrentTransform(){return!1}getPattern(){ze("Abstract method `getPattern` called.")}}class GN extends _1{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Xt.STROKE||i===Xt.FILL){const o=t.current.getClippedPathBoundingBox(i,Ze(e))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",l,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-o[0],-o[1]),s=X.transform(s,[1,0,0,1,o[0],o[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),Sw(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(s);r.setTransform(d)}else Sw(e,this._bbox),r=this._createGradient(e);return r}}function Xv(n,e,t,s,i,r,o,l){const c=e.coords,u=e.colors,h=n.data,d=n.width*4;let f;c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=o,o=f),c[s+1]>c[i+1]&&(f=s,s=i,i=f,f=o,o=l,l=f),c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=o,o=f);const m=(c[t]+e.offsetX)*e.scaleX,S=(c[t+1]+e.offsetY)*e.scaleY,x=(c[s]+e.offsetX)*e.scaleX,C=(c[s+1]+e.offsetY)*e.scaleY,y=(c[i]+e.offsetX)*e.scaleX,w=(c[i+1]+e.offsetY)*e.scaleY;if(S>=w)return;const v=u[r],E=u[r+1],_=u[r+2],k=u[o],T=u[o+1],L=u[o+2],R=u[l],N=u[l+1],M=u[l+2],O=Math.round(S),V=Math.round(w);let H,te,z,B,D,U,K,le;for(let Z=O;Z<=V;Z++){if(Z<C){const ye=Z<S?0:(S-Z)/(S-C);H=m-(m-x)*ye,te=v-(v-k)*ye,z=E-(E-T)*ye,B=_-(_-L)*ye}else{let ye;Z>w?ye=1:C===w?ye=0:ye=(C-Z)/(C-w),H=x-(x-y)*ye,te=k-(k-R)*ye,z=T-(T-N)*ye,B=L-(L-M)*ye}let se;Z<S?se=0:Z>w?se=1:se=(S-Z)/(S-w),D=m-(m-y)*se,U=v-(v-R)*se,K=E-(E-N)*se,le=_-(_-M)*se;const _e=Math.round(Math.min(H,D)),J=Math.round(Math.max(H,D));let ie=d*Z+_e*4;for(let ye=_e;ye<=J;ye++)se=(H-ye)/(H-D),se<0?se=0:se>1&&(se=1),h[ie++]=te-(te-U)*se|0,h[ie++]=z-(z-K)*se|0,h[ie++]=B-(B-le)*se|0,h[ie++]=255}}function WN(n,e,t){const s=e.coords,i=e.colors;let r,o;switch(e.type){case"lattice":const l=e.verticesPerRow,c=Math.floor(s.length/l)-1,u=l-1;for(r=0;r<c;r++){let h=r*l;for(let d=0;d<u;d++,h++)Xv(n,t,s[h],s[h+1],s[h+l],i[h],i[h+1],i[h+l]),Xv(n,t,s[h+l+1],s[h+1],s[h+l],i[h+l+1],i[h+1],i[h+l])}break;case"triangles":for(r=0,o=s.length;r<o;r+=3)Xv(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class XN extends _1{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-l,h=Math.ceil(this._bounds[3])-c,d=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),m=u/d,S=h/f,x={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/m,scaleY:1/S},C=d+2*2,y=f+2*2,w=s.getCanvas("mesh",C,y),v=w.context,E=v.createImageData(d,f);if(t){const k=E.data;for(let T=0,L=k.length;T<L;T+=4)k[T]=t[0],k[T+1]=t[1],k[T+2]=t[2],k[T+3]=255}for(const k of this._figures)WN(E,k,x);return v.putImageData(E,2,2),{canvas:w.canvas,offsetX:l-2*m,offsetY:c-2*S,scaleX:m,scaleY:S}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){Sw(e,this._bbox);const r=new Float32Array(2);if(i===Xt.SHADING)X.singularValueDecompose2dScale(Ze(e),r);else if(this.matrix){X.singularValueDecompose2dScale(this.matrix,r);const[l,c]=r;X.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=l,r[1]*=c}else X.singularValueDecompose2dScale(t.baseTransform,r);const o=this._createMeshCanvas(r,i===Xt.SHADING?null:this._background,t.cachedCanvases);return i!==Xt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class qN extends _1{getPattern(){return"hotpink"}}function YN(n){switch(n[0]){case"RadialAxial":return new GN(n);case"Mesh":return new XN(n);case"Dummy":return new qN}throw new Error(`Unknown IR type: ${n[0]}`)}const wb={COLORED:1,UNCOLORED:2},xy=class xy{constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e,t){var U,K;const{bbox:s,operatorList:i,paintType:r,tilingType:o,color:l,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:h}=this;u=Math.abs(u),h=Math.abs(h),tv("TilingType: "+o);const d=s[0],f=s[1],m=s[2],S=s[3],x=m-d,C=S-f,y=new Float32Array(2);X.singularValueDecompose2dScale(this.matrix,y);const[w,v]=y;X.singularValueDecompose2dScale(this.baseTransform,y);const E=w*y[0],_=v*y[1];let k=x,T=C,L=!1,R=!1;const N=Math.ceil(u*E),M=Math.ceil(h*_),O=Math.ceil(x*E),V=Math.ceil(C*_);N>=O?k=u:L=!0,M>=V?T=h:R=!0;const H=this.getSizeAndScale(k,this.ctx.canvas.width,E),te=this.getSizeAndScale(T,this.ctx.canvas.height,_),z=e.cachedCanvases.getCanvas("pattern",H.size,te.size),B=z.context,D=c.createCanvasGraphics(B,t);if(D.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(D,r,l),B.translate(-H.scale*d,-te.scale*f),D.transform(0,H.scale,0,0,te.scale,0,0),B.save(),(U=D.dependencyTracker)==null||U.save(),this.clipBbox(D,d,f,m,S),D.baseTransform=Ze(D.ctx),D.executeOperatorList(i),D.endDrawing(),(K=D.dependencyTracker)==null||K.restore(),B.restore(),L||R){const le=z.canvas;L&&(k=u),R&&(T=h);const Z=this.getSizeAndScale(k,this.ctx.canvas.width,E),se=this.getSizeAndScale(T,this.ctx.canvas.height,_),_e=Z.size,J=se.size,ie=e.cachedCanvases.getCanvas("pattern-workaround",_e,J),ye=ie.context,Os=L?Math.floor(x/u):0,Bs=R?Math.floor(C/h):0;for(let dn=0;dn<=Os;dn++)for(let Ee=0;Ee<=Bs;Ee++)ye.drawImage(le,_e*dn,J*Ee,_e,J,0,0,_e,J);return{canvas:ie.canvas,scaleX:Z.scale,scaleY:se.scale,offsetX:d,offsetY:f}}return{canvas:z.canvas,scaleX:H.scale,scaleY:te.scale,offsetX:d,offsetY:f}}getSizeAndScale(e,t,s){const i=Math.max(xy.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const o=i-t,l=r-s;e.ctx.rect(t,s,o,l),X.axialAlignedBoundingBox([t,s,i,r],Ze(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case wb.COLORED:const{fillStyle:o,strokeStyle:l}=this.ctx;i.fillStyle=r.fillColor=o,i.strokeStyle=r.strokeColor=l;break;case wb.UNCOLORED:i.fillStyle=i.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new mN(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i,r){let o=s;i!==Xt.SHADING&&(o=X.transform(o,t.baseTransform),this.matrix&&(o=X.transform(o,this.matrix)));const l=this.createPatternCanvas(t,r);let c=new DOMMatrix(o);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const u=e.createPattern(l.canvas,"repeat");return u.setTransform(c),u}};F(xy,"MAX_PATTERN_SIZE",3e3);let bw=xy;function KN({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const l=Bt.isLittleEndian?4278190080:255,[c,u]=o?[r,l]:[l,r],h=s>>3,d=s&7,f=n.length;t=new Uint32Array(t.buffer);let m=0;for(let S=0;S<i;S++){for(const C=e+h;e<C;e++){const y=e<f?n[e]:255;t[m++]=y&128?u:c,t[m++]=y&64?u:c,t[m++]=y&32?u:c,t[m++]=y&16?u:c,t[m++]=y&8?u:c,t[m++]=y&4?u:c,t[m++]=y&2?u:c,t[m++]=y&1?u:c}if(d===0)continue;const x=e<f?n[e++]:255;for(let C=0;C<d;C++)t[m++]=x&1<<7-C?u:c}return{srcPos:e,destPos:m}}const xb=16,Sb=100,QN=15,bb=10,Dn=16,qv=new DOMMatrix,os=new Float32Array(2),Pc=new Float32Array([1/0,1/0,-1/0,-1/0]);function JN(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,i,r,o,l){e.transform(t,s,i,r,o,l),this.__originalTransform(t,s,i,r,o,l)},n.setTransform=function(t,s,i,r,o,l){e.setTransform(t,s,i,r,o,l),this.__originalSetTransform(t,s,i,r,o,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,o,l){e.bezierCurveTo(t,s,i,r,o,l),this.__originalBezierCurveTo(t,s,i,r,o,l)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class ZN{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Ng(n,e,t,s,i,r,o,l,c,u){const[h,d,f,m,S,x]=Ze(n);if(d===0&&f===0){const w=o*h+S,v=Math.round(w),E=l*m+x,_=Math.round(E),k=(o+c)*h+S,T=Math.abs(Math.round(k)-v)||1,L=(l+u)*m+x,R=Math.abs(Math.round(L)-_)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(m),v,_),n.drawImage(e,t,s,i,r,0,0,T,R),n.setTransform(h,d,f,m,S,x),[T,R]}if(h===0&&m===0){const w=l*f+S,v=Math.round(w),E=o*d+x,_=Math.round(E),k=(l+u)*f+S,T=Math.abs(Math.round(k)-v)||1,L=(o+c)*d+x,R=Math.abs(Math.round(L)-_)||1;return n.setTransform(0,Math.sign(d),Math.sign(f),0,v,_),n.drawImage(e,t,s,i,r,0,0,R,T),n.setTransform(h,d,f,m,S,x),[R,T]}n.drawImage(e,t,s,i,r,o,l,c,u);const C=Math.hypot(h,d),y=Math.hypot(f,m);return[C*c,y*u]}class Ab{constructor(e,t,s){F(this,"alphaIsShape",!1);F(this,"fontSize",0);F(this,"fontSizeScale",1);F(this,"textMatrix",null);F(this,"textMatrixScale",1);F(this,"fontMatrix",q0);F(this,"leading",0);F(this,"x",0);F(this,"y",0);F(this,"lineX",0);F(this,"lineY",0);F(this,"charSpacing",0);F(this,"wordSpacing",0);F(this,"textHScale",1);F(this,"textRenderingMode",zt.FILL);F(this,"textRise",0);F(this,"fillColor","#000000");F(this,"strokeColor","#000000");F(this,"patternFill",!1);F(this,"patternStroke",!1);F(this,"fillAlpha",1);F(this,"strokeAlpha",1);F(this,"lineWidth",1);F(this,"activeSMask",null);F(this,"transferMaps","none");s==null||s(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Pc.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Xt.FILL,t=null){const s=this.minMax.slice();if(e===Xt.STROKE){t||ze("Stroke bounding box must include transform."),X.singularValueDecompose2dScale(t,os);const i=os[0]*this.lineWidth/2,r=os[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=X.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Pc,0)}getClippedPathBoundingBox(e=Xt.FILL,t=null){return X.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Eb(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%Dn,r=(t-i)/Dn,o=i===0?r:r+1,l=n.createImageData(s,Dn);let c=0,u;const h=e.data,d=l.data;let f,m,S,x;if(e.kind===Nd.GRAYSCALE_1BPP){const C=h.byteLength,y=new Uint32Array(d.buffer,0,d.byteLength>>2),w=y.length,v=s+7>>3,E=4294967295,_=Bt.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(S=f<r?Dn:i,u=0,m=0;m<S;m++){const k=C-c;let T=0;const L=k>v?s:k*8-7,R=L&-8;let N=0,M=0;for(;T<R;T+=8)M=h[c++],y[u++]=M&128?E:_,y[u++]=M&64?E:_,y[u++]=M&32?E:_,y[u++]=M&16?E:_,y[u++]=M&8?E:_,y[u++]=M&4?E:_,y[u++]=M&2?E:_,y[u++]=M&1?E:_;for(;T<L;T++)N===0&&(M=h[c++],N=128),y[u++]=M&N?E:_,N>>=1}for(;u<w;)y[u++]=0;n.putImageData(l,0,f*Dn)}}else if(e.kind===Nd.RGBA_32BPP){for(m=0,x=s*Dn*4,f=0;f<r;f++)d.set(h.subarray(c,c+x)),c+=x,n.putImageData(l,0,m),m+=Dn;f<o&&(x=s*i*4,d.set(h.subarray(c,c+x)),n.putImageData(l,0,m))}else if(e.kind===Nd.RGB_24BPP)for(S=Dn,x=s*S,f=0;f<o;f++){for(f>=r&&(S=i,x=s*S),u=0,m=x;m--;)d[u++]=h[c++],d[u++]=h[c++],d[u++]=h[c++],d[u++]=255;n.putImageData(l,0,f*Dn)}else throw new Error(`bad image kind: ${e.kind}`)}function Cb(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%Dn,r=(t-i)/Dn,o=i===0?r:r+1,l=n.createImageData(s,Dn);let c=0;const u=e.data,h=l.data;for(let d=0;d<o;d++){const f=d<r?Dn:i;({srcPos:c}=KN({src:u,srcPos:c,dest:h,width:s,height:f,nonBlackColor:0})),n.putImageData(l,0,d*Dn)}}function Gh(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Rg(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function _b(n,e){if(e)return!0;X.singularValueDecompose2dScale(n,os);const t=Math.fround(li.pixelRatio*Hr.PDF_TO_CSS_UNITS);return os[0]<=t&&os[1]<=t}const eR=["butt","round","square"],tR=["miter","round","bevel"],nR={},kb={};var ci,Aw,Ew,Cw;const O1=class O1{constructor(e,t,s,i,r,{optionalContentConfig:o,markedContentStack:l=null},c,u,h){b(this,ci);this.ctx=e,this.current=new Ab(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=o,this.cachedCanvases=new ZN(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=h??null}getObject(e,t,s=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=l,s){const c=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Ze(this.compositeCtx))}this.ctx.save(),Rg(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ze(this.ctx)}executeOperatorList(e,t,s,i,r){var y;const o=e.argsArray,l=e.fnArray;let c=t||0;const u=o.length;if(u===c)return c;const h=u-c>bb&&typeof s=="function",d=h?Date.now()+QN:0;let f=0;const m=this.commonObjs,S=this.objs;let x,C;for(;;){if(i!==void 0&&c===i.nextBreakPoint)return i.breakIt(c,s),c;if(!r||r(c))if(x=l[c],C=o[c]??null,x!==Eh.dependency)C===null?this[x](c):this[x](c,...C);else for(const w of C){(y=this.dependencyTracker)==null||y.recordNamedData(w,c);const v=w.startsWith("g_")?m:S;if(!v.has(w))return v.get(w,s),c}if(c++,c===u)return c;if(h&&++f>bb){if(Date.now()>d)return s(),c;f=0}}}endDrawing(){A(this,ci,Aw).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),A(this,ci,Ew).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),l=s,c=i,u="prescale1",h,d;for(;r>2&&l>1||o>2&&c>1;){let f=l,m=c;r>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),r/=l/f),o>2&&c>1&&(m=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/m),h=this.cachedCanvases.getCanvas(u,f,m),d=h.context,d.clearRect(0,0,f,m),d.drawImage(e,0,0,l,c,0,0,f,m),e=h.canvas,l=f,c=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e,t){var N,M;const s=this.ctx,{width:i,height:r}=t,o=this.current.fillColor,l=this.current.patternFill,c=Ze(s);let u,h,d,f;if((t.bitmap||t.data)&&t.count>1){const O=t.bitmap||t.data.buffer;h=JSON.stringify(l?c:[c.slice(0,4),o]),u=this._cachedBitmapsMap.get(O),u||(u=new Map,this._cachedBitmapsMap.set(O,u));const V=u.get(h);if(V&&!l){const H=Math.round(Math.min(c[0],c[2])+c[4]),te=Math.round(Math.min(c[1],c[3])+c[5]);return(N=this.dependencyTracker)==null||N.recordDependencies(e,ms.transformAndFill),{canvas:V,offsetX:H,offsetY:te}}d=V}d||(f=this.cachedCanvases.getCanvas("maskCanvas",i,r),Cb(f.context,t));let m=X.transform(c,[1/i,0,0,-1/r,0,0]);m=X.transform(m,[1,0,0,1,0,-r]);const S=Pc.slice();X.axialAlignedBoundingBox([0,0,i,r],m,S);const[x,C,y,w]=S,v=Math.round(y-x)||1,E=Math.round(w-C)||1,_=this.cachedCanvases.getCanvas("fillCanvas",v,E),k=_.context,T=x,L=C;k.translate(-T,-L),k.transform(...m),d||(d=this._scaleImage(f.canvas,hi(k)),d=d.img,u&&l&&u.set(h,d)),k.imageSmoothingEnabled=_b(Ze(k),t.interpolate),Ng(k,d,0,0,d.width,d.height,0,0,i,r),k.globalCompositeOperation="source-in";const R=X.transform(hi(k),[1,0,0,1,-T,-L]);return k.fillStyle=l?o.getPattern(s,this,R,Xt.FILL,e):o,k.fillRect(0,0,i,r),u&&!l&&(this.cachedCanvases.delete("fillCanvas"),u.set(h,_.canvas)),(M=this.dependencyTracker)==null||M.recordDependencies(e,ms.transformAndFill),{canvas:_.canvas,offsetX:Math.round(T),offsetY:Math.round(L)}}setLineWidth(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineCap",e),this.ctx.lineCap=eR[t]}setLineJoin(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineJoin",e),this.ctx.lineJoin=tR[t]}setMiterLimit(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var s,i,r,o,l;for(const[c,u]of t)switch(c){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(s=this.dependencyTracker)==null||s.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(r=this.dependencyTracker)==null||r.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(o=this.dependencyTracker)==null||o.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(l=this.dependencyTracker)==null||l.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,s);this.suspendedCtx=this.ctx;const o=this.ctx=r.context;o.setTransform(this.suspendedCtx.getTransform()),Gh(this.suspendedCtx,o),JN(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Gh(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],o=i[1],l=i[2]-r,c=i[3]-o;l===0||c===0||(this.genericComposeSMask(t.context,s,l,c,t.subtype,t.backdrop,t.transferMap,r,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,o,l,c,u,h,d){let f=e.canvas,m=c-h,S=u-d;if(o)if(m<0||S<0||m+s>f.width||S+i>f.height){const C=this.cachedCanvases.getCanvas("maskExtension",s,i),y=C.context;y.drawImage(f,-m,-S),y.globalCompositeOperation="destination-atop",y.fillStyle=o,y.fillRect(0,0,s,i),y.globalCompositeOperation="source-over",f=C.canvas,m=S=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(m,S,s,i),e.clip(C),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(m,S,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&l?t.filter=this.filterFactory.addAlphaFilter(l):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(l));const x=new Path2D;x.rect(c,u,s,i),t.clip(x),t.globalCompositeOperation="destination-in",t.drawImage(f,m,S,s,i,c,u,s,i),t.restore()}save(e){var s;this.inSMaskMode&&Gh(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(s=this.dependencyTracker)==null||s.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Gh(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,r,o,l){var c;(c=this.dependencyTracker)==null||c.recordIncrementalData("transform",e),this.ctx.transform(t,s,i,r,o,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,i){let[r]=s;if(!i){r||(r=s[0]=new Path2D),this[t](e,r);return}if(this.dependencyTracker!==null){const o=t===Eh.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-o,i[2]+o,i[1]-o,i[3]+o).recordDependencies(e,["transform"])}if(!(r instanceof Path2D)){const o=s[0]=new Path2D;for(let l=0,c=r.length;l<c;)switch(r[l++]){case Cg.moveTo:o.moveTo(r[l++],r[l++]);break;case Cg.lineTo:o.lineTo(r[l++],r[l++]);break;case Cg.curveTo:o.bezierCurveTo(r[l++],r[l++],r[l++],r[l++],r[l++],r[l++]);break;case Cg.closePath:o.closePath();break;default:ae(`Unrecognized drawing path operator: ${r[l-1]}`);break}r=o}X.axialAlignedBoundingBox(i,Ze(this.ctx),this.current.minMax),this[t](e,r),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){var o;const i=this.ctx,r=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const l=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=r.getPattern(i,this,hi(i),Xt.STROKE,e),l){const c=new Path2D;c.addPath(t,i.getTransform().invertSelf().multiplySelf(l)),t=c}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(o=this.dependencyTracker)==null||o.recordDependencies(e,ms.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Xt.STROKE,Ze(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){var u,h,d;const i=this.ctx,r=this.current.fillColor,o=this.current.patternFill;let l=!1;if(o){const f=r.isModifyingCurrentTransform()?i.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),i.save(),i.fillStyle=r.getPattern(i,this,hi(i),Xt.FILL,e),f){const m=new Path2D;m.addPath(t,i.getTransform().invertSelf().multiplySelf(f)),t=m}l=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(h=this.dependencyTracker)==null||h.recordDependencies(e,ms.fill),l&&(i.restore(),(d=this.dependencyTracker)==null||d.restore(e)),s&&this.consumePath(e,t,c)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var s;this.ctx.fill(t),(s=this.dependencyTracker)==null||s.recordDependencies(e,ms.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=nR}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=kb}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,r=s.getTransform().invertSelf();for(const{transform:o,x:l,y:c,fontSize:u,path:h}of t)h&&i.addPath(h,new DOMMatrix(o).preMultiplySelf(r).translate(l,c).scale(u,-u));s.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){var d,f;(d=this.dependencyTracker)==null||d.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),r=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=i.fontMatrix||q0,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&ae("Invalid font matrix for font "+t),s<0?(s=-s,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=s,i.isType3Font)return;const o=i.loadedName||"sans-serif",l=((f=i.systemFontInfo)==null?void 0:f.css)||`"${o}", ${i.fallbackName}`;let c="normal";i.black?c="900":i.bold&&(c="bold");const u=i.italic?"italic":"normal";let h=s;s<xb?h=xb:s>Sb&&(h=Sb),this.current.fontSizeScale=s/h,this.ctx.font=`${u} ${c} ${h}px ${l}`}setTextRenderingMode(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,s,i,r,o){var y,w,v,E;const l=this.ctx,c=this.current,u=c.font,h=c.textRenderingMode,d=c.fontSize/c.fontSizeScale,f=h&zt.FILL_STROKE_MASK,m=!!(h&zt.ADD_TO_PATH_FLAG),S=c.patternFill&&!u.missingFile,x=c.patternStroke&&!u.missingFile;let C;if((u.disableFontFace||m||S||x)&&!u.missingFile&&(C=u.getPathGenerator(this.commonObjs,t)),C&&(u.disableFontFace||S||x)){l.save(),l.translate(s,i),l.scale(d,-d),(y=this.dependencyTracker)==null||y.recordCharacterBBox(e,l,u);let _;if(f===zt.FILL||f===zt.FILL_STROKE)if(r){_=l.getTransform(),l.setTransform(...r);const k=A(this,ci,Cw).call(this,C,_,r);l.fill(k)}else l.fill(C);if(f===zt.STROKE||f===zt.FILL_STROKE)if(o){_||(_=l.getTransform()),l.setTransform(...o);const{a:k,b:T,c:L,d:R}=_,N=X.inverseTransform(o),M=X.transform([k,T,L,R,0,0],N);X.singularValueDecompose2dScale(M,os),l.lineWidth*=Math.max(os[0],os[1])/d,l.stroke(A(this,ci,Cw).call(this,C,_,o))}else l.lineWidth/=d,l.stroke(C);l.restore()}else(f===zt.FILL||f===zt.FILL_STROKE)&&(l.fillText(t,s,i),(w=this.dependencyTracker)==null||w.recordCharacterBBox(e,l,u,d,s,i,()=>l.measureText(t))),(f===zt.STROKE||f===zt.FILL_STROKE)&&(this.dependencyTracker&&((v=this.dependencyTracker)==null||v.recordCharacterBBox(e,l,u,d,s,i,()=>l.measureText(t)).recordDependencies(e,ms.stroke)),l.strokeText(t,s,i));m&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ze(l),x:s,y:i,fontSize:d,path:C}),(E=this.dependencyTracker)==null||E.recordCharacterBBox(e,l,u,d,s,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return he(this,"isFontSubpixelAAEnabled",s)}showText(e,t){var L,R,N,M;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,ms.showText).resetBBox(e),this.current.textRenderingMode&zt.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,i=s.font;if(i.isType3Font){this.showType3Text(e,t),(L=this.dependencyTracker)==null||L.recordShowTextOperation(e);return}const r=s.fontSize;if(r===0){(R=this.dependencyTracker)==null||R.recordOperation(e);return}const o=this.ctx,l=s.fontSizeScale,c=s.charSpacing,u=s.wordSpacing,h=s.fontDirection,d=s.textHScale*h,f=t.length,m=i.vertical,S=m?1:-1,x=i.defaultVMetrics,C=r*s.fontMatrix[0],y=s.textRenderingMode===zt.FILL&&!i.disableFontFace&&!s.patternFill;o.save(),s.textMatrix&&o.transform(...s.textMatrix),o.translate(s.x,s.y+s.textRise),h>0?o.scale(d,-1):o.scale(d,1);let w,v;if(s.patternFill){o.save();const O=s.fillColor.getPattern(o,this,hi(o),Xt.FILL,e);w=Ze(o),o.restore(),o.fillStyle=O}if(s.patternStroke){o.save();const O=s.strokeColor.getPattern(o,this,hi(o),Xt.STROKE,e);v=Ze(o),o.restore(),o.strokeStyle=O}let E=s.lineWidth;const _=s.textMatrixScale;if(_===0||E===0){const O=s.textRenderingMode&zt.FILL_STROKE_MASK;(O===zt.STROKE||O===zt.FILL_STROKE)&&(E=this.getSinglePixelWidth())}else E/=_;if(l!==1&&(o.scale(l,l),E/=l),o.lineWidth=E,i.isInvalidPDFjsFont){const O=[];let V=0;for(const te of t)O.push(te.unicode),V+=te.width;const H=O.join("");if(o.fillText(H,0,0),this.dependencyTracker!==null){const te=o.measureText(H);this.dependencyTracker.recordBBox(e,this.ctx,-te.actualBoundingBoxLeft,te.actualBoundingBoxRight,-te.actualBoundingBoxAscent,te.actualBoundingBoxDescent).recordShowTextOperation(e)}s.x+=V*C*d,o.restore(),this.compose();return}let k=0,T;for(T=0;T<f;++T){const O=t[T];if(typeof O=="number"){k+=S*O*r/1e3;continue}let V=!1;const H=(O.isSpace?u:0)+c,te=O.fontChar,z=O.accent;let B,D,U=O.width;if(m){const Z=O.vmetric||x,se=-(O.vmetric?Z[1]:U*.5)*C,_e=Z[2]*C;U=Z?-Z[0]:U,B=se/l,D=(k+_e)/l}else B=k/l,D=0;let K;if(i.remeasure&&U>0){K=o.measureText(te);const Z=K.width*1e3/r*l;if(U<Z&&this.isFontSubpixelAAEnabled){const se=U/Z;V=!0,o.save(),o.scale(se,1),B/=se}else U!==Z&&(B+=(U-Z)/2e3*r/l)}if(this.contentVisible&&(O.isInFont||i.missingFile)){if(y&&!z)o.fillText(te,B,D),(N=this.dependencyTracker)==null||N.recordCharacterBBox(e,o,K?{bbox:null}:i,r/l,B,D,()=>K??o.measureText(te));else if(this.paintChar(e,te,B,D,w,v),z){const Z=B+r*z.offset.x/l,se=D-r*z.offset.y/l;this.paintChar(e,z.fontChar,Z,se,w,v)}}const le=m?U*C-H*h:U*C+H*h;k+=le,V&&o.restore()}m?s.y-=k:s.x+=k*d,o.restore(),this.compose(),(M=this.dependencyTracker)==null||M.recordShowTextOperation(e)}showType3Text(e,t){const s=this.ctx,i=this.current,r=i.font,o=i.fontSize,l=i.fontDirection,c=r.vertical?1:-1,u=i.charSpacing,h=i.wordSpacing,d=i.textHScale*l,f=i.fontMatrix||q0,m=t.length,S=i.textRenderingMode===zt.INVISIBLE;let x,C,y,w;if(S||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),i.textMatrix&&s.transform(...i.textMatrix),s.translate(i.x,i.y+i.textRise),s.scale(d,l);const v=this.dependencyTracker;for(this.dependencyTracker=v?new sy(v,e):null,x=0;x<m;++x){if(C=t[x],typeof C=="number"){w=c*C*o/1e3,this.ctx.translate(w,0),i.x+=w*d;continue}const E=(C.isSpace?h:0)+u,_=r.charProcOperatorList[C.operatorListId];_?this.contentVisible&&(this.save(),s.scale(o,o),s.transform(...f),this.executeOperatorList(_),this.restore()):ae(`Type3 character "${C.operatorListId}" is not available.`);const k=[C.width,0];X.applyTransform(k,f),y=k[0]*o+E,s.translate(y,0),i.x+=y*d}s.restore(),v&&(this.dependencyTracker=v)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,i,r,o,l){var u;const c=new Path2D;c.rect(i,r,o-i,l-r),this.ctx.clip(c),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,i,o,r,l).recordClipBox(e,this.ctx,i,o,r,l),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const i=this.baseTransform||Ze(this.ctx),r={createCanvasGraphics:(o,l)=>new O1(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new sy(this.dependencyTracker,l,!0):null)};s=new bw(t,this.ctx,r,i)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=YN(this.getObject(e,t)),this.cachedPatterns.set(t,i)),s&&(i.matrix=s),i}shadingFill(e,t){var o;if(!this.contentVisible)return;const s=this.ctx;this.save(e);const i=this._getPattern(e,t);s.fillStyle=i.getPattern(s,this,hi(s),Xt.SHADING,e);const r=hi(s);if(r){const{width:l,height:c}=s.canvas,u=Pc.slice();X.axialAlignedBoundingBox([0,0,l,c],r,u);const[h,d,f,m]=u;this.ctx.fillRect(h,d,f-h,m-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(o=this.dependencyTracker)==null||o.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,ms.transform).recordDependencies(e,ms.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){ze("Should not call beginInlineImage")}beginImageData(){ze("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Ze(this.ctx),s)){X.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,o,l,c]=s,u=new Path2D;u.rect(r,o,l-r,c-o),this.ctx.clip(u),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,r,l,o,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var v;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||tv("TODO: Support non-isolated groups."),t.knockout&&ae("Knockout groups not supported.");const i=Ze(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=Pc.slice();X.axialAlignedBoundingBox(t.bbox,Ze(s),r);const o=[0,0,s.canvas.width,s.canvas.height];r=X.intersect(r,o)||[0,0,0,0];const l=Math.floor(r[0]),c=Math.floor(r[1]),u=Math.max(Math.ceil(r[2])-l,1),h=Math.max(Math.ceil(r[3])-c,1);this.current.startNewPathAndClipBox([0,0,u,h]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(d,u,h),m=f.context;m.translate(-l,-c),m.transform(...i);let S=new Path2D;const[x,C,y,w]=t.bbox;if(S.rect(x,C,y-x,w-C),t.matrix){const E=new Path2D;E.addPath(S,new DOMMatrix(t.matrix)),S=E}m.clip(S),t.smask&&this.smaskStack.push({canvas:f.canvas,context:m,offsetX:l,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(l,c),s.save()),Gh(s,m),this.ctx=m,(v=this.dependencyTracker)==null||v.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){var r;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(r=this.dependencyTracker)==null||r.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=Ze(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const l=Pc.slice();X.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],o,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,s,i,r,o){if(A(this,ci,Aw).call(this),Rg(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const l=s[2]-s[0],c=s[3]-s[1];if(o&&this.annotationCanvasMap){i=i.slice(),i[4]-=s[0],i[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=l,s[3]=c,X.singularValueDecompose2dScale(Ze(this.ctx),os);const{viewportScale:u}=this,h=Math.ceil(l*this.outputScaleX*u),d=Math.ceil(c*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,d);const{canvas:f,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(os[0],0,0,-os[1],0,c*os[1]),Rg(this.ctx)}else{Rg(this.ctx),this.endPath(e);const u=new Path2D;u.rect(s[0],s[1],l,c),this.ctx.clip(u)}}this.current=new Ab(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...r)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),A(this,ci,Ew).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var l;if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const i=this.ctx,r=this._createMaskCanvas(e,t),o=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,r.offsetX,r.offsetY),(l=this.dependencyTracker)==null||l.resetBBox(e).recordBBox(e,this.ctx,r.offsetX,r.offsetX+o.width,r.offsetY,r.offsetY+o.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,i=0,r=0,o,l){var d,f,m;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const c=this.ctx;c.save();const u=Ze(c);c.transform(s,i,r,o,0,0);const h=this._createMaskCanvas(e,t);c.setTransform(1,0,0,1,h.offsetX-u[4],h.offsetY-u[5]),(d=this.dependencyTracker)==null||d.resetBBox(e);for(let S=0,x=l.length;S<x;S+=2){const C=X.transform(u,[s,i,r,o,l[S],l[S+1]]);c.drawImage(h.canvas,C[4],C[5]),(f=this.dependencyTracker)==null||f.recordBBox(e,this.ctx,C[4],C[4]+h.canvas.width,C[5],C[5]+h.canvas.height)}c.restore(),this.compose(),(m=this.dependencyTracker)==null||m.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var o,l,c;if(!this.contentVisible)return;const s=this.ctx,i=this.current.fillColor,r=this.current.patternFill;(o=this.dependencyTracker)==null||o.resetBBox(e).recordDependencies(e,ms.transformAndFill);for(const u of t){const{data:h,width:d,height:f,transform:m}=u,S=this.cachedCanvases.getCanvas("maskCanvas",d,f),x=S.context;x.save();const C=this.getObject(e,h,u);Cb(x,C),x.globalCompositeOperation="source-in",x.fillStyle=r?i.getPattern(x,this,hi(s),Xt.FILL,e):i,x.fillRect(0,0,d,f),x.restore(),s.save(),s.transform(...m),s.scale(1,-1),Ng(s,S.canvas,0,0,d,f,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(e,s,0,d,0,f),s.restore()}this.compose(),(c=this.dependencyTracker)==null||c.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){ae("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,i,r){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){ae("Dependent image isn't ready yet");return}const l=o.width,c=o.height,u=[];for(let h=0,d=r.length;h<d;h+=2)u.push({transform:[s,0,0,i,r[h],r[h+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(e,o,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",r.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const s=t.width,i=t.height,r=this.ctx;this.save(e);const{filter:o}=r;o!=="none"&&o!==""&&(r.filter="none"),r.scale(1/s,-1/i);let l;if(t.bitmap)l=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)l=t;else{const d=this.cachedCanvases.getCanvas("inlineImage",s,i).context;Eb(d,t),l=this.applyTransferMapsToCanvas(d)}const c=this._scaleImage(l,hi(r));r.imageSmoothingEnabled=_b(Ze(r),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,r,0,s,-i,0).recordDependencies(e,ms.imageXObject).recordOperation(e),Ng(r,c.img,0,0,c.paintWidth,c.paintHeight,0,-i,s,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){var o,l,c;if(!this.contentVisible)return;const i=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const u=t.width,h=t.height,f=this.cachedCanvases.getCanvas("inlineImage",u,h).context;Eb(f,t),r=this.applyTransferMapsToCanvas(f)}(o=this.dependencyTracker)==null||o.resetBBox(e);for(const u of s)i.save(),i.transform(...u.transform),i.scale(1,-1),Ng(i,r,u.x,u.y,u.w,u.h,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(e,i,0,1,-1,0),i.restore();(c=this.dependencyTracker)==null||c.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,ms.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){var o,l;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const r=this.ctx;this.pendingClip?(i||(this.pendingClip===kb?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null,(o=this.dependencyTracker)==null||o.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(l=this.dependencyTracker)==null||l.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ze(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let o,l;if(s===0&&i===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)o=l=1/c;else{const h=c*e;o=l=h<1?1/h:1}else if(e===0)o=1/c,l=1/u;else{const h=c*e,d=u*e;o=h<1?1/h:1,l=d<1?1/d:1}}else{const c=Math.abs(t*r-s*i),u=Math.hypot(t,s),h=Math.hypot(i,r);if(e===0)o=h/c,l=u/c;else{const d=e*c;o=h>d?h/d:1,l=u>d?u/d:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[r,o]=this.getScaleForStroking();if(r===o){s.lineWidth=(i||1)*r,s.stroke(e);return}const l=s.getLineDash();t&&s.save(),s.scale(r,o),qv.a=1/r,qv.d=1/o;const c=new Path2D;if(c.addPath(e,qv),l.length>0){const u=Math.max(r,o);s.setLineDash(l.map(h=>h/u)),s.lineDashOffset/=u}s.lineWidth=i||1,s.stroke(c),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};ci=new WeakSet,Aw=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Ew=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Cw=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let Uc=O1;for(const n in Eh)Uc.prototype[n]!==void 0&&(Uc.prototype[Eh[n]]=Uc.prototype[n]);var yu,vu,Bf,wu,nm;const Nc=class Nc{constructor(e){b(this,wu);b(this,yu);b(this,vu);b(this,Bf);g(this,yu,e),g(this,vu,new DataView(a(this,yu))),g(this,Bf,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const u of Nc.strings){const h=t.encode(e[u]);s[u]=h,i+=4+h.length}const r=new ArrayBuffer(i),o=new Uint8Array(r),l=new DataView(r);let c=0;for(const u of Nc.strings){const h=s[u],d=h.length;l.setUint32(c,d),o.set(h,c+4),c+=4+d}return we(c===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}get fontFamily(){return A(this,wu,nm).call(this,0)}get fontWeight(){return A(this,wu,nm).call(this,1)}get italicAngle(){return A(this,wu,nm).call(this,2)}};yu=new WeakMap,vu=new WeakMap,Bf=new WeakMap,wu=new WeakSet,nm=function(e){we(e<Nc.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=a(this,vu).getUint32(t)+4;const s=a(this,vu).getUint32(t);return a(this,Bf).decode(new Uint8Array(a(this,yu),t+4,s))},F(Nc,"strings",["fontFamily","fontWeight","italicAngle"]);let iy=Nc;var Eo,_i,rl,ol,dd;const Rc=class Rc{constructor(e){b(this,ol);b(this,Eo);b(this,_i);b(this,rl);g(this,Eo,e),g(this,_i,new DataView(a(this,Eo))),g(this,rl,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const f of Rc.strings){const m=t.encode(e[f]);s[f]=m,i+=4+m.length}i+=4;let r,o,l=1+i;e.style&&(r=t.encode(e.style.style),o=t.encode(e.style.weight),l+=4+r.length+4+o.length);const c=new ArrayBuffer(l),u=new Uint8Array(c),h=new DataView(c);let d=0;h.setUint8(d++,e.guessFallback?1:0),h.setUint32(d,0),d+=4,i=0;for(const f of Rc.strings){const m=s[f],S=m.length;i+=4+S,h.setUint32(d,S),u.set(m,d+4),d+=4+S}return h.setUint32(d-i-4,i),e.style&&(h.setUint32(d,r.length),u.set(r,d+4),d+=4+r.length,h.setUint32(d,o.length),u.set(o,d+4),d+=4+o.length),we(d<=c.byteLength,"SubstitionInfo.write: Buffer overflow"),c.transferToFixedLength(d)}get guessFallback(){return a(this,_i).getUint8(0)!==0}get css(){return A(this,ol,dd).call(this,0)}get loadedName(){return A(this,ol,dd).call(this,1)}get baseFontName(){return A(this,ol,dd).call(this,2)}get src(){return A(this,ol,dd).call(this,3)}get style(){let e=1;e+=4+a(this,_i).getUint32(e);const t=a(this,_i).getUint32(e),s=a(this,rl).decode(new Uint8Array(a(this,Eo),e+4,t));e+=4+t;const i=a(this,_i).getUint32(e),r=a(this,rl).decode(new Uint8Array(a(this,Eo),e+4,i));return{style:s,weight:r}}};Eo=new WeakMap,_i=new WeakMap,rl=new WeakMap,ol=new WeakSet,dd=function(e){we(e<Rc.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=a(this,_i).getUint32(t)+4;const s=a(this,_i).getUint32(t);return a(this,rl).decode(new Uint8Array(a(this,Eo),t+4,s))},F(Rc,"strings",["css","loadedName","baseFontName","src"]);let ry=Rc;var xu,Su,bu,Au,Vn,ki,zf,Me,dt,Us,sm,fd;const ue=class ue{constructor({data:e,extra:t}){b(this,dt);b(this,ki);b(this,zf);b(this,Me);g(this,ki,e),g(this,zf,new TextDecoder),g(this,Me,new DataView(a(this,ki))),t&&Object.assign(this,t)}get black(){return A(this,dt,Us).call(this,0)}get bold(){return A(this,dt,Us).call(this,1)}get disableFontFace(){return A(this,dt,Us).call(this,2)}get fontExtraProperties(){return A(this,dt,Us).call(this,3)}get isInvalidPDFjsFont(){return A(this,dt,Us).call(this,4)}get isType3Font(){return A(this,dt,Us).call(this,5)}get italic(){return A(this,dt,Us).call(this,6)}get missingFile(){return A(this,dt,Us).call(this,7)}get remeasure(){return A(this,dt,Us).call(this,8)}get vertical(){return A(this,dt,Us).call(this,9)}get ascent(){return A(this,dt,sm).call(this,0)}get defaultWidth(){return A(this,dt,sm).call(this,1)}get descent(){return A(this,dt,sm).call(this,2)}get bbox(){let e=a(ue,Su);if(a(this,Me).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<4;i++)s.push(a(this,Me).getInt16(e,!0)),e+=2;return s}get fontMatrix(){let e=a(ue,bu);if(a(this,Me).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<6;i++)s.push(a(this,Me).getFloat64(e,!0)),e+=8;return s}get defaultVMetrics(){let e=a(ue,Au);if(a(this,Me).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<3;i++)s.push(a(this,Me).getInt16(e,!0)),e+=2;return s}get fallbackName(){return A(this,dt,fd).call(this,0)}get loadedName(){return A(this,dt,fd).call(this,1)}get mimetype(){return A(this,dt,fd).call(this,2)}get name(){return A(this,dt,fd).call(this,3)}get data(){let e=a(ue,Vn);const t=a(this,Me).getUint32(e);e+=4+t;const s=a(this,Me).getUint32(e);e+=4+s;const i=a(this,Me).getUint32(e);e+=4+i;const r=a(this,Me).getUint32(e);if(r!==0)return new Uint8Array(a(this,ki),e+4,r)}clearData(){let e=a(ue,Vn);const t=a(this,Me).getUint32(e);e+=4+t;const s=a(this,Me).getUint32(e);e+=4+s;const i=a(this,Me).getUint32(e);e+=4+i;const r=a(this,Me).getUint32(e);new Uint8Array(a(this,ki),e+4,r).fill(0),a(this,Me).setUint32(e,0)}get cssFontInfo(){let e=a(ue,Vn);const t=a(this,Me).getUint32(e);e+=4+t;const s=a(this,Me).getUint32(e);e+=4+s;const i=a(this,Me).getUint32(e);if(i===0)return null;const r=new Uint8Array(i);return r.set(new Uint8Array(a(this,ki),e+4,i)),new iy(r.buffer)}get systemFontInfo(){let e=a(ue,Vn);const t=a(this,Me).getUint32(e);e+=4+t;const s=a(this,Me).getUint32(e);if(s===0)return null;const i=new Uint8Array(s);return i.set(new Uint8Array(a(this,ki),e+4,s)),new ry(i.buffer)}static write(e){const t=e.systemFontInfo?ry.write(e.systemFontInfo):null,s=e.cssFontInfo?iy.write(e.cssFontInfo):null,i=new TextEncoder,r={};let o=0;for(const x of ue.strings)r[x]=i.encode(e[x]),o+=4+r[x].length;const l=a(ue,Vn)+4+o+4+(t?t.byteLength:0)+4+(s?s.byteLength:0)+4+(e.data?e.data.length:0),c=new ArrayBuffer(l),u=new Uint8Array(c),h=new DataView(c);let d=0;const f=ue.bools.length;let m=0,S=0;for(let x=0;x<f;x++){const C=e[ue.bools[x]];m|=(C===void 0?0:C?2:1)<<S,S+=2,(S===8||x===f-1)&&(h.setUint8(d++,m),m=0,S=0)}we(d===a(ue,xu),"FontInfo.write: Boolean properties offset mismatch");for(const x of ue.numbers)h.setFloat64(d,e[x]),d+=8;if(we(d===a(ue,Su),"FontInfo.write: Number properties offset mismatch"),e.bbox){h.setUint8(d++,4);for(const x of e.bbox)h.setInt16(d,x,!0),d+=2}else h.setUint8(d++,0),d+=2*4;if(we(d===a(ue,bu),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){h.setUint8(d++,6);for(const x of e.fontMatrix)h.setFloat64(d,x,!0),d+=8}else h.setUint8(d++,0),d+=8*6;if(we(d===a(ue,Au),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){h.setUint8(d++,1);for(const x of e.defaultVMetrics)h.setInt16(d,x,!0),d+=2}else h.setUint8(d++,0),d+=3*2;we(d===a(ue,Vn),"FontInfo.write: DefaultVMetrics properties offset mismatch"),h.setUint32(a(ue,Vn),0),d+=4;for(const x of ue.strings){const C=r[x],y=C.length;h.setUint32(d,y),u.set(C,d+4),d+=4+y}if(h.setUint32(a(ue,Vn),d-a(ue,Vn)-4),!t)h.setUint32(d,0),d+=4;else{const x=t.byteLength;h.setUint32(d,x),we(d+4+x<=c.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),d+4),d+=4+x}if(!s)h.setUint32(d,0),d+=4;else{const x=s.byteLength;h.setUint32(d,x),we(d+4+x<=c.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(s),d+4),d+=4+x}return e.data===void 0?(h.setUint32(d,0),d+=4):(h.setUint32(d,e.data.length),u.set(e.data,d+4),d+=4+e.data.length),we(d<=c.byteLength,"FontInfo.write: Buffer overflow"),c.transferToFixedLength(d)}};xu=new WeakMap,Su=new WeakMap,bu=new WeakMap,Au=new WeakMap,Vn=new WeakMap,ki=new WeakMap,zf=new WeakMap,Me=new WeakMap,dt=new WeakSet,Us=function(e){we(e<ue.bools.length,"Invalid boolean index");const t=Math.floor(e/4),s=e*2%8,i=a(this,Me).getUint8(t)>>s&3;return i===0?void 0:i===2},sm=function(e){return we(e<ue.numbers.length,"Invalid number index"),a(this,Me).getFloat64(a(ue,xu)+e*8)},fd=function(e){we(e<ue.strings.length,"Invalid string index");let t=a(ue,Vn)+4;for(let r=0;r<e;r++)t+=a(this,Me).getUint32(t)+4;const s=a(this,Me).getUint32(t),i=new Uint8Array(s);return i.set(new Uint8Array(a(this,ki),t+4,s)),a(this,zf).decode(i)},F(ue,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),F(ue,"numbers",["ascent","defaultWidth","descent"]),F(ue,"strings",["fallbackName","loadedName","mimetype","name"]),b(ue,xu,Math.ceil(ue.bools.length*2/8)),b(ue,Su,a(ue,xu)+ue.numbers.length*8),b(ue,bu,a(ue,Su)+1+2*4),b(ue,Au,a(ue,bu)+1+8*6),b(ue,Vn,a(ue,Au)+1+2*3);let _w=ue;var Uf,$f;class Ls{static get workerPort(){return a(this,Uf)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");g(this,Uf,e)}static get workerSrc(){return a(this,$f)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");g(this,$f,e)}}Uf=new WeakMap,$f=new WeakMap,b(Ls,Uf,null),b(Ls,$f,"");var Eu,Hf;class sR{constructor({parsedData:e,rawData:t}){b(this,Eu);b(this,Hf);g(this,Eu,e),g(this,Hf,t)}getRaw(){return a(this,Hf)}get(e){return a(this,Eu).get(e)??null}[Symbol.iterator](){return a(this,Eu).entries()}}Eu=new WeakMap,Hf=new WeakMap;const pc=Symbol("INTERNAL");var Vf,Gf,Wf,Cu;class iR{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){b(this,Vf,!1);b(this,Gf,!1);b(this,Wf,!1);b(this,Cu,!0);g(this,Vf,!!(e&is.DISPLAY)),g(this,Gf,!!(e&is.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(a(this,Wf))return a(this,Cu);if(!a(this,Cu))return!1;const{print:e,view:t}=this.usage;return a(this,Vf)?(t==null?void 0:t.viewState)!=="OFF":a(this,Gf)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==pc&&ze("Internal method `_setVisible` called."),g(this,Wf,s),g(this,Cu,t)}}Vf=new WeakMap,Gf=new WeakMap,Wf=new WeakMap,Cu=new WeakMap;var Co,De,_u,ku,Xf,kw;class rR{constructor(e,t=is.DISPLAY){b(this,Xf);b(this,Co,null);b(this,De,new Map);b(this,_u,null);b(this,ku,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,g(this,ku,e.order);for(const s of e.groups)a(this,De).set(s.id,new iR(t,s));if(e.baseState==="OFF")for(const s of a(this,De).values())s._setVisible(pc,!1);for(const s of e.on)a(this,De).get(s)._setVisible(pc,!0);for(const s of e.off)a(this,De).get(s)._setVisible(pc,!1);g(this,_u,this.getHash())}}isVisible(e){if(a(this,De).size===0)return!0;if(!e)return tv("Optional content group not defined."),!0;if(e.type==="OCG")return a(this,De).has(e.id)?a(this,De).get(e.id).visible:(ae(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return A(this,Xf,kw).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!a(this,De).has(t))return ae(`Optional content group not found: ${t}`),!0;if(a(this,De).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!a(this,De).has(t))return ae(`Optional content group not found: ${t}`),!0;if(!a(this,De).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!a(this,De).has(t))return ae(`Optional content group not found: ${t}`),!0;if(!a(this,De).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!a(this,De).has(t))return ae(`Optional content group not found: ${t}`),!0;if(a(this,De).get(t).visible)return!1}return!0}return ae(`Unknown optional content policy ${e.policy}.`),!0}return ae(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=a(this,De).get(e);if(!i){ae(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const o of i.rbGroups)for(const l of o)l!==e&&((r=a(this,De).get(l))==null||r._setVisible(pc,!1,!0));i._setVisible(pc,!!t,!0),g(this,Co,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=a(this,De).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}g(this,Co,null)}get hasInitialVisibility(){return a(this,_u)===null||this.getHash()===a(this,_u)}getOrder(){return a(this,De).size?a(this,ku)?a(this,ku).slice():[...a(this,De).keys()]:null}getGroup(e){return a(this,De).get(e)||null}getHash(){if(a(this,Co)!==null)return a(this,Co);const e=new o_;for(const[t,s]of a(this,De))e.update(`${t}:${s.visible}`);return g(this,Co,e.hexdigest())}[Symbol.iterator](){return a(this,De).entries()}}Co=new WeakMap,De=new WeakMap,_u=new WeakMap,ku=new WeakMap,Xf=new WeakSet,kw=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let o;if(Array.isArray(r))o=A(this,Xf,kw).call(this,r);else if(a(this,De).has(r))o=a(this,De).get(r).visible;else return ae(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"};class oR{constructor(e,{disableRange:t=!1,disableStream:s=!1}){we(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:o,contentDispositionFilename:l}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=l,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});we(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){we(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new aR(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new lR(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class aR{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=sv(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class lR{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function cR(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let h=l(t);return h=unescape(h),h=c(h),h=u(h),r(h)}if(t=o(n),t){const h=u(t);return r(h)}if(t=s("filename","i").exec(n),t){t=t[1];let h=l(t);return h=u(h),r(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function i(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),m=Kp(d);d=f.decode(m),e=!1}catch{}}return d}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=i("utf-8",h),e&&(h=i("iso-8859-1",h))),h}function o(h){const d=[];let f;const m=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=m.exec(h))!==null;){let[,x,C,y]=f;if(x=parseInt(x,10),x in d){if(x===0)break;continue}d[x]=[C,y]}const S=[];for(let x=0;x<d.length&&x in d;++x){let[C,y]=d[x];y=l(y),C&&(y=unescape(y),x===0&&(y=c(y))),S.push(y)}return S.join("")}function l(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const m=d[f].indexOf('"');m!==-1&&(d[f]=d[f].slice(0,m),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function c(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),S=h.slice(d+1).replace(/^[^']*'/,"");return i(f,S)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,m,S){if(m==="q"||m==="Q")return S=S.replaceAll("_"," "),S=S.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,C){return String.fromCharCode(parseInt(C,16))}),i(f,S);try{S=atob(S)}catch{}return i(f,S)})}return""}function w_(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function iv(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function x_({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function S_(n){const e=n.get("Content-Disposition");if(e){let t=cR(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(sv(t))return t}return null}function eg(n,e){return new ef(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function b_(n){return n===200||n===206}function A_(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function E_(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ae(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class uR{constructor(e){F(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=w_(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return we(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new hR(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new dR(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class hR{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,A_(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=iv(r.url),!b_(r.status))throw eg(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:l,suggestedLength:c}=x_({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=c||this._contentLength,this._filename=S_(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new $r("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:E_(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class dR{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const o=i.url;fetch(o,A_(r,this._withCredentials,this._abortController)).then(l=>{const c=iv(l.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!b_(l.status))throw eg(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:E_(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Yv=200,Kv=206;function fR(n){const e=n.response;return typeof e!="string"?e:Kp(e).buffer}class pR{constructor({url:e,httpHeaders:t,withCredentials:s}){F(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=w_(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,o]of this.headers)t.setRequestHeader(r,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Kv):i.expectedStatus=Yv,t.responseType="arraybuffer",we(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||Yv;if(!(r===Yv&&s.expectedStatus===Kv)&&r!==s.expectedStatus){s.onError(i.status);return}const l=fR(i);if(r===Kv){const c=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:l}):(ae('Missing or invalid "Content-Range" header.'),s.onError(0))}else l?s.onDone({begin:0,chunk:l}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class gR{constructor(e){this._source=e,this._manager=new pR(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return we(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new mR(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new yR(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class mR{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=iv(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[c,...u]=l.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=x_({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=S_(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=eg(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class yR{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=iv((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=eg(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const vR=/^[a-z][a-z0-9\-+.]+:/i;function wR(n){if(vR.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class xR{constructor(e){this.source=e,this.url=wR(e.url),we(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return we(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new SR(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new bR(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class SR{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=eg(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new $r("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class bR{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Wh=Symbol("INITIAL_DATA");var Gn,qf,Tw;class C_{constructor(){b(this,qf);b(this,Gn,Object.create(null))}get(e,t=null){if(t){const i=A(this,qf,Tw).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=a(this,Gn)[e];if(!s||s.data===Wh)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=a(this,Gn)[e];return!!t&&t.data!==Wh}delete(e){const t=a(this,Gn)[e];return!t||t.data===Wh?!1:(delete a(this,Gn)[e],!0)}resolve(e,t=null){const s=A(this,qf,Tw).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in a(this,Gn)){const{data:s}=a(this,Gn)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}g(this,Gn,Object.create(null))}*[Symbol.iterator](){for(const e in a(this,Gn)){const{data:t}=a(this,Gn)[e];t!==Wh&&(yield[e,t])}}}Gn=new WeakMap,qf=new WeakSet,Tw=function(e){var t;return(t=a(this,Gn))[e]||(t[e]={...Promise.withResolvers(),data:Wh})};const AR=1e5,Tb=30;var $b,_o,Nn,Yf,Kf,al,mr,Qf,Jf,ll,Tu,Pu,ko,Lu,Zf,Nu,cl,ep,tp,ht,Ru,ul,np,To,Mu,Gr,__,k_,Pw,us,im,Lw,T_,P_;let rf=(ht=class{constructor({textContentSource:e,container:t,viewport:s}){b(this,Gr);b(this,_o,Promise.withResolvers());b(this,Nn,null);b(this,Yf,!1);b(this,Kf,!!(($b=globalThis.FontInspector)!=null&&$b.enabled));b(this,al,null);b(this,mr,null);b(this,Qf,0);b(this,Jf,0);b(this,ll,null);b(this,Tu,null);b(this,Pu,0);b(this,ko,0);b(this,Lu,Object.create(null));b(this,Zf,[]);b(this,Nu,null);b(this,cl,[]);b(this,ep,new WeakMap);b(this,tp,null);var c;if(e instanceof ReadableStream)g(this,Nu,e);else if(typeof e=="object")g(this,Nu,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');g(this,Nn,g(this,Tu,t)),g(this,ko,s.scale*li.pixelRatio),g(this,Pu,s.rotation),g(this,mr,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:o,pageY:l}=s.rawDims;g(this,tp,[1,0,0,-1,-o,l+r]),g(this,Jf,i),g(this,Qf,r),A(c=ht,us,T_).call(c),pa(t,s),a(this,_o).promise.finally(()=>{a(ht,Mu).delete(this),g(this,mr,null),g(this,Lu,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Bt.platform;return he(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{a(this,ll).read().then(({value:t,done:s})=>{if(s){a(this,_o).resolve();return}a(this,al)??g(this,al,t.lang),Object.assign(a(this,Lu),t.styles),A(this,Gr,__).call(this,t.items),e()},a(this,_o).reject)};return g(this,ll,a(this,Nu).getReader()),a(ht,Mu).add(this),e(),a(this,_o).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*li.pixelRatio,i=e.rotation;if(i!==a(this,Pu)&&(t==null||t(),g(this,Pu,i),pa(a(this,Tu),{rotation:i})),s!==a(this,ko)){t==null||t(),g(this,ko,s);const o={div:null,properties:null,ctx:A(r=ht,us,im).call(r,a(this,al))};for(const l of a(this,cl))o.properties=a(this,ep).get(l),o.div=l,A(this,Gr,Pw).call(this,o)}}cancel(){var t;const e=new $r("TextLayer task cancelled.");(t=a(this,ll))==null||t.cancel(e).catch(()=>{}),g(this,ll,null),a(this,_o).reject(e)}get textDivs(){return a(this,cl)}get textContentItemsStr(){return a(this,Zf)}static cleanup(){if(!(a(this,Mu).size>0)){a(this,Ru).clear();for(const{canvas:e}of a(this,ul).values())e.remove();a(this,ul).clear()}}},_o=new WeakMap,Nn=new WeakMap,Yf=new WeakMap,Kf=new WeakMap,al=new WeakMap,mr=new WeakMap,Qf=new WeakMap,Jf=new WeakMap,ll=new WeakMap,Tu=new WeakMap,Pu=new WeakMap,ko=new WeakMap,Lu=new WeakMap,Zf=new WeakMap,Nu=new WeakMap,cl=new WeakMap,ep=new WeakMap,tp=new WeakMap,Ru=new WeakMap,ul=new WeakMap,np=new WeakMap,To=new WeakMap,Mu=new WeakMap,Gr=new WeakSet,__=function(e){var i,r;if(a(this,Yf))return;(r=a(this,mr)).ctx??(r.ctx=A(i=ht,us,im).call(i,a(this,al)));const t=a(this,cl),s=a(this,Zf);for(const o of e){if(t.length>AR){ae("Ignoring additional textDivs for performance reasons."),g(this,Yf,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const l=a(this,Nn);g(this,Nn,document.createElement("span")),a(this,Nn).classList.add("markedContent"),o.id&&a(this,Nn).setAttribute("id",`${o.id}`),l.append(a(this,Nn))}else o.type==="endMarkedContent"&&g(this,Nn,a(this,Nn).parentNode);continue}s.push(o.str),A(this,Gr,k_).call(this,o)}},k_=function(e){var x;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};a(this,cl).push(t);const i=X.transform(a(this,tp),e.transform);let r=Math.atan2(i[1],i[0]);const o=a(this,Lu)[e.fontName];o.vertical&&(r+=Math.PI/2);let l=a(this,Kf)&&o.fontSubstitution||o.fontFamily;l=ht.fontFamilyMap.get(l)||l;const c=Math.hypot(i[2],i[3]),u=c*A(x=ht,us,P_).call(x,l,o,a(this,al));let h,d;r===0?(h=i[4],d=i[5]-u):(h=i[4]+u*Math.sin(r),d=i[5]-u*Math.cos(r));const f="calc(var(--total-scale-factor) *",m=t.style;a(this,Nn)===a(this,Tu)?(m.left=`${(100*h/a(this,Jf)).toFixed(2)}%`,m.top=`${(100*d/a(this,Qf)).toFixed(2)}%`):(m.left=`${f}${h.toFixed(2)}px)`,m.top=`${f}${d.toFixed(2)}px)`),m.fontSize=`${f}${(a(ht,To)*c).toFixed(2)}px)`,m.fontFamily=l,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,a(this,Kf)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let S=!1;if(e.str.length>1)S=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const C=Math.abs(e.transform[0]),y=Math.abs(e.transform[3]);C!==y&&Math.max(C,y)/Math.min(C,y)>1.5&&(S=!0)}if(S&&(s.canvasWidth=o.vertical?e.height:e.width),a(this,ep).set(t,s),a(this,mr).div=t,a(this,mr).properties=s,A(this,Gr,Pw).call(this,a(this,mr)),s.hasText&&a(this,Nn).append(t),s.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),a(this,Nn).append(C)}},Pw=function(e){var l;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let o="";if(a(ht,To)>1&&(o=`scale(${1/a(ht,To)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:h}=s;A(l=ht,us,Lw).call(l,i,h*a(this,ko),c);const{width:d}=i.measureText(t.textContent);d>0&&(o=`scaleX(${u*a(this,ko)/d}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(r.transform=o)},us=new WeakSet,im=function(e=null){let t=a(this,ul).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),a(this,ul).set(e,t),a(this,np).set(t,{size:0,family:""})}return t},Lw=function(e,t,s){const i=a(this,np).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},T_=function(){if(a(this,To)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),g(this,To,e.getBoundingClientRect().height),e.remove()},P_=function(e,t,s){const i=a(this,Ru).get(e);if(i)return i;const r=A(this,us,im).call(this,s);r.canvas.width=r.canvas.height=Tb,A(this,us,Lw).call(this,r,Tb,e);const o=r.measureText(""),l=o.fontBoundingBoxAscent,c=Math.abs(o.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let u=.8;return l?u=l/(l+c):(Bt.platform.isFirefox&&ae("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),a(this,Ru).set(e,u),u},b(ht,us),b(ht,Ru,new Map),b(ht,ul,new Map),b(ht,np,new WeakMap),b(ht,To,null),b(ht,Mu,new Set),ht);const ER=100;function k1(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Nw,{docId:t}=e,s=n.url?RN(n.url):null,i=n.data?MN(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,l=n.password??null,c=n.range instanceof T1?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let h=n.worker instanceof Ch?n.worker:null;const d=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Jp(n.docBaseUrl)?n.docBaseUrl:null,m=kg(n.cMapUrl),S=n.cMapPacked!==!1,x=n.CMapReaderFactory||(vn?zN:pb),C=kg(n.iccUrl),y=kg(n.standardFontDataUrl),w=n.StandardFontDataFactory||(vn?UN:gb),v=kg(n.wasmUrl),E=n.WasmFactory||(vn?$N:mb),_=n.stopAtErrors!==!0,k=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,T=n.isEvalSupported!==!1,L=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!vn,R=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!vn&&(Bt.platform.isFirefox||!globalThis.chrome),N=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,M=typeof n.disableFontFace=="boolean"?n.disableFontFace:vn,O=n.fontExtraProperties===!0,V=n.enableXfa===!0,H=n.ownerDocument||globalThis.document,te=n.disableRange===!0,z=n.disableStream===!0,B=n.disableAutoFetch===!0,D=n.pdfBug===!0,U=n.CanvasFactory||(vn?BN:FN),K=n.FilterFactory||(vn?ON:jN),le=n.enableHWA===!0,Z=n.useWasm!==!1,se=c?c.length:n.length??NaN,_e=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!vn&&!M,J=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(x===pb&&w===gb&&E===mb&&m&&y&&v&&td(m,document.baseURI)&&td(y,document.baseURI)&&td(v,document.baseURI)),ie=null;fN(d);const ye={canvasFactory:new U({ownerDocument:H,enableHWA:le}),filterFactory:new K({docId:t,ownerDocument:H}),cMapReaderFactory:J?null:new x({baseUrl:m,isCompressed:S}),standardFontDataFactory:J?null:new w({baseUrl:y}),wasmFactory:J?null:new E({baseUrl:v})};h||(h=Ch.create({verbosity:d,port:Ls.workerPort}),e._worker=h);const Os={docId:t,apiVersion:"5.4.296",data:i,password:l,disableAutoFetch:B,rangeChunkSize:u,length:se,docBaseUrl:f,enableXfa:V,evaluatorOptions:{maxImageSize:k,disableFontFace:M,ignoreErrors:_,isEvalSupported:T,isOffscreenCanvasSupported:L,isImageDecoderSupported:R,canvasMaxAreaInBytes:N,fontExtraProperties:O,useSystemFonts:_e,useWasm:Z,useWorkerFetch:J,cMapUrl:m,iccUrl:C,standardFontDataUrl:y,wasmUrl:v}},Bs={ownerDocument:H,pdfBug:D,styleElement:ie,loadingParams:{disableAutoFetch:B,enableXfa:V}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const dn=h.messageHandler.sendWithPromise("GetDocRequest",Os,i?[i.buffer]:null);let Ee;if(c)Ee=new oR(c,{disableRange:te,disableStream:z});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const I=td(s)?uR:vn?xR:gR;Ee=new I({url:s,length:se,httpHeaders:r,withCredentials:o,rangeChunkSize:u,disableRange:te,disableStream:z})}return dn.then(I=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const ee=new ad(t,I,h.port),re=new kR(ee,e,Ee,Bs,ye,le);e._transport=re,ee.send("Ready",null)})}).catch(e._capability.reject),e}var Sy;const by=class by{constructor(){F(this,"_capability",Promise.withResolvers());F(this,"_transport",null);F(this,"_worker",null);F(this,"docId",`d${At(by,Sy)._++}`);F(this,"destroyed",!1);F(this,"onPassword",null);F(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};Sy=new WeakMap,b(by,Sy,0);let Nw=by;var hl,sp,ip,rp,op,Hb;let T1=(Hb=class{constructor(e,t,s=!1,i=null){b(this,hl,Promise.withResolvers());b(this,sp,[]);b(this,ip,[]);b(this,rp,[]);b(this,op,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){a(this,op).push(e)}addProgressListener(e){a(this,rp).push(e)}addProgressiveReadListener(e){a(this,ip).push(e)}addProgressiveDoneListener(e){a(this,sp).push(e)}onDataRange(e,t){for(const s of a(this,op))s(e,t)}onDataProgress(e,t){a(this,hl).promise.then(()=>{for(const s of a(this,rp))s(e,t)})}onDataProgressiveRead(e){a(this,hl).promise.then(()=>{for(const t of a(this,ip))t(e)})}onDataProgressiveDone(){a(this,hl).promise.then(()=>{for(const e of a(this,sp))e()})}transportReady(){a(this,hl).resolve()}requestDataRange(e,t){ze("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},hl=new WeakMap,sp=new WeakMap,ip=new WeakMap,rp=new WeakMap,op=new WeakMap,Hb);class CR{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return he(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var yr,dl,pd;class _R{constructor(e,t,s,i=!1){b(this,dl);b(this,yr,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new ab:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new C_,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new Qp({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return he(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:i="display",annotationMode:r=Bi.ENABLE,transform:o=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:h=null,printAnnotationStorage:d=null,isEditing:f=!1,recordOperations:m=!1,operationsFilter:S=null}){var R,N,M;(R=this._stats)==null||R.time("Overall");const x=this._transport.getRenderingIntent(i,r,d,f),{renderingIntent:C,cacheKey:y}=x;g(this,yr,!1),c||(c=this._transport.getOptionalContentConfig(C));let w=this._intentStates.get(y);w||(w=Object.create(null),this._intentStates.set(y,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const v=!!(C&is.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(N=this._stats)==null||N.time("Page Request"),this._pumpOperatorList(x));const E=!!(this._pdfBug&&((M=globalThis.StepperManager)!=null&&M.enabled)),_=!this.recordedBBoxes&&(m||E),k=O=>{var V,H;if(w.renderTasks.delete(T),_){const te=(V=T.gfx)==null?void 0:V.dependencyTracker.take();te&&(T.stepper&&T.stepper.setOperatorBBoxes(te,T.gfx.dependencyTracker.takeDebugMetadata()),m&&(this.recordedBBoxes=te))}v&&g(this,yr,!0),A(this,dl,pd).call(this),O?(T.capability.reject(O),this._abortOperatorList({intentState:w,reason:O instanceof Error?O:new Error(O)})):T.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(H=globalThis.Stats)!=null&&H.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},T=new Rw({callback:k,params:{canvas:t,canvasContext:e,dependencyTracker:_?new VN(t,w.operatorList.length,E):null,viewport:s,transform:o,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!v,pdfBug:this._pdfBug,pageColors:h,enableHWA:this._transport.enableHWA,operationsFilter:S});(w.renderTasks||(w.renderTasks=new Set)).add(T);const L=T.task;return Promise.all([w.displayReadyCapability.promise,c]).then(([O,V])=>{var H;if(this.destroyed){k();return}if((H=this._stats)==null||H.time("Rendering"),!(V.renderingIntent&C))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");T.initializeGraphics({transparency:O,optionalContentConfig:V}),T.operatorListChanged()}).catch(k),L}getOperatorList({intent:e="display",annotationMode:t=Bi.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(c))}const o=this._transport.getRenderingIntent(e,t,s,i,!0);let l=this._intentStates.get(o.cacheKey);l||(l=Object.create(null),this._intentStates.set(o.cacheKey,l));let c;return l.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(c),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>tf.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){o.read().then(function({value:c,done:u}){if(u){s(l);return}l.lang??(l.lang=c.lang),Object.assign(l.styles,c.styles),l.items.push(...c.items),r()},i)}const o=t.getReader(),l={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),g(this,yr,!1),Promise.all(e)}cleanup(e=!1){g(this,yr,!0);const t=A(this,dl,pd).call(this);return e&&t&&this._stats&&(this._stats=new ab),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&A(this,dl,pd).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:o}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},o).getReader(),u=this._intentStates.get(t);u.streamReader=c;const h=()=>{c.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),h())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();A(this,dl,pd).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof nv){let i=ER;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new $r(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}yr=new WeakMap,dl=new WeakSet,pd=function(){if(!a(this,yr)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),g(this,yr,!1),!0};var Po,Ys,vr,fl,Ay,pl,gl,xn,rm,L_,N_,gd,Du,om;const qe=class qe{constructor({name:e=null,port:t=null,verbosity:s=pN()}={}){b(this,xn);b(this,Po,Promise.withResolvers());b(this,Ys,null);b(this,vr,null);b(this,fl,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(a(qe,gl).has(t))throw new Error("Cannot use more than one PDFWorker per port.");a(qe,gl).set(t,this),A(this,xn,L_).call(this,t)}else A(this,xn,N_).call(this)}get promise(){return a(this,Po).promise}get port(){return a(this,vr)}get messageHandler(){return a(this,Ys)}destroy(){var e,t;this.destroyed=!0,(e=a(this,fl))==null||e.terminate(),g(this,fl,null),a(qe,gl).delete(a(this,vr)),g(this,vr,null),(t=a(this,Ys))==null||t.destroy(),g(this,Ys,null)}static create(e){const t=a(this,gl).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new qe(e)}static get workerSrc(){if(Ls.workerSrc)return Ls.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return he(this,"_setupFakeWorkerGlobal",(async()=>a(this,Du,om)?a(this,Du,om):(await import(this.workerSrc)).WorkerMessageHandler)())}};Po=new WeakMap,Ys=new WeakMap,vr=new WeakMap,fl=new WeakMap,Ay=new WeakMap,pl=new WeakMap,gl=new WeakMap,xn=new WeakSet,rm=function(){a(this,Po).resolve(),a(this,Ys).send("configure",{verbosity:this.verbosity})},L_=function(e){g(this,vr,e),g(this,Ys,new ad("main","worker",e)),a(this,Ys).on("ready",()=>{}),A(this,xn,rm).call(this)},N_=function(){if(a(qe,pl)||a(qe,Du,om)){A(this,xn,gd).call(this);return}let{workerSrc:e}=qe;try{qe._isSameOrigin(window.location,e)||(e=qe._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new ad("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?a(this,Po).reject(new Error("Worker was destroyed")):A(this,xn,gd).call(this)},r=new AbortController;t.addEventListener("error",()=>{a(this,fl)||i()},{signal:r.signal}),s.on("test",l=>{if(r.abort(),this.destroyed||!l){i();return}g(this,Ys,s),g(this,vr,t),g(this,fl,t),A(this,xn,rm).call(this)}),s.on("ready",l=>{if(r.abort(),this.destroyed){i();return}try{o()}catch{A(this,xn,gd).call(this)}});const o=()=>{const l=new Uint8Array;s.send("test",l,[l.buffer])};o();return}catch{tv("The worker has been disabled.")}A(this,xn,gd).call(this)},gd=function(){a(qe,pl)||(ae("Setting up fake worker."),g(qe,pl,!0)),qe._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){a(this,Po).reject(new Error("Worker was destroyed"));return}const t=new IN;g(this,vr,t);const s=`fake${At(qe,Ay)._++}`,i=new ad(s+"_worker",s,t);e.setup(i,t),g(this,Ys,new ad(s,s+"_worker",t)),A(this,xn,rm).call(this)}).catch(e=>{a(this,Po).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Du=new WeakSet,om=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},b(qe,Du),b(qe,Ay,0),b(qe,pl,!1),b(qe,gl,new WeakMap),vn&&(g(qe,pl,!0),Ls.workerSrc||(Ls.workerSrc="./pdf.worker.mjs")),qe._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},qe._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},qe.fromPort=e=>{if(AN("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return qe.create(e)};let Ch=qe;var wr,Ti,Iu,Fu,xr,ml,md;class kR{constructor(e,t,s,i,r,o){b(this,ml);b(this,wr,new Map);b(this,Ti,new Map);b(this,Iu,new Map);b(this,Fu,new Map);b(this,xr,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new C_,this.fontLoader=new LN({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}get annotationStorage(){return he(this,"annotationStorage",new E1)}getRenderingIntent(e,t=Bi.ENABLE,s=null,i=!1,r=!1){let o=is.DISPLAY,l=gw;switch(e){case"any":o=is.ANY;break;case"display":break;case"print":o=is.PRINT;break;default:ae(`getRenderingIntent - invalid intent: ${e}`)}const c=o&is.PRINT&&s instanceof l_?s:this.annotationStorage;switch(t){case Bi.DISABLE:o+=is.ANNOTATIONS_DISABLE;break;case Bi.ENABLE:break;case Bi.ENABLE_FORMS:o+=is.ANNOTATIONS_FORMS;break;case Bi.ENABLE_STORAGE:o+=is.ANNOTATIONS_STORAGE,l=c.serializable;break;default:ae(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=is.IS_EDITING),r&&(o+=is.OPLIST);const{ids:u,hash:h}=c.modifiedIds,d=[o,l.hash,h];return{renderingIntent:o,cacheKey:d.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=a(this,xr))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of a(this,Ti).values())e.push(i._destroy());a(this,Ti).clear(),a(this,Iu).clear(),a(this,Fu).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),a(this,wr).clear(),this.filterFactory.destroy(),rf.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new $r("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{we(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){i.close();return}we(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async s=>{var l;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:o}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((l=t.onProgress)==null||l.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:o}}),e.on("GetRangeReader",(s,i)=>{we(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:o,done:l}){if(l){i.close();return}we(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{r.cancel(o),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new CR(s,this))}),e.on("DocException",s=>{t._capability.reject(Cn(s))}),e.on("PasswordRequest",s=>{g(this,xr,Promise.withResolvers());try{if(!t.onPassword)throw Cn(s);const i=r=>{r instanceof Error?a(this,xr).reject(r):a(this,xr).resolve({password:r})};t.onPassword(i,s.code)}catch(i){a(this,xr).reject(i)}return a(this,xr).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;a(this,Ti).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var o;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const d=r.error;ae(`Error during font loading: ${d}`),this.commonObjs.resolve(s,d);break}const l=new _w(r),c=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(d,f)=>globalThis.FontInspector.fontAdded(d,f):null,u=new NN(l,c,r.extra,r.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(s,u)});break;case"CopyLocalImage":const{imageRef:h}=r;we(h,"The imageRef must be defined.");for(const d of a(this,Ti).values())for(const[,f]of d.objs)if((f==null?void 0:f.ref)===h)return f.dataLen?(this.commonObjs.resolve(s,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,o])=>{var c;if(this.destroyed)return;const l=a(this,Ti).get(i);if(!l.objs.has(s)){if(l._intentStates.size===0){(c=o==null?void 0:o.bitmap)==null||c.close();return}switch(r){case"Image":case"Pattern":l.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&ae("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=a(this,Iu).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&a(this,Fu).set(r.refStr,e);const o=new _R(t,r,this,this._params.pdfBug);return a(this,Ti).set(t,o),o});return a(this,Iu).set(t,i),i}getPageIndex(e){return mw(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return A(this,ml,md).call(this,"GetFieldObjects")}hasJSActions(){return A(this,ml,md).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return A(this,ml,md).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return A(this,ml,md).call(this,"GetOptionalContentConfig").then(t=>new rR(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=a(this,wr).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,o;return{info:i[0],metadata:i[1]?new sR(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return a(this,wr).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of a(this,Ti).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),a(this,wr).clear(),this.filterFactory.destroy(!0),rf.cleanup()}}cachedPageNumber(e){if(!mw(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return a(this,Fu).get(t)??null}}wr=new WeakMap,Ti=new WeakMap,Iu=new WeakMap,Fu=new WeakMap,xr=new WeakMap,ml=new WeakSet,md=function(e,t=null){const s=a(this,wr).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return a(this,wr).set(e,i),i};var Lo;class TR{constructor(e){b(this,Lo,null);F(this,"onContinue",null);F(this,"onError",null);g(this,Lo,e)}get promise(){return a(this,Lo).capability.promise}cancel(e=0){a(this,Lo).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=a(this,Lo).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=a(this,Lo);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Lo=new WeakMap;var No,yl;const Ta=class Ta{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:o,pageIndex:l,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null,enableHWA:m=!1,operationsFilter:S=null}){b(this,No,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new TR(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=m,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=S}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var c,u;if(this.cancelled)return;if(this._canvas){if(a(Ta,yl).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");a(Ta,yl).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:i,background:r,dependencyTracker:o}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Uc(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:i,viewport:s,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var s,i,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),a(this,No)&&(window.cancelAnimationFrame(a(this,No)),g(this,No,null)),a(Ta,yl).delete(this._canvas),e||(e=new nv(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(i=this.task).onError)==null||r.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?g(this,No,window.requestAnimationFrame(()=>{g(this,No,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),a(Ta,yl).delete(this._canvas),this.callback())))}};No=new WeakMap,yl=new WeakMap,b(Ta,yl,new WeakSet);let Rw=Ta;const P1="5.4.296",R_="f56dc8601";var Wn,vl,ju,_t,ap,Ou,Sr,lp,Ro,Ks,cp,Ie,Mw,Dw,Iw,Ea,M_,Jr;const _n=class _n{constructor({editor:e=null,uiManager:t=null}){b(this,Ie);b(this,Wn,null);b(this,vl,null);b(this,ju);b(this,_t,null);b(this,ap,!1);b(this,Ou,!1);b(this,Sr,null);b(this,lp);b(this,Ro,null);b(this,Ks,null);var s,i;e?(g(this,Ou,!1),g(this,Sr,e)):g(this,Ou,!0),g(this,Ks,(e==null?void 0:e._uiManager)||t),g(this,lp,a(this,Ks)._eventBus),g(this,ju,((s=e==null?void 0:e.color)==null?void 0:s.toUpperCase())||((i=a(this,Ks))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),a(_n,cp)||g(_n,cp,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return he(this,"_keyboardManager",new Zp([[["Escape","mac+Escape"],_n.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],_n.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],_n.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],_n.prototype._moveToPrevious],[["Home","mac+Home"],_n.prototype._moveToBeginning],[["End","mac+End"],_n.prototype._moveToEnd]]))}renderButton(){const e=g(this,Wn,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",a(this,Sr)&&(e.ariaControls=`${a(this,Sr).id}_colorpicker_dropdown`);const t=a(this,Ks)._signal;e.addEventListener("click",A(this,Ie,Ea).bind(this),{signal:t}),e.addEventListener("keydown",A(this,Ie,Iw).bind(this),{signal:t});const s=g(this,vl,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=a(this,ju),e.append(s),e}renderMainDropdown(){const e=g(this,_t,A(this,Ie,Mw).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===a(this,Wn)){A(this,Ie,Ea).call(this,e);return}const t=e.target.getAttribute("data-color");t&&A(this,Ie,Dw).call(this,t,e)}_moveToNext(e){var t,s;if(!a(this,Ie,Jr)){A(this,Ie,Ea).call(this,e);return}if(e.target===a(this,Wn)){(t=a(this,_t).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=a(this,_t))==null?void 0:t.firstChild)||e.target===a(this,Wn)){a(this,Ie,Jr)&&this._hideDropdownFromKeyboard();return}a(this,Ie,Jr)||A(this,Ie,Ea).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!a(this,Ie,Jr)){A(this,Ie,Ea).call(this,e);return}(t=a(this,_t).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!a(this,Ie,Jr)){A(this,Ie,Ea).call(this,e);return}(t=a(this,_t).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=a(this,_t))==null||e.classList.add("hidden"),a(this,Wn).ariaExpanded="false",(t=a(this,Ro))==null||t.abort(),g(this,Ro,null)}_hideDropdownFromKeyboard(){var e;if(!a(this,Ou)){if(!a(this,Ie,Jr)){(e=a(this,Sr))==null||e.unselect();return}this.hideDropdown(),a(this,Wn).focus({preventScroll:!0,focusVisible:a(this,ap)})}}updateColor(e){if(a(this,vl)&&(a(this,vl).style.backgroundColor=e),!a(this,_t))return;const t=a(this,Ks).highlightColors.values();for(const s of a(this,_t).children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=a(this,Wn))==null||e.remove(),g(this,Wn,null),g(this,vl,null),(t=a(this,_t))==null||t.remove(),g(this,_t,null)}};Wn=new WeakMap,vl=new WeakMap,ju=new WeakMap,_t=new WeakMap,ap=new WeakMap,Ou=new WeakMap,Sr=new WeakMap,lp=new WeakMap,Ro=new WeakMap,Ks=new WeakMap,cp=new WeakMap,Ie=new WeakSet,Mw=function(){const e=document.createElement("div"),t=a(this,Ks)._signal;e.addEventListener("contextmenu",ds,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),a(this,Sr)&&(e.id=`${a(this,Sr).id}_colorpicker_dropdown`);for(const[s,i]of a(this,Ks).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",a(_n,cp)[s]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=i,r.ariaSelected=i===a(this,ju),r.addEventListener("click",A(this,Ie,Dw).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",A(this,Ie,Iw).bind(this),{signal:t}),e},Dw=function(e,t){t.stopPropagation(),a(this,lp).dispatch("switchannotationeditorparams",{source:this,type:me.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},Iw=function(e){_n._keyboardManager.exec(this,e)},Ea=function(e){if(a(this,Ie,Jr)){this.hideDropdown();return}if(g(this,ap,e.detail===0),a(this,Ro)||(g(this,Ro,new AbortController),window.addEventListener("pointerdown",A(this,Ie,M_).bind(this),{signal:a(this,Ks).combinedSignal(a(this,Ro))})),a(this,Wn).ariaExpanded="true",a(this,_t)){a(this,_t).classList.remove("hidden");return}const t=g(this,_t,A(this,Ie,Mw).call(this));a(this,Wn).append(t)},M_=function(e){var t;(t=a(this,_t))!=null&&t.contains(e.target)||this.hideDropdown()},Jr=function(){return a(this,_t)&&!a(this,_t).classList.contains("hidden")},b(_n,cp,null);let of=_n;var Pi,up,Bu,hp;const Pa=class Pa{constructor(e){b(this,Pi,null);b(this,up,null);b(this,Bu,null);g(this,up,e),g(this,Bu,e._uiManager),a(Pa,hp)||g(Pa,hp,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(a(this,Pi))return a(this,Pi);const{editorType:e,colorType:t,colorValue:s}=a(this,up),i=g(this,Pi,document.createElement("input"));return i.type="color",i.value=s||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",a(Pa,hp)[e]),i.addEventListener("input",()=>{a(this,Bu).updateParams(t,i.value)},{signal:a(this,Bu)._signal}),i}update(e){a(this,Pi)&&(a(this,Pi).value=e)}destroy(){var e;(e=a(this,Pi))==null||e.remove(),g(this,Pi,null)}hideDropdown(){}};Pi=new WeakMap,up=new WeakMap,Bu=new WeakMap,hp=new WeakMap,b(Pa,hp,null);let oy=Pa;function Pb(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Xh(n){return Math.max(0,Math.min(255,255*n))}class Lb{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Xh(e),[e,e,e]}static G_HTML([e]){const t=Pb(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Xh)}static RGB_HTML(e){return`#${e.map(Pb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[Xh(1-Math.min(1,e+i)),Xh(1-Math.min(1,s+i)),Xh(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,o=1-s,l=Math.min(i,r,o);return["CMYK",i,r,o,l]}}class PR{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){ze("Abstract method `_createSVG` called.")}}class af extends PR{_createSVG(e){return document.createElementNS(Wi,e)}}const LR=9,Jl=new WeakSet,NR=new Date().getTimezoneOffset()*60*1e3;class Nb{static create(e){switch(e.data.annotationType){case pt.LINK:return new L1(e);case pt.TEXT:return new MR(e);case pt.WIDGET:switch(e.data.fieldType){case"Tx":return new DR(e);case"Btn":return e.data.radioButton?new F_(e):e.data.checkBox?new FR(e):new jR(e);case"Ch":return new OR(e);case"Sig":return new IR(e)}return new ic(e);case pt.POPUP:return new jw(e);case pt.FREETEXT:return new U_(e);case pt.LINE:return new zR(e);case pt.SQUARE:return new UR(e);case pt.CIRCLE:return new $R(e);case pt.POLYLINE:return new $_(e);case pt.CARET:return new VR(e);case pt.INK:return new N1(e);case pt.POLYGON:return new HR(e);case pt.HIGHLIGHT:return new H_(e);case pt.UNDERLINE:return new GR(e);case pt.SQUIGGLY:return new WR(e);case pt.STRIKEOUT:return new XR(e);case pt.STAMP:return new V_(e);case pt.FILEATTACHMENT:return new qR(e);default:return new rt(e)}}}var wl,zu,Cs,dp,Fw;const B1=class B1{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){b(this,dp);b(this,wl,null);b(this,zu,!1);b(this,Cs,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return B1._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var s;const{data:e}=this,t=(s=this.annotationStorage)==null?void 0:s.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var l;const e=(l=this.annotationStorage)==null?void 0:l.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:s,rect:i}=this.data;let r=-1/0,o=-1/0;if((t==null?void 0:t.length)>=8){for(let c=0;c<t.length;c+=8)t[c+1]>o?(o=t[c+1],r=t[c+2]):t[c+1]===o&&(r=Math.max(r,t[c+2]));return[r,o]}if((s==null?void 0:s.length)>=1){for(const c of s)for(let u=0,h=c.length;u<h;u+=2)c[u+1]>o?(o=c[u+1],r=c[u]):c[u+1]===o&&(r=Math.max(r,c[u]));if(r!==1/0)return[r,o]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-r)/s,e[1]=100*(e[1]-o)/i,e}get commentText(){var t,s,i;const{data:e}=this;return((s=(t=this.annotationStorage.getRawValue(`${Zd}${e.id}`))==null?void 0:t.popup)==null?void 0:s.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,s={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:s})||this.annotationStorage.setValue(`${Zd}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=a(this,Cs))==null?void 0:e.popup)||this.popup)==null||t.remove(),g(this,Cs,this.popup=null)}updateEdited(e){var r;if(!this.container)return;e.rect&&(a(this,wl)||g(this,wl,{rect:this.data.rect.slice(0)}));const{rect:t,popup:s}=e;t&&A(this,dp,Fw).call(this,t);let i=((r=a(this,Cs))==null?void 0:r.popup)||this.popup;!i&&(s!=null&&s.text)&&(this._createPopup(s),i=a(this,Cs).popup),i&&(i.updateEdited(e),s!=null&&s.deleted&&(i.remove(),g(this,Cs,null),this.popup=null))}resetEdited(){var e;a(this,wl)&&(A(this,dp,Fw).call(this,a(this,wl).rect),(e=a(this,Cs))==null||e.popup.resetEdited(),g(this,wl,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),!(this instanceof ic)&&!(this instanceof L1)&&(r.tabIndex=0);const{style:o}=r;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof jw){const{rotation:x}=t;return!t.hasOwnCanvas&&x!==0&&this.setRotation(x,r),r}const{width:l,height:c}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const x=t.borderStyle.horizontalCornerRadius,C=t.borderStyle.verticalCornerRadius;if(x>0||C>0){const w=`calc(${x}px * var(--total-scale-factor)) / calc(${C}px * var(--total-scale-factor))`;o.borderRadius=w}else if(this instanceof F_){const w=`calc(${l}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;o.borderRadius=w}switch(t.borderStyle.style){case cc.SOLID:o.borderStyle="solid";break;case cc.DASHED:o.borderStyle="dashed";break;case cc.BEVELED:ae("Unimplemented border style: beveled");break;case cc.INSET:ae("Unimplemented border style: inset");break;case cc.UNDERLINE:o.borderBottomStyle="solid";break}const y=t.borderColor||null;y?(g(this,zu,!0),o.borderColor=X.makeHexColor(y[0]|0,y[1]|0,y[2]|0)):o.borderWidth=0}const u=X.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:m}=i.rawDims;o.left=`${100*(u[0]-f)/h}%`,o.top=`${100*(u[1]-m)/d}%`;const{rotation:S}=t;return t.hasOwnCanvas||S===0?(o.width=`${100*l/h}%`,o.height=`${100*c/d}%`):this.setRotation(S,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:o}=this;e%180!==0&&([r,o]=[o,r]),t.style.width=`${100*r/s}%`,t.style.height=`${100*o/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],o=r[0],l=r.slice(1);i.target.style[s]=Lb[`${o}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[s]:Lb[`${o}_rgb`](l)})};return he(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const o=s[i];if(o){const l={detail:{[i]:r},target:e};o(l),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(x=>Math.fround(x));if(e.length===8){const[x,C,y,w]=e.subarray(2,6);if(i===x&&r===C&&t===y&&s===w)return}const{style:o}=this.container;let l;if(a(this,zu)){const{borderColor:x,borderWidth:C}=o;o.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const c=i-t,u=r-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0),d.role="none";const f=h.createElement("defs");d.append(f);const m=h.createElement("clipPath"),S=`clippath_${this.data.id}`;m.setAttribute("id",S),m.setAttribute("clipPathUnits","objectBoundingBox"),f.append(m);for(let x=2,C=e.length;x<C;x+=8){const y=e[x],w=e[x+1],v=e[x+2],E=e[x+3],_=h.createElement("rect"),k=(v-t)/c,T=(r-w)/u,L=(y-v)/c,R=(w-E)/u;_.setAttribute("x",k),_.setAttribute("y",T),_.setAttribute("width",L),_.setAttribute("height",R),m.append(_),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${T}" width="${L}" height="${R}"/>`)}a(this,zu)&&(l.push("</g></svg>')"),o.backgroundImage=l.join("")),this.container.append(d),this.container.style.clipPath=`url(#${S})`}_createPopup(e=null){const{data:t}=this;let s,i;e?(s={str:e.text},i=e.date):(s=t.contentsObj,i=t.modificationDate);const r=g(this,Cs,new jw({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent._commentManager||this.parent.div.append(r.render())}get hasPopupElement(){return!!(a(this,Cs)||this.popup||this.data.popupRef)}get extraPopupElement(){return a(this,Cs)}render(){ze("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:o,exportValues:l}of i){if(r===-1||o===t)continue;const c=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!Jl.has(u)){ae(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:c,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,o=i.getAttribute("data-element-id");o!==t&&Jl.has(i)&&s.push({id:o,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};wl=new WeakMap,zu=new WeakMap,Cs=new WeakMap,dp=new WeakSet,Fw=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:l,pageY:c}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-l)/r}%`,t.top=`${100*(o-e[3]+c)/o}%`,i===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(i)};let rt=B1;class RR extends rt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}var as,Ca,D_,I_;class L1 extends rt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});b(this,as);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),r=!0):t.attachment?(A(this,as,D_).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(A(this,as,I_).call(this,i,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s,i=""){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&A(this,as,Ca).call(this),i&&(t.title=i)}_bindNamedAction(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),i&&(t.title=i),A(this,as,Ca).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const o=i.get(r);o&&(t[o]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}s.overlaidText&&(t.title=s.overlaidText),t.onclick||(t.onclick=()=>!1),A(this,as,Ca).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),A(this,as,Ca).call(this),!this._fieldObjects){ae('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var d;i==null||i();const{fields:r,refs:o,include:l}=s,c=[];if(r.length!==0||o.length!==0){const f=new Set(o);for(const m of r){const S=this._fieldObjects[m]||[];for(const{id:x}of S)f.add(x)}for(const m of Object.values(this._fieldObjects))for(const S of m)f.has(S.id)===l&&c.push(S)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,h=[];for(const f of c){const{id:m}=f;switch(h.push(m),f.type){case"text":{const x=f.defaultValue||"";u.setValue(m,{value:x});break}case"checkbox":case"radiobutton":{const x=f.defaultValue===f.exportValues;u.setValue(m,{value:x});break}case"combobox":case"listbox":{const x=f.defaultValue||"";u.setValue(m,{value:x});break}default:continue}const S=document.querySelector(`[data-element-id="${m}"]`);if(S){if(!Jl.has(S)){ae(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;S.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}as=new WeakSet,Ca=function(){this.container.setAttribute("data-internal-link","")},D_=function(t,s,i="",r=null){t.href=this.linkService.getAnchorUrl(""),s.description?t.title=s.description:i&&(t.title=i),t.onclick=()=>{var o;return(o=this.downloadManager)==null||o.openOrDownloadData(s.content,s.filename,r),!1},A(this,as,Ca).call(this)},I_=function(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),i&&(t.title=i),A(this,as,Ca).call(this)};class MR extends rt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class ic extends rt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Bt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,o=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(s,o=>{var l;if(s==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o)}}))})}_setEventListeners(e,t,s,i){var r,o,l;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,i),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":X.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||LR,r=e.style;let o;const l=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),h=Math.round(u/(Hv*i))||1,d=u/h;o=Math.min(i,c(d/Hv))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);o=Math.min(i,c(u/Hv))}r.fontSize=`calc(${o}px * var(--total-scale-factor))`,r.color=X.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class DR extends ic{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=s),r.setValue(o.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let l=o.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Jl.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:d,datetimeType:f,timeStep:m}=this.data,S=!!f&&this.enableScripting;d&&(s.title=d),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",C=>{e.setValue(t,{value:C.target.value}),this.setPropertyOnSiblings(s,"value",C.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",C=>{const y=this.data.defaultFieldValue??"";s.value=h.userValue=y,h.formattedValue=null});let x=C=>{const{formattedValue:y}=h;y!=null&&(C.target.value=y),C.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",y=>{var v;if(h.focused)return;const{target:w}=y;if(S&&(w.type=f,m&&(w.step=m)),h.userValue){const E=h.userValue;if(S)if(f==="time"){const _=new Date(E),k=[_.getHours(),_.getMinutes(),_.getSeconds()];w.value=k.map(T=>T.toString().padStart(2,"0")).join(":")}else w.value=new Date(E-NR).toISOString().split(f==="date"?"T":".",1)[0];else w.value=E}h.lastCommittedValue=w.value,h.commitKey=1,(v=this.data.actions)!=null&&v.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const w={value(v){h.userValue=v.detail.value??"",S||e.setValue(t,{value:h.userValue.toString()}),v.target.value=h.userValue},formattedValue(v){const{formattedValue:E}=v.detail;h.formattedValue=E,E!=null&&v.target!==document.activeElement&&(v.target.value=E);const _={formattedValue:E};S&&(_.value=E),e.setValue(t,_)},selRange(v){v.target.setSelectionRange(...v.detail.selRange)},charLimit:v=>{var T;const{charLimit:E}=v.detail,{target:_}=v;if(E===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",E);let k=h.userValue;!k||k.length<=E||(k=k.slice(0,E),_.value=h.userValue=k,e.setValue(t,{value:k}),(T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(w,y)}),s.addEventListener("keydown",y=>{var E;h.commitKey=1;let w=-1;if(y.key==="Escape"?w=0:y.key==="Enter"&&!this.data.multiLine?w=2:y.key==="Tab"&&(h.commitKey=3),w===-1)return;const{value:v}=y.target;h.lastCommittedValue!==v&&(h.lastCommittedValue=v,h.userValue=v,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:w,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const C=x;x=null,s.addEventListener("blur",y=>{var E,_;if(!h.focused||!y.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(h.focused=!1);const{target:w}=y;let{value:v}=w;if(S){if(v&&f==="time"){const k=v.split(":").map(T=>parseInt(T,10));v=new Date(2e3,0,1,k[0],k[1],k[2]||0).valueOf(),w.step=""}else v.includes("T")||(v=`${v}T00:00`),v=new Date(v).valueOf();w.type="text"}h.userValue=v,h.lastCommittedValue!==v&&((_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:h.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}})),C(y)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",y=>{var R;h.lastCommittedValue=null;const{data:w,target:v}=y,{value:E,selectionStart:_,selectionEnd:k}=v;let T=_,L=k;switch(y.inputType){case"deleteWordBackward":{const N=E.substring(0,_).match(/\w*[^\w]*$/);N&&(T-=N[0].length);break}case"deleteWordForward":{const N=E.substring(_).match(/^[^\w]*\w*/);N&&(L+=N[0].length);break}case"deleteContentBackward":_===k&&(T-=1);break;case"deleteContentForward":_===k&&(L+=1);break}y.preventDefault(),(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,change:w||"",willCommit:!1,selStart:T,selEnd:L}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(x&&s.addEventListener("blur",x),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class IR extends ic{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class FR extends ic{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Jl.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",o=>{const{name:l,checked:c}=o.target;for(const u of this._getElementsByName(l,s)){const h=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const l=t.defaultFieldValue||"Off";o.target.checked=l===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const l={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class F_ extends ic{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,s))e.setValue(o.id,{value:!1});const r=document.createElement("input");if(Jl.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",o=>{const{name:l,checked:c}=o.target;for(const u of this._getElementsByName(l,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const l=t.defaultFieldValue;o.target.checked=l!=null&&l===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;r.addEventListener("updatefromsandbox",l=>{const c={value:u=>{const h=o===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===s;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class jR extends L1{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class OR extends ic{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Jl.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),r=!1),i.append(d)}let o=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),i.prepend(h),o=()=>{h.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const l=h=>{const d=h?"value":"textContent",{options:f,multiple:m}=i;return m?Array.prototype.filter.call(f,S=>S.selected).map(S=>S[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=l(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",h=>{const d={value(f){o==null||o();const m=f.detail.value,S=new Set(Array.isArray(m)?m:[m]);for(const x of i.options)x.selected=S.has(x.value);e.setValue(t,{value:l(!0)}),c=l(!1)},multipleSelection(f){i.multiple=!0},remove(f){const m=i.options,S=f.detail.remove;m[S].selected=!1,i.remove(S),m.length>0&&Array.prototype.findIndex.call(m,C=>C.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:l(!0),items:u(f)}),c=l(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=l(!1)},insert(f){const{index:m,displayValue:S,exportValue:x}=f.detail.insert,C=i.children[m],y=document.createElement("option");y.textContent=S,y.value=x,C?C.before(y):i.append(y),e.setValue(t,{value:l(!0),items:u(f)}),c=l(!1)},items(f){const{items:m}=f.detail;for(;i.length!==0;)i.remove(0);for(const S of m){const{displayValue:x,exportValue:C}=S,y=document.createElement("option");y.textContent=x,y.value=C,i.append(y)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:l(!0),items:u(f)}),c=l(!1)},indices(f){const m=new Set(f.detail.indices);for(const S of f.target.options)S.selected=m.has(S.index);e.setValue(t,{value:l(!0)}),c=l(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),i.addEventListener("input",h=>{var m;const d=l(!0),f=l(!1);e.setValue(t,{value:d}),h.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):i.addEventListener("input",function(h){e.setValue(t,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var fp,Ow;class jw extends rt{constructor(t){const{data:s,elements:i,parent:r}=t,o=!!r._commentManager;super(t,{isRenderable:!o&&rt._hasPopupData(s)});b(this,fp);if(this.elements=i,o&&rt._hasPopupData(s)){const l=this.popup=A(this,fp,Ow).call(this);for(const c of i)c.popup=l}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const s=this.popup=A(this,fp,Ow).call(this),i=[];for(const r of this.elements)r.popup=s,r.container.ariaHasPopup="dialog",i.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(r=>`${S1}${r}`).join(",")),this.container}}fp=new WeakSet,Ow=function(){return new BR({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Xn,Mo,Ey,Cy,Uu,$u,ut,Li,Do,xl,Hu,Vu,Ni,qn,br,Ar,Nt,Er,Io,pp,Cr,Gu,Sl,Fo,on,jo,fe,am,Bw,zw,Uw,lm,$w,j_,O_,B_,z_,cm,um,Hw;class BR{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:o,richText:l,parent:c,rect:u,parentRect:h,open:d,commentManager:f=null}){b(this,fe);b(this,Xn,null);b(this,Mo,A(this,fe,B_).bind(this));b(this,Ey,A(this,fe,Hw).bind(this));b(this,Cy,A(this,fe,um).bind(this));b(this,Uu,A(this,fe,cm).bind(this));b(this,$u,null);b(this,ut,null);b(this,Li,null);b(this,Do,null);b(this,xl,null);b(this,Hu,null);b(this,Vu,null);b(this,Ni,!1);b(this,qn,null);b(this,br,null);b(this,Ar,null);b(this,Nt,null);b(this,Er,null);b(this,Io,null);b(this,pp,null);b(this,Cr,null);b(this,Gu,null);b(this,Sl,null);b(this,Fo,!1);b(this,on,null);b(this,jo,null);g(this,ut,e),g(this,Gu,i),g(this,Li,o),g(this,Cr,l),g(this,Hu,c),g(this,$u,t),g(this,pp,u),g(this,Vu,h),g(this,xl,s),g(this,Xn,f),g(this,on,s[0]),g(this,Do,nf.toDateObject(r)),this.trigger=s.flatMap(m=>m.getElementsToTriggerPopup()),f?this.renderCommentButton():(A(this,fe,am).call(this),a(this,ut).hidden=!0,d&&A(this,fe,cm).call(this))}renderCommentButton(){if(a(this,Nt)||(a(this,Er)||A(this,fe,Bw).call(this),!a(this,Er)))return;const{signal:e}=g(this,br,new AbortController),t=!!a(this,on).extraPopupElement,s=()=>{a(this,Xn).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{a(this,Xn).toggleCommentPopup(this,!1,!0,!t)},r=()=>{a(this,Xn).toggleCommentPopup(this,!1,!1)};if(t){g(this,Nt,a(this,on).container);for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",a(this,Mo),{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",r,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=g(this,Nt,document.createElement("button"));o.className="annotationCommentButton";const l=a(this,on).container;o.style.zIndex=l.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),A(this,fe,Uw).call(this),A(this,fe,zw).call(this),o.addEventListener("keydown",a(this,Mo),{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",r,{signal:e}),l.after(o)}}get commentButtonColor(){const{color:e,opacity:t}=a(this,on).commentData;return e?a(this,Hu)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=a(this,Nt))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}=a(this,on).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}}get elementBeforePopup(){return a(this,Nt)}get comment(){return a(this,jo)||g(this,jo,a(this,on).commentText),a(this,jo)}set comment(e){e!==this.comment&&(a(this,on).commentText=g(this,jo,e))}get parentBoundingClientRect(){return a(this,on).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){a(this,Nt)&&(a(this,Nt).classList.toggle("selected",e),a(this,Nt).ariaExpanded=t)}setSelectedCommentButton(e){a(this,Nt).classList.toggle("selected",e)}get commentPopupPosition(){if(a(this,Io))return a(this,Io);const{x:e,y:t,height:s}=a(this,Nt).getBoundingClientRect(),{x:i,y:r,width:o,height:l}=a(this,on).layer.getBoundingClientRect();return[(e-i)/o,(t+s-r)/l]}set commentPopupPosition(e){g(this,Io,e)}hasDefaultPopupPosition(){return a(this,Io)===null}get commentButtonPosition(){return a(this,Er)}get commentButtonWidth(){return a(this,Nt).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,s]=a(this,Io)||this.commentButtonPosition.map(u=>u/100),i=this.parentBoundingClientRect,{x:r,y:o,width:l,height:c}=i;a(this,Xn).showDialog(null,this,r+t*l,o+s*c,{...e,parentDimensions:i})}render(){var s,i;if(a(this,qn))return;const e=g(this,qn,document.createElement("div"));if(e.className="popup",a(this,$u)){const r=e.style.outlineColor=X.makeHexColor(...a(this,$u));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");if(t.className="header",(s=a(this,Gu))!=null&&s.str){const r=document.createElement("span");r.className="title",t.append(r),{dir:r.dir,str:r.textContent}=a(this,Gu)}if(e.append(t),a(this,Do)){const r=document.createElement("time");r.className="popupDate",r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:a(this,Do).valueOf()})),r.dateTime=a(this,Do).toISOString(),t.append(r)}A1({html:a(this,fe,lm)||a(this,Li).str,dir:(i=a(this,Li))==null?void 0:i.dir,className:"popupContent"},e),a(this,ut).append(e)}updateEdited({rect:e,popup:t,deleted:s}){var i;if(a(this,Xn)){s?(this.remove(),g(this,jo,null)):t&&(t.deleted?this.remove():(A(this,fe,Uw).call(this),g(this,jo,t.text))),e&&(g(this,Er,null),A(this,fe,Bw).call(this),A(this,fe,zw).call(this));return}if(s||t!=null&&t.deleted){this.remove();return}A(this,fe,am).call(this),a(this,Sl)||g(this,Sl,{contentsObj:a(this,Li),richText:a(this,Cr)}),e&&g(this,Ar,null),t&&t.text&&(g(this,Cr,A(this,fe,O_).call(this,t.text)),g(this,Do,nf.toDateObject(t.date)),g(this,Li,null)),(i=a(this,qn))==null||i.remove(),g(this,qn,null)}resetEdited(){var e;a(this,Sl)&&({contentsObj:At(this,Li)._,richText:At(this,Cr)._}=a(this,Sl),g(this,Sl,null),(e=a(this,qn))==null||e.remove(),g(this,qn,null),g(this,Ar,null))}remove(){var e,t,s;if((e=a(this,br))==null||e.abort(),g(this,br,null),(t=a(this,qn))==null||t.remove(),g(this,qn,null),g(this,Fo,!1),g(this,Ni,!1),(s=a(this,Nt))==null||s.remove(),g(this,Nt,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){g(this,Fo,this.isVisible),a(this,Fo)&&(a(this,ut).hidden=!0)}maybeShow(){a(this,Xn)||(A(this,fe,am).call(this),a(this,Fo)&&(a(this,qn)||A(this,fe,um).call(this),g(this,Fo,!1),a(this,ut).hidden=!1))}get isVisible(){return a(this,Xn)?!1:a(this,ut).hidden===!1}}Xn=new WeakMap,Mo=new WeakMap,Ey=new WeakMap,Cy=new WeakMap,Uu=new WeakMap,$u=new WeakMap,ut=new WeakMap,Li=new WeakMap,Do=new WeakMap,xl=new WeakMap,Hu=new WeakMap,Vu=new WeakMap,Ni=new WeakMap,qn=new WeakMap,br=new WeakMap,Ar=new WeakMap,Nt=new WeakMap,Er=new WeakMap,Io=new WeakMap,pp=new WeakMap,Cr=new WeakMap,Gu=new WeakMap,Sl=new WeakMap,Fo=new WeakMap,on=new WeakMap,jo=new WeakMap,fe=new WeakSet,am=function(){var t;if(a(this,br))return;g(this,br,new AbortController);const{signal:e}=a(this,br);for(const s of this.trigger)s.addEventListener("click",a(this,Uu),{signal:e}),s.addEventListener("pointerenter",a(this,Cy),{signal:e}),s.addEventListener("pointerleave",a(this,Ey),{signal:e}),s.classList.add("popupTriggerArea");for(const s of a(this,xl))(t=s.container)==null||t.addEventListener("keydown",a(this,Mo),{signal:e})},Bw=function(){const e=a(this,xl).find(t=>t.hasCommentButton);e&&g(this,Er,e._normalizePoint(e.commentButtonPosition))},zw=function(){if(a(this,on).extraPopupElement&&!a(this,on).editor)return;this.renderCommentButton();const[e,t]=a(this,Er),{style:s}=a(this,Nt);s.left=`calc(${e}%)`,s.top=`calc(${t}% - var(--comment-button-dim))`},Uw=function(){a(this,on).extraPopupElement||(this.renderCommentButton(),a(this,Nt).style.backgroundColor=this.commentButtonColor||"")},lm=function(){const e=a(this,Cr),t=a(this,Li);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&a(this,Cr).html||null},$w=function(){var e,t,s;return((s=(t=(e=a(this,fe,lm))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},j_=function(){var e,t,s;return((s=(t=(e=a(this,fe,lm))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},O_=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:a(this,fe,j_),fontSize:a(this,fe,$w)?`calc(${a(this,fe,$w)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},B_=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&a(this,Ni))&&A(this,fe,cm).call(this)},z_=function(){if(a(this,Ar)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=a(this,Hu);let o=!!a(this,Vu),l=o?a(this,Vu):a(this,pp);for(const S of a(this,xl))if(!l||X.intersect(S.data.rect,l)!==null){l=S.data.rect,o=!0;break}const c=X.normalizeRect([l[0],e[3]-l[1]+e[1],l[2],e[3]-l[3]+e[1]]),h=o?l[2]-l[0]+5:0,d=c[0]+h,f=c[1];g(this,Ar,[100*(d-i)/t,100*(f-r)/s]);const{style:m}=a(this,ut);m.left=`${a(this,Ar)[0]}%`,m.top=`${a(this,Ar)[1]}%`},cm=function(){if(a(this,Xn)){a(this,Xn).toggleCommentPopup(this,!1);return}g(this,Ni,!a(this,Ni)),a(this,Ni)?(A(this,fe,um).call(this),a(this,ut).addEventListener("click",a(this,Uu)),a(this,ut).addEventListener("keydown",a(this,Mo))):(A(this,fe,Hw).call(this),a(this,ut).removeEventListener("click",a(this,Uu)),a(this,ut).removeEventListener("keydown",a(this,Mo)))},um=function(){a(this,qn)||this.render(),this.isVisible?a(this,Ni)&&a(this,ut).classList.add("focused"):(A(this,fe,z_).call(this),a(this,ut).hidden=!1,a(this,ut).style.zIndex=parseInt(a(this,ut).style.zIndex)+1e3)},Hw=function(){a(this,ut).classList.remove("focused"),!(a(this,Ni)||!this.isVisible)&&(a(this,ut).hidden=!0,a(this,ut).style.zIndex=parseInt(a(this,ut).style.zIndex)-1e3)};class U_ extends rt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=oe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var gp;class zR extends rt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,gp,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=g(this,gp,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,gp)}addHighlightArea(){this.container.classList.add("highlightArea")}}gp=new WeakMap;var mp;class UR extends rt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,mp,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,l=g(this,mp,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",s-o),l.setAttribute("height",i-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,mp)}addHighlightArea(){this.container.classList.add("highlightArea")}}mp=new WeakMap;var yp;class $R extends rt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,yp,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,l=g(this,yp,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",s/2),l.setAttribute("cy",i/2),l.setAttribute("rx",s/2-o/2),l.setAttribute("ry",i/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,yp)}addHighlightArea(){this.container.classList.add("highlightArea")}}yp=new WeakMap;var vp;class $_ extends rt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,vp,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r},width:o,height:l}=this;if(!s)return this.container;const c=this.svgFactory.create(o,l,!0);let u=[];for(let d=0,f=s.length;d<f;d+=2){const m=s[d]-t[0],S=t[3]-s[d+1];u.push(`${m},${S}`)}u=u.join(" ");const h=g(this,vp,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return a(this,vp)}addHighlightArea(){this.container.classList.add("highlightArea")}}vp=new WeakMap;class HR extends $_{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class VR extends rt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var wp,bl,xp,Vw;class N1 extends rt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,xp);b(this,wp,null);b(this,bl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?oe.HIGHLIGHT:oe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:o}}=this,{transform:l,width:c,height:u}=A(this,xp,Vw).call(this,s,t),h=this.svgFactory.create(c,u,!0),d=g(this,wp,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",l);for(let f=0,m=i.length;f<m;f++){const S=this.svgFactory.createElement(this.svgElementName);a(this,bl).push(S),S.setAttribute("points",i[f].join(",")),d.append(S)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,o=a(this,wp);if(s>=0&&o.setAttribute("stroke-width",s||1),i)for(let l=0,c=a(this,bl).length;l<c;l++)a(this,bl)[l].setAttribute("points",i[l].join(","));if(r){const{transform:l,width:c,height:u}=A(this,xp,Vw).call(this,this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return a(this,bl)}addHighlightArea(){this.container.classList.add("highlightArea")}}wp=new WeakMap,bl=new WeakMap,xp=new WeakSet,Vw=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class H_ extends rt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=oe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class GR extends rt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class WR extends rt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class XR extends rt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class V_ extends rt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=oe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Sp,bp,Gw;class qR extends rt{constructor(t){var i;super(t,{isRenderable:!0});b(this,bp);b(this,Sp,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",A(this,bp,Gw).bind(this)),g(this,Sp,i);const{isMac:r}=Bt.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&A(this,bp,Gw).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return a(this,Sp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sp=new WeakMap,bp=new WeakSet,Gw=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Wu,Al,Xu,Oo,Ap,El,ya,Ww,Xw,qu;let R1=(qu=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:o,structTreeLayer:l,commentManager:c,linkService:u,annotationStorage:h}){b(this,ya);b(this,Wu,null);b(this,Al,null);b(this,Xu,null);b(this,Oo,new Map);b(this,Ap,null);b(this,El,null);this.div=e,g(this,Wu,t),g(this,Al,s),g(this,Ap,l||null),g(this,El,u||null),g(this,Xu,h||new E1),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=c||null}hasEditableAnnotations(){return a(this,Oo).size>0}async render(e){var o,l,c;const{annotations:t}=e,s=this.div;pa(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:a(this,El),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new af,annotationStorage:a(this,Xu),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const u of t){if(u.noHTML)continue;const h=u.annotationType===pt.POPUP;if(h){const m=i.get(u.id);if(!m)continue;r.elements=m}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;r.data=u;const d=Nb.create(r);if(!d.isRenderable)continue;if(!h&&u.popupRef){const m=i.get(u.popupRef);m?m.push(d):i.set(u.popupRef,[d])}const f=d.render();u.hidden&&(f.style.visibility="hidden"),await A(this,ya,Ww).call(this,f,u.id,r.elements),(l=(o=d.extraPopupElement)==null?void 0:o.popup)==null||l.renderCommentButton(),d._isEditable&&(a(this,Oo).set(d.data.id,d),(c=this._annotationEditorUIManager)==null||c.renderAnnotationElement(d))}A(this,ya,Xw).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:a(this,El),svgFactory:new af,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=qu._defaultBorderStyle),t.data=s;const i=Nb.create(t);if(!i.isRenderable)continue;const r=i.render();await A(this,ya,Ww).call(this,r,s.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,pa(t,{rotation:e.rotation}),A(this,ya,Xw).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(a(this,Oo).values())}getEditableAnnotation(e){return a(this,Oo).get(e)}addFakeAnnotation(e){var l;const{div:t}=this,{id:s,rotation:i}=e,r=new RR({data:{id:s,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:a(this,El),annotationStorage:a(this,Xu)}),o=r.render();return t.append(o),(l=a(this,Wu))==null||l.moveElementInDOM(t,o,o,!1),r.createOrUpdatePopup(),r}static get _defaultBorderStyle(){return he(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:cc.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},Wu=new WeakMap,Al=new WeakMap,Xu=new WeakMap,Oo=new WeakMap,Ap=new WeakMap,El=new WeakMap,ya=new WeakSet,Ww=async function(e,t,s){var l,c;const i=e.firstChild||e,r=i.id=`${S1}${t}`,o=await((l=a(this,Ap))==null?void 0:l.getAriaAttributes(r));if(o)for(const[u,h]of o)i.setAttribute(u,h);s?s.at(-1).container.after(e):(this.div.append(e),(c=a(this,Wu))==null||c.moveElementInDOM(this.div,e,i,!1))},Xw=function(){var t;if(!a(this,Al))return;const e=this.div;for(const[s,i]of a(this,Al)){const r=e.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:o}=r;o?o.nodeName==="CANVAS"?o.replaceWith(i):o.classList.contains("annotationContent")?o.after(i):o.before(i):r.append(i);const l=a(this,Oo).get(s);l&&(l._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,r.id,i),l._hasNoCanvas=!1):l.canvas=i)}a(this,Al).clear()},qu);const Mg=/\r\n?|\n/g;var Yn,Ep,Cl,Kn,bt,G_,W_,X_,hm,jr,dm,fm,q_,Yw,Y_;const We=class We extends He{constructor(t){super({...t,name:"freeTextEditor"});b(this,bt);b(this,Yn,"");b(this,Ep,`${this.id}-editor`);b(this,Cl,null);b(this,Kn);F(this,"_colorPicker",null);this.color=t.color||We._defaultColor||He._defaultLineColor,g(this,Kn,t.fontSize||We._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=We.prototype,s=o=>o.isEmpty(),i=ga.TRANSLATE_SMALL,r=ga.TRANSLATE_BIG;return he(this,"_keyboardManager",new Zp([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){He.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case me.FREETEXT_SIZE:We._defaultFontSize=s;break;case me.FREETEXT_COLOR:We._defaultColor=s;break}}updateParams(t,s){switch(t){case me.FREETEXT_SIZE:A(this,bt,G_).call(this,s);break;case me.FREETEXT_COLOR:A(this,bt,W_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[me.FREETEXT_SIZE,We._defaultFontSize],[me.FREETEXT_COLOR,We._defaultColor||He._defaultLineColor]]}get propertiesToUpdate(){return[[me.FREETEXT_SIZE,a(this,Kn)],[me.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new oy(this)),[["colorPicker",this._colorPicker]]}get colorType(){return me.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-We._internalPadding*t,-(We._internalPadding+a(this,Kn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),g(this,Cl,new AbortController);const t=this._uiManager.combinedSignal(a(this,Cl));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",a(this,Ep)),this._isDraggable=!0,(t=a(this,Cl))==null||t.abort(),g(this,Cl,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=a(this,Yn),s=g(this,Yn,A(this,bt,X_).call(this).trimEnd());if(t===s)return;const i=r=>{if(g(this,Yn,r),!r){this.remove();return}A(this,bt,fm).call(this),this._uiManager.rebuild(this),A(this,bt,hm).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),A(this,bt,hm).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){We._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",a(this,Ep)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${a(this,Kn)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,d]=this.pageDimensions,[f,m]=this.pageTranslation;let S,x;switch(this.rotation){case 0:S=t+(l[0]-f)/h,x=s+this.height-(l[1]-m)/d;break;case 90:S=t+(l[0]-f)/h,x=s-(l[1]-m)/d,[c,u]=[u,-c];break;case 180:S=t-this.width+(l[0]-f)/h,x=s-(l[1]-m)/d,[c,u]=[-c,-u];break;case 270:S=t+(l[0]-f-this.height*d)/h,x=s+(l[1]-m-this.width*h)/d,[c,u]=[-u,c];break}this.setAt(S*r,x*o,c,u)}else this._moveAfterPaste(t,s);A(this,bt,fm).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var S,x,C;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=A(S=We,jr,Yw).call(S,s.getData("text")||"").replaceAll(Mg,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!r.includes(`
`)){l.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:u}=l,h=[],d=[];if(c.nodeType===Node.TEXT_NODE){const y=c.parentElement;if(d.push(c.nodeValue.slice(u).replaceAll(Mg,"")),y!==this.editorDiv){let w=h;for(const v of this.editorDiv.childNodes){if(v===y){w=d;continue}w.push(A(x=We,jr,dm).call(x,v))}}h.push(c.nodeValue.slice(0,u).replaceAll(Mg,""))}else if(c===this.editorDiv){let y=h,w=0;for(const v of this.editorDiv.childNodes)w++===u&&(y=d),y.push(A(C=We,jr,dm).call(C,v))}g(this,Yn,`${h.join(`
`)}${r}${d.join(`
`)}`),A(this,bt,fm).call(this);const f=new Range;let m=Math.sumPrecise(h.map(y=>y.length));for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const w=y.nodeValue.length;if(m<=w){f.setStart(y,m),f.setEnd(y,m);break}m-=w}o.removeAllRanges(),o.addRange(f)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=We._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,s,i){var l;let r=null;if(t instanceof U_){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:d,id:f,popupRef:m,richText:S,contentsObj:x,creationDate:C,modificationDate:y},textContent:w,textPosition:v,parent:{page:{pageNumber:E}}}=t;if(!w||w.length===0)return null;r=t={annotationType:oe.FREETEXT,color:Array.from(u),fontSize:c,value:w.join(`
`),position:v,pageIndex:E-1,rect:h.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:m,comment:(x==null?void 0:x.str)||null,richText:S,creationDate:C,modificationDate:y}}const o=await super.deserialize(t,s,i);return g(o,Kn,t.fontSize),o.color=X.makeHexColor(...t.color),g(o,Yn,A(l=We,jr,Yw).call(l,t.value)),o._initialData=r,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=He._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:s,fontSize:a(this,Kn),value:A(this,bt,q_).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!A(this,bt,Y_).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(!s)return null;const{style:i}=s;i.fontSize=`calc(${a(this,Kn)}px * var(--total-scale-factor))`,i.color=this.color,s.replaceChildren();for(const r of a(this,Yn).split(`
`)){const o=document.createElement("div");o.append(r?document.createTextNode(r):document.createElement("br")),s.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:a(this,Yn)}}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Yn=new WeakMap,Ep=new WeakMap,Cl=new WeakMap,Kn=new WeakMap,bt=new WeakSet,G_=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-a(this,Kn))*this.parentScale),g(this,Kn,r),A(this,bt,hm).call(this)},i=a(this,Kn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:me.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},W_=function(t){const s=r=>{this.color=r,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:me.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},X_=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(A(i=We,jr,dm).call(i,r)),s=r);return t.join(`
`)},hm=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,l=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},jr=new WeakSet,dm=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Mg,"")},fm=function(){if(this.editorDiv.replaceChildren(),!!a(this,Yn))for(const t of a(this,Yn).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},q_=function(){return a(this,Yn).replaceAll(""," ")},Yw=function(t){return t.replaceAll(" ","")},Y_=function(t){const{value:s,fontSize:i,color:r,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((l,c)=>l!==r[c])||t.pageIndex!==o},b(We,jr),F(We,"_freeTextDefaultContent",""),F(We,"_internalPadding",0),F(We,"_defaultColor",null),F(We,"_defaultFontSize",10),F(We,"_type","freetext"),F(We,"_editorType",oe.FREETEXT);let qw=We;class W{toSVGPath(){ze("Abstract method `toSVGPath` must be implemented.")}get box(){ze("Abstract getter `box` must be implemented.")}serialize(e,t){ze("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)o[l]=t+e[l]*i,o[l+1]=s+e[l+1]*r;return o}static _rescaleAndSwap(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)o[l]=t+e[l+1]*i,o[l+1]=s+e[l]*r;return o}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,o){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+o)/6,(s+r)/2,(i+o)/2]}}F(W,"PRECISION",1e-4);var Qn,Qs,Yu,Ku,Ri,pe,_l,kl,Cp,_p,Qu,Ju,Bo,kp,_y,ky,Pt,yd,K_,Q_,J_,Z_,ek,tk;const Qi=class Qi{constructor({x:e,y:t},s,i,r,o,l=0){b(this,Pt);b(this,Qn);b(this,Qs,[]);b(this,Yu);b(this,Ku);b(this,Ri,[]);b(this,pe,new Float32Array(18));b(this,_l);b(this,kl);b(this,Cp);b(this,_p);b(this,Qu);b(this,Ju);b(this,Bo,[]);g(this,Qn,s),g(this,Ju,r*i),g(this,Ku,o),a(this,pe).set([NaN,NaN,NaN,NaN,e,t],6),g(this,Yu,l),g(this,_p,a(Qi,kp)*i),g(this,Cp,a(Qi,ky)*i),g(this,Qu,i),a(this,Bo).push(e,t)}isEmpty(){return isNaN(a(this,pe)[8])}add({x:e,y:t}){var R;g(this,_l,e),g(this,kl,t);const[s,i,r,o]=a(this,Qn);let[l,c,u,h]=a(this,pe).subarray(8,12);const d=e-u,f=t-h,m=Math.hypot(d,f);if(m<a(this,Cp))return!1;const S=m-a(this,_p),x=S/m,C=x*d,y=x*f;let w=l,v=c;l=u,c=h,u+=C,h+=y,(R=a(this,Bo))==null||R.push(e,t);const E=-y/S,_=C/S,k=E*a(this,Ju),T=_*a(this,Ju);return a(this,pe).set(a(this,pe).subarray(2,8),0),a(this,pe).set([u+k,h+T],4),a(this,pe).set(a(this,pe).subarray(14,18),12),a(this,pe).set([u-k,h-T],16),isNaN(a(this,pe)[6])?(a(this,Ri).length===0&&(a(this,pe).set([l+k,c+T],2),a(this,Ri).push(NaN,NaN,NaN,NaN,(l+k-s)/r,(c+T-i)/o),a(this,pe).set([l-k,c-T],14),a(this,Qs).push(NaN,NaN,NaN,NaN,(l-k-s)/r,(c-T-i)/o)),a(this,pe).set([w,v,l,c,u,h],6),!this.isEmpty()):(a(this,pe).set([w,v,l,c,u,h],6),Math.abs(Math.atan2(v-c,w-l)-Math.atan2(y,C))<Math.PI/2?([l,c,u,h]=a(this,pe).subarray(2,6),a(this,Ri).push(NaN,NaN,NaN,NaN,((l+u)/2-s)/r,((c+h)/2-i)/o),[l,c,w,v]=a(this,pe).subarray(14,18),a(this,Qs).push(NaN,NaN,NaN,NaN,((w+l)/2-s)/r,((v+c)/2-i)/o),!0):([w,v,l,c,u,h]=a(this,pe).subarray(0,6),a(this,Ri).push(((w+5*l)/6-s)/r,((v+5*c)/6-i)/o,((5*l+u)/6-s)/r,((5*c+h)/6-i)/o,((l+u)/2-s)/r,((c+h)/2-i)/o),[u,h,l,c,w,v]=a(this,pe).subarray(12,18),a(this,Qs).push(((w+5*l)/6-s)/r,((v+5*c)/6-i)/o,((5*l+u)/6-s)/r,((5*c+h)/6-i)/o,((l+u)/2-s)/r,((c+h)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=a(this,Ri),t=a(this,Qs);if(isNaN(a(this,pe)[6])&&!this.isEmpty())return A(this,Pt,K_).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);A(this,Pt,J_).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return A(this,Pt,Q_).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,o){return new nk(e,t,s,i,r,o)}getOutlines(){var d;const e=a(this,Ri),t=a(this,Qs),s=a(this,pe),[i,r,o,l]=a(this,Qn),c=new Float32Array((((d=a(this,Bo))==null?void 0:d.length)??0)+2);for(let f=0,m=c.length-2;f<m;f+=2)c[f]=(a(this,Bo)[f]-i)/o,c[f+1]=(a(this,Bo)[f+1]-r)/l;if(c[c.length-2]=(a(this,_l)-i)/o,c[c.length-1]=(a(this,kl)-r)/l,isNaN(s[6])&&!this.isEmpty())return A(this,Pt,Z_).call(this,c);const u=new Float32Array(a(this,Ri).length+24+a(this,Qs).length);let h=e.length;for(let f=0;f<h;f+=2){if(isNaN(e[f])){u[f]=u[f+1]=NaN;continue}u[f]=e[f],u[f+1]=e[f+1]}h=A(this,Pt,tk).call(this,u,h);for(let f=t.length-6;f>=6;f-=6)for(let m=0;m<6;m+=2){if(isNaN(t[f+m])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[f+m],u[h+1]=t[f+m+1],h+=2}return A(this,Pt,ek).call(this,u,h),this.newFreeDrawOutline(u,c,a(this,Qn),a(this,Qu),a(this,Yu),a(this,Ku))}};Qn=new WeakMap,Qs=new WeakMap,Yu=new WeakMap,Ku=new WeakMap,Ri=new WeakMap,pe=new WeakMap,_l=new WeakMap,kl=new WeakMap,Cp=new WeakMap,_p=new WeakMap,Qu=new WeakMap,Ju=new WeakMap,Bo=new WeakMap,kp=new WeakMap,_y=new WeakMap,ky=new WeakMap,Pt=new WeakSet,yd=function(){const e=a(this,pe).subarray(4,6),t=a(this,pe).subarray(16,18),[s,i,r,o]=a(this,Qn);return[(a(this,_l)+(e[0]-t[0])/2-s)/r,(a(this,kl)+(e[1]-t[1])/2-i)/o,(a(this,_l)+(t[0]-e[0])/2-s)/r,(a(this,kl)+(t[1]-e[1])/2-i)/o]},K_=function(){const[e,t,s,i]=a(this,Qn),[r,o,l,c]=A(this,Pt,yd).call(this);return`M${(a(this,pe)[2]-e)/s} ${(a(this,pe)[3]-t)/i} L${(a(this,pe)[4]-e)/s} ${(a(this,pe)[5]-t)/i} L${r} ${o} L${l} ${c} L${(a(this,pe)[16]-e)/s} ${(a(this,pe)[17]-t)/i} L${(a(this,pe)[14]-e)/s} ${(a(this,pe)[15]-t)/i} Z`},Q_=function(e){const t=a(this,Qs);e.push(`L${t[4]} ${t[5]} Z`)},J_=function(e){const[t,s,i,r]=a(this,Qn),o=a(this,pe).subarray(4,6),l=a(this,pe).subarray(16,18),[c,u,h,d]=A(this,Pt,yd).call(this);e.push(`L${(o[0]-t)/i} ${(o[1]-s)/r} L${c} ${u} L${h} ${d} L${(l[0]-t)/i} ${(l[1]-s)/r}`)},Z_=function(e){const t=a(this,pe),[s,i,r,o]=a(this,Qn),[l,c,u,h]=A(this,Pt,yd).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/o],0),this.newFreeDrawOutline(d,e,a(this,Qn),a(this,Qu),a(this,Yu),a(this,Ku))},ek=function(e,t){const s=a(this,Qs);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},tk=function(e,t){const s=a(this,pe).subarray(4,6),i=a(this,pe).subarray(16,18),[r,o,l,c]=a(this,Qn),[u,h,d,f]=A(this,Pt,yd).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/l,(s[1]-o)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(i[0]-r)/l,(i[1]-o)/c],t),t+=24},b(Qi,kp,8),b(Qi,_y,2),b(Qi,ky,a(Qi,kp)+a(Qi,_y));let ay=Qi;var Zu,Tl,_r,Tp,Jn,Pp,mt,Ty,sk;class nk extends W{constructor(t,s,i,r,o,l){super();b(this,Ty);b(this,Zu);b(this,Tl,new Float32Array(4));b(this,_r);b(this,Tp);b(this,Jn);b(this,Pp);b(this,mt);g(this,mt,t),g(this,Jn,s),g(this,Zu,i),g(this,Pp,r),g(this,_r,o),g(this,Tp,l),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],A(this,Ty,sk).call(this,l);const[c,u,h,d]=a(this,Tl);for(let f=0,m=t.length;f<m;f+=2)t[f]=(t[f]-c)/h,t[f+1]=(t[f+1]-u)/d;for(let f=0,m=s.length;f<m;f+=2)s[f]=(s[f]-c)/h,s[f+1]=(s[f+1]-u)/d}toSVGPath(){const t=[`M${a(this,mt)[4]} ${a(this,mt)[5]}`];for(let s=6,i=a(this,mt).length;s<i;s+=6){if(isNaN(a(this,mt)[s])){t.push(`L${a(this,mt)[s+4]} ${a(this,mt)[s+5]}`);continue}t.push(`C${a(this,mt)[s]} ${a(this,mt)[s+1]} ${a(this,mt)[s+2]} ${a(this,mt)[s+3]} ${a(this,mt)[s+4]} ${a(this,mt)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],o){const l=i-t,c=r-s;let u,h;switch(o){case 0:u=W._rescale(a(this,mt),t,r,l,-c),h=W._rescale(a(this,Jn),t,r,l,-c);break;case 90:u=W._rescaleAndSwap(a(this,mt),t,s,l,c),h=W._rescaleAndSwap(a(this,Jn),t,s,l,c);break;case 180:u=W._rescale(a(this,mt),i,s,-l,c),h=W._rescale(a(this,Jn),i,s,-l,c);break;case 270:u=W._rescaleAndSwap(a(this,mt),i,r,-l,-c),h=W._rescaleAndSwap(a(this,Jn),i,r,-l,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return a(this,Tl)}newOutliner(t,s,i,r,o,l=0){return new ay(t,s,i,r,o,l)}getNewOutline(t,s){const[i,r,o,l]=a(this,Tl),[c,u,h,d]=a(this,Zu),f=o*h,m=l*d,S=i*h+c,x=r*d+u,C=this.newOutliner({x:a(this,Jn)[0]*f+S,y:a(this,Jn)[1]*m+x},a(this,Zu),a(this,Pp),t,a(this,Tp),s??a(this,_r));for(let y=2;y<a(this,Jn).length;y+=2)C.add({x:a(this,Jn)[y]*f+S,y:a(this,Jn)[y+1]*m+x});return C.getOutlines()}}Zu=new WeakMap,Tl=new WeakMap,_r=new WeakMap,Tp=new WeakMap,Jn=new WeakMap,Pp=new WeakMap,mt=new WeakMap,Ty=new WeakSet,sk=function(t){const s=a(this,mt);let i=s[4],r=s[5];const o=[i,r,i,r];let l=i,c=r,u=i,h=r;const d=t?Math.max:Math.min,f=new Float32Array(4);for(let S=6,x=s.length;S<x;S+=6){const C=s[S+4],y=s[S+5];isNaN(s[S])?(X.pointBoundingBox(C,y,o),c>y?(l=C,c=y):c===y&&(l=d(l,C)),h<y?(u=C,h=y):h===y&&(u=d(u,C))):(f[0]=f[1]=1/0,f[2]=f[3]=-1/0,X.bezierBoundingBox(i,r,...s.slice(S,S+6),f),X.rectBoundingBox(f[0],f[1],f[2],f[3],o),c>f[1]?(l=f[0],c=f[1]):c===f[1]&&(l=d(l,f[0])),h<f[3]?(u=f[2],h=f[3]):h===f[3]&&(u=d(u,f[2]))),i=C,r=y}const m=a(this,Tl);m[0]=o[0]-a(this,_r),m[1]=o[1]-a(this,_r),m[2]=o[2]-o[0]+2*a(this,_r),m[3]=o[3]-o[1]+2*a(this,_r),this.firstPoint=[l,c],this.lastPoint=[u,h]};var Lp,Np,Rp,zo,Js,bn,ik,pm,rk,ok,Qw;class Kw{constructor(e,t=0,s=0,i=!0){b(this,bn);b(this,Lp);b(this,Np);b(this,Rp);b(this,zo,[]);b(this,Js,[]);const r=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x,y:C,width:y,height:w}of e){const v=Math.floor((x-t)/o)*o,E=Math.ceil((x+y+t)/o)*o,_=Math.floor((C-t)/o)*o,k=Math.ceil((C+w+t)/o)*o,T=[v,_,k,!0],L=[E,_,k,!1];a(this,zo).push(T,L),X.rectBoundingBox(v,_,E,k,r)}const l=r[2]-r[0]+2*s,c=r[3]-r[1]+2*s,u=r[0]-s,h=r[1]-s;let d=i?-1/0:1/0,f=1/0;const m=a(this,zo).at(i?-1:-2),S=[m[0],m[2]];for(const x of a(this,zo)){const[C,y,w,v]=x;!v&&i?y<f?(f=y,d=C):y===f&&(d=Math.max(d,C)):v&&!i&&(y<f?(f=y,d=C):y===f&&(d=Math.min(d,C))),x[0]=(C-u)/l,x[1]=(y-h)/c,x[2]=(w-h)/c}g(this,Lp,new Float32Array([u,h,l,c])),g(this,Np,[d,f]),g(this,Rp,S)}getOutlines(){a(this,zo).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of a(this,zo))t[3]?(e.push(...A(this,bn,Qw).call(this,t)),A(this,bn,rk).call(this,t)):(A(this,bn,ok).call(this,t),e.push(...A(this,bn,Qw).call(this,t)));return A(this,bn,ik).call(this,e)}}Lp=new WeakMap,Np=new WeakMap,Rp=new WeakMap,zo=new WeakMap,Js=new WeakMap,bn=new WeakSet,ik=function(e){const t=[],s=new Set;for(const o of e){const[l,c,u]=o;t.push([l,c,o],[l,u,o])}t.sort((o,l)=>o[1]-l[1]||o[0]-l[0]);for(let o=0,l=t.length;o<l;o+=2){const c=t[o][2],u=t[o+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const i=[];let r;for(;s.size>0;){const o=s.values().next().value;let[l,c,u,h,d]=o;s.delete(o);let f=l,m=c;for(r=[l,u],i.push(r);;){let S;if(s.has(h))S=h;else if(s.has(d))S=d;else break;s.delete(S),[l,c,u,h,d]=S,f!==l&&(r.push(f,m,l,m===c?c:u),f=l),m=m===c?u:c}r.push(f,m)}return new YR(i,a(this,Lp),a(this,Np),a(this,Rp))},pm=function(e){const t=a(this,Js);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,o=t[r][0];if(o===e)return r;o<e?s=r+1:i=r-1}return i+1},rk=function([,e,t]){const s=A(this,bn,pm).call(this,e);a(this,Js).splice(s,0,[e,t])},ok=function([,e,t]){const s=A(this,bn,pm).call(this,e);for(let i=s;i<a(this,Js).length;i++){const[r,o]=a(this,Js)[i];if(r!==e)break;if(r===e&&o===t){a(this,Js).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,o]=a(this,Js)[i];if(r!==e)break;if(r===e&&o===t){a(this,Js).splice(i,1);return}}},Qw=function(e){const[t,s,i]=e,r=[[t,s,i]],o=A(this,bn,pm).call(this,i);for(let l=0;l<o;l++){const[c,u]=a(this,Js)[l];for(let h=0,d=r.length;h<d;h++){const[,f,m]=r[h];if(!(u<=f||m<=c)){if(f>=c){if(m>u)r[h][1]=u;else{if(d===1)return[];r.splice(h,1),h--,d--}continue}r[h][2]=c,m>u&&r.push([t,u,m])}}}return r};var Mp,eh;class YR extends W{constructor(t,s,i,r){super();b(this,Mp);b(this,eh);g(this,eh,t),g(this,Mp,s),this.firstPoint=i,this.lastPoint=r}toSVGPath(){const t=[];for(const s of a(this,eh)){let[i,r]=s;t.push(`M${i} ${r}`);for(let o=2;o<s.length;o+=2){const l=s[o],c=s[o+1];l===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${l}`),i=l)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],o){const l=[],c=i-t,u=r-s;for(const h of a(this,eh)){const d=new Array(h.length);for(let f=0;f<h.length;f+=2)d[f]=t+h[f]*c,d[f+1]=r-h[f+1]*u;l.push(d)}return l}get box(){return a(this,Mp)}get classNamesForOutlining(){return["highlightOutline"]}}Mp=new WeakMap,eh=new WeakMap;class Jw extends ay{newFreeDrawOutline(e,t,s,i,r,o){return new KR(e,t,s,i,r,o)}}class KR extends nk{newOutliner(e,t,s,i,r,o=0){return new Jw(e,t,s,i,r,o)}}var th,Dp,kr,Pl,Ip,Rn,Fp,jp,Ll,Zn,es,Vt,nh,sh,an,ih,_s,Op,de,Zw,gm,ak,lk,ck,ex,_a,Ns,gc,uk,mm,ym,hk,dk,fk,pk,gk;const Ce=class Ce extends He{constructor(t){super({...t,name:"highlightEditor"});b(this,de);b(this,th,null);b(this,Dp,0);b(this,kr);b(this,Pl,null);b(this,Ip,null);b(this,Rn,null);b(this,Fp,null);b(this,jp,0);b(this,Ll,null);b(this,Zn,null);b(this,es,null);b(this,Vt,!1);b(this,nh,null);b(this,sh,null);b(this,an,null);b(this,ih,"");b(this,_s);b(this,Op,"");this.color=t.color||Ce._defaultColor,g(this,_s,t.thickness||Ce._defaultThickness),this.opacity=t.opacity||Ce._defaultOpacity,g(this,kr,t.boxes||null),g(this,Op,t.methodOfCreation||""),g(this,ih,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(g(this,Vt,!0),A(this,de,gm).call(this,t),A(this,de,_a).call(this)):a(this,kr)&&(g(this,th,t.anchorNode),g(this,Dp,t.anchorOffset),g(this,Fp,t.focusNode),g(this,jp,t.focusOffset),A(this,de,Zw).call(this),A(this,de,_a).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Ce.prototype;return he(this,"_keyboardManager",new Zp([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:a(this,Vt)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:a(this,_s),methodOfCreation:a(this,Op)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;He.initialize(t,s),Ce._defaultColor||(Ce._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case me.HIGHLIGHT_COLOR:Ce._defaultColor=s;break;case me.HIGHLIGHT_THICKNESS:Ce._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return a(this,sh)}get commentButtonPosition(){return a(this,nh)}updateParams(t,s){switch(t){case me.HIGHLIGHT_COLOR:A(this,de,ak).call(this,s);break;case me.HIGHLIGHT_THICKNESS:A(this,de,lk).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[me.HIGHLIGHT_COLOR,Ce._defaultColor],[me.HIGHLIGHT_THICKNESS,Ce._defaultThickness]]}get propertiesToUpdate(){return[[me.HIGHLIGHT_COLOR,this.color||Ce._defaultColor],[me.HIGHLIGHT_THICKNESS,a(this,_s)||Ce._defaultThickness],[me.HIGHLIGHT_FREE,a(this,Vt)]]}onUpdatedColor(){var t,s;(t=this.parent)==null||t.drawLayer.updateProperties(a(this,es),{root:{fill:this.color,"fill-opacity":this.opacity}}),(s=a(this,Ip))==null||s.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",g(this,Ip,new of({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,de,ym).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,A(this,de,ym).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){A(this,de,ex).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,de,_a).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?A(this,de,ex).call(this):t&&(A(this,de,_a).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,o,l;const{drawLayer:s}=this.parent;let i;a(this,Vt)?(t=(t-this.rotation+360)%360,i=A(r=Ce,Ns,gc).call(r,a(this,Zn).box,t)):i=A(o=Ce,Ns,gc).call(o,[this.x,this.y,this.width,this.height],t),s.updateProperties(a(this,es),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(a(this,an),{bbox:A(l=Ce,Ns,gc).call(l,a(this,Rn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();a(this,ih)&&(t.setAttribute("aria-label",a(this,ih)),t.setAttribute("role","mark")),a(this,Vt)?t.classList.add("free"):this.div.addEventListener("keydown",A(this,de,uk).bind(this),{signal:this._uiManager._signal});const s=g(this,Ll,document.createElement("div"));return t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=a(this,Pl),this.setDims(this.width,this.height),FC(this,a(this,Ll),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(a(this,an),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(a(this,an),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:A(this,de,mm).call(this,!0);break;case 1:case 3:A(this,de,mm).call(this,!1);break}}select(){var t;super.select(),a(this,an)&&((t=this.parent)==null||t.drawLayer.updateProperties(a(this,an),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),a(this,an)&&((t=this.parent)==null||t.drawLayer.updateProperties(a(this,an),{rootClass:{selected:!1}}),a(this,Vt)||A(this,de,mm).call(this,!1))}get _mustFixPosition(){return!a(this,Vt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(a(this,es),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(a(this,an),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:o}){const{x:l,y:c,width:u,height:h}=i.getBoundingClientRect(),d=new AbortController,f=t.combinedSignal(d),m=S=>{d.abort(),A(this,Ns,pk).call(this,t,S)};window.addEventListener("blur",m,{signal:f}),window.addEventListener("pointerup",m,{signal:f}),window.addEventListener("pointerdown",tt,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",ds,{signal:f}),i.addEventListener("pointermove",A(this,Ns,fk).bind(this,t),{signal:f}),this._freeHighlight=new Jw({x:r,y:o},[l,c,u,h],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var x,C,y,w;let r=null;if(t instanceof H_){const{data:{quadPoints:v,rect:E,rotation:_,id:k,color:T,opacity:L,popupRef:R,richText:N,contentsObj:M,creationDate:O,modificationDate:V},parent:{page:{pageNumber:H}}}=t;r=t={annotationType:oe.HIGHLIGHT,color:Array.from(T),opacity:L,quadPoints:v,boxes:null,pageIndex:H-1,rect:E.slice(0),rotation:_,annotationElementId:k,id:k,deleted:!1,popupRef:R,richText:N,comment:(M==null?void 0:M.str)||null,creationDate:O,modificationDate:V}}else if(t instanceof N1){const{data:{inkLists:v,rect:E,rotation:_,id:k,color:T,borderStyle:{rawWidth:L},popupRef:R,richText:N,contentsObj:M,creationDate:O,modificationDate:V},parent:{page:{pageNumber:H}}}=t;r=t={annotationType:oe.HIGHLIGHT,color:Array.from(T),thickness:L,inkLists:v,boxes:null,pageIndex:H-1,rect:E.slice(0),rotation:_,annotationElementId:k,id:k,deleted:!1,popupRef:R,richText:N,comment:(M==null?void 0:M.str)||null,creationDate:O,modificationDate:V}}const{color:o,quadPoints:l,inkLists:c,opacity:u}=t,h=await super.deserialize(t,s,i);h.color=X.makeHexColor(...o),h.opacity=u||1,c&&g(h,_s,t.thickness),h._initialData=r,t.comment&&h.setCommentData(t);const[d,f]=h.pageDimensions,[m,S]=h.pageTranslation;if(l){const v=g(h,kr,[]);for(let E=0;E<l.length;E+=8)v.push({x:(l[E]-m)/d,y:1-(l[E+1]-S)/f,width:(l[E+2]-l[E])/d,height:(l[E+1]-l[E+5])/f});A(x=h,de,Zw).call(x),A(C=h,de,_a).call(C),h.rotate(h.rotation)}else if(c){g(h,Vt,!0);const v=c[0],E={x:v[0]-m,y:f-(v[1]-S)},_=new Jw(E,[0,0,d,f],1,a(h,_s)/2,!0,.001);for(let L=0,R=v.length;L<R;L+=2)E.x=v[L]-m,E.y=f-(v[L+1]-S),_.add(E);const{id:k,clipPathId:T}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);A(y=h,de,gm).call(y,{highlightOutlines:_.getOutlines(),highlightId:k,clipPathId:T}),A(w=h,de,_a).call(w),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=He._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:s,opacity:this.opacity,thickness:a(this,_s),quadPoints:A(this,de,hk).call(this),outlines:A(this,de,dk).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!A(this,de,gk).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};th=new WeakMap,Dp=new WeakMap,kr=new WeakMap,Pl=new WeakMap,Ip=new WeakMap,Rn=new WeakMap,Fp=new WeakMap,jp=new WeakMap,Ll=new WeakMap,Zn=new WeakMap,es=new WeakMap,Vt=new WeakMap,nh=new WeakMap,sh=new WeakMap,an=new WeakMap,ih=new WeakMap,_s=new WeakMap,Op=new WeakMap,de=new WeakSet,Zw=function(){const t=new Kw(a(this,kr),.001);g(this,Zn,t.getOutlines()),[this.x,this.y,this.width,this.height]=a(this,Zn).box;const s=new Kw(a(this,kr),.0025,.001,this._uiManager.direction==="ltr");g(this,Rn,s.getOutlines());const{firstPoint:i}=a(this,Zn);g(this,nh,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:r}=a(this,Rn);g(this,sh,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},gm=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var f,m;if(g(this,Zn,t),g(this,Rn,t.getNewOutline(a(this,_s)/2+1.5,.0025)),s>=0)g(this,es,s),g(this,Pl,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),g(this,an,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:a(this,Rn).box,path:{d:a(this,Rn).toSVGPath()}},!0));else if(this.parent){const S=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(a(this,es),{bbox:A(f=Ce,Ns,gc).call(f,a(this,Zn).box,(S-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(a(this,an),{bbox:A(m=Ce,Ns,gc).call(m,a(this,Rn).box,S),path:{d:a(this,Rn).toSVGPath()}})}const[o,l,c,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=c,this.height=u;break;case 90:{const[S,x]=this.parentDimensions;this.x=l,this.y=1-o,this.width=c*x/S,this.height=u*S/x;break}case 180:this.x=1-o,this.y=1-l,this.width=c,this.height=u;break;case 270:{const[S,x]=this.parentDimensions;this.x=1-l,this.y=o,this.width=c*x/S,this.height=u*S/x;break}}const{firstPoint:h}=t;g(this,nh,[(h[0]-o)/c,(h[1]-l)/u]);const{lastPoint:d}=a(this,Rn);g(this,sh,[(d[0]-o)/c,(d[1]-l)/u])},ak=function(t){const s=(o,l)=>{this.color=o,this.opacity=l,this.onUpdatedColor()},i=this.color,r=this.opacity;this.addCommands({cmd:s.bind(this,t,Ce._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:me.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},lk=function(t){const s=a(this,_s),i=r=>{g(this,_s,r),A(this,de,ck).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:me.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},ck=function(t){a(this,Vt)&&(A(this,de,gm).call(this,{highlightOutlines:a(this,Zn).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))},ex=function(){a(this,es)===null||!this.parent||(this.parent.drawLayer.remove(a(this,es)),g(this,es,null),this.parent.drawLayer.remove(a(this,an)),g(this,an,null))},_a=function(t=this.parent){a(this,es)===null&&({id:At(this,es)._,clipPathId:At(this,Pl)._}=t.drawLayer.draw({bbox:a(this,Zn).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:a(this,Vt)},path:{d:a(this,Zn).toSVGPath()}},!1,!0),g(this,an,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:a(this,Vt)},bbox:a(this,Rn).box,path:{d:a(this,Rn).toSVGPath()}},a(this,Vt))),a(this,Ll)&&(a(this,Ll).style.clipPath=a(this,Pl)))},Ns=new WeakSet,gc=function([t,s,i,r],o){switch(o){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},uk=function(t){Ce._keyboardManager.exec(this,t)},mm=function(t){if(!a(this,th))return;const s=window.getSelection();t?s.setPosition(a(this,th),a(this,Dp)):s.setPosition(a(this,Fp),a(this,jp))},ym=function(){return a(this,Vt)?this.rotation:0},hk=function(){if(a(this,Vt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,o=a(this,kr),l=new Float32Array(o.length*8);let c=0;for(const{x:u,y:h,width:d,height:f}of o){const m=u*t+i,S=(1-h)*s+r;l[c]=l[c+4]=m,l[c+1]=l[c+3]=S,l[c+2]=l[c+6]=m+d*t,l[c+5]=l[c+7]=S-f*s,c+=8}return l},dk=function(t){return a(this,Zn).serialize(t,A(this,de,ym).call(this))},fk=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},pk=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},gk=function(t){const{color:s}=this._initialData;return this.hasEditedComment||t.color.some((i,r)=>i!==s[r])},b(Ce,Ns),F(Ce,"_defaultColor",null),F(Ce,"_defaultOpacity",1),F(Ce,"_defaultThickness",12),F(Ce,"_type","highlight"),F(Ce,"_editorType",oe.HIGHLIGHT),F(Ce,"_freeHighlightId",-1),F(Ce,"_freeHighlight",null),F(Ce,"_freeHighlightClipId","");let ly=Ce;var Nl;class mk{constructor(){b(this,Nl,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){a(this,Nl)[e]=t}toSVGProperties(){const e=a(this,Nl);return g(this,Nl,Object.create(null)),{root:e}}reset(){g(this,Nl,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){ze("Not implemented")}}Nl=new WeakMap;var ts,rh,Rt,Rl,Ml,Uo,$o,Ho,Dl,Se,tx,nx,sx,vd,yk,vm,wd,mc;const Y=class Y extends He{constructor(t){super(t);b(this,Se);b(this,ts,null);b(this,rh);F(this,"_colorPicker",null);F(this,"_drawId",null);g(this,rh,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(A(this,Se,tx).call(this,t),A(this,Se,vd).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,o]of Object.entries(s))i.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){ze("Not implemented")}static get typesMap(){ze("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(a(Y,Rt).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,o=r[s],l=c=>{var h;r.updateProperty(s,c);const u=a(this,ts).updateProperty(s,c);u&&A(this,Se,wd).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,i),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Y._mergeSVGProperties(a(this,ts).getPathResizingSVGProperties(A(this,Se,vm).call(this)),{bbox:A(this,Se,mc).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Y._mergeSVGProperties(a(this,ts).getPathResizedSVGProperties(A(this,Se,vm).call(this)),{bbox:A(this,Se,mc).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:A(this,Se,mc).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Y._mergeSVGProperties(a(this,ts).getPathTranslatedSVGProperties(A(this,Se,vm).call(this),this.parentDimensions),{bbox:A(this,Se,mc).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,a(this,rh)&&(g(this,rh,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){A(this,Se,sx).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,Se,vd).call(this),A(this,Se,wd).call(this,a(this,ts).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),A(this,Se,sx).call(this)):t&&(this._uiManager.addShouldRescale(this),A(this,Se,vd).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Y._mergeSVGProperties({bbox:A(this,Se,mc).call(this)},a(this,ts).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&A(this,Se,wd).call(this,a(this,ts).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");return i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),i}static createDrawerInstance(t,s,i,r,o){ze("Not implemented")}static startDrawing(t,s,i,r){var C;const{target:o,offsetX:l,offsetY:c,pointerId:u,pointerType:h}=r;if(a(Y,$o)&&a(Y,$o)!==h)return;const{viewport:{rotation:d}}=t,{width:f,height:m}=o.getBoundingClientRect(),S=g(Y,Rl,new AbortController),x=t.combinedSignal(S);if(a(Y,Uo)||g(Y,Uo,u),a(Y,$o)??g(Y,$o,h),window.addEventListener("pointerup",y=>{var w;a(Y,Uo)===y.pointerId?this._endDraw(y):(w=a(Y,Ho))==null||w.delete(y.pointerId)},{signal:x}),window.addEventListener("pointercancel",y=>{var w;a(Y,Uo)===y.pointerId?this._currentParent.endDrawingSession():(w=a(Y,Ho))==null||w.delete(y.pointerId)},{signal:x}),window.addEventListener("pointerdown",y=>{a(Y,$o)===y.pointerType&&((a(Y,Ho)||g(Y,Ho,new Set)).add(y.pointerId),a(Y,Rt).isCancellable()&&(a(Y,Rt).removeLastElement(),a(Y,Rt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",ds,{signal:x}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),o.addEventListener("touchmove",y=>{y.timeStamp===a(Y,Dl)&&tt(y)},{signal:x}),t.toggleDrawing(),(C=s._editorUndoBar)==null||C.hide(),a(Y,Rt)){t.drawLayer.updateProperties(this._currentDrawId,a(Y,Rt).startNew(l,c,f,m,d));return}s.updateUIForDefaultProperties(this),g(Y,Rt,this.createDrawerInstance(l,c,f,m,d)),g(Y,Ml,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(a(Y,Ml).toSVGProperties(),a(Y,Rt).defaultSVGProperties),!0,!1)}static _drawMove(t){var o;if(g(Y,Dl,-1),!a(Y,Rt))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(a(Y,Uo)===r){if(((o=a(Y,Ho))==null?void 0:o.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,a(Y,Rt).add(s,i)),g(Y,Dl,t.timeStamp),tt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,g(Y,Rt,null),g(Y,Ml,null),g(Y,$o,null),g(Y,Dl,NaN)),a(Y,Rl)&&(a(Y,Rl).abort(),g(Y,Rl,null),g(Y,Uo,NaN),g(Y,Ho,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,a(Y,Rt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=a(Y,Rt),r=this._currentDrawId,o=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(o))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:me.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(me.DRAW_STEP),!a(Y,Rt).isEmpty()){const{pageDimensions:[i,r],scale:o}=s,l=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:a(Y,Rt).getOutlines(i*o,r*o,o,this._INNER_MARGIN),drawingOptions:a(Y,Ml),mustBeCommitted:!t});return this._cleanup(!0),l}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,o,l){ze("Not implemented")}static async deserialize(t,s,i){var d,f;const{rawDims:{pageWidth:r,pageHeight:o,pageX:l,pageY:c}}=s.viewport,u=this.deserializeDraw(l,c,r,o,this._INNER_MARGIN,t),h=await super.deserialize(t,s,i);return h.createDrawingOptions(t),A(d=h,Se,tx).call(d,{drawOutlines:u}),A(f=h,Se,vd).call(f),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[s,i]=this.pageTranslation,[r,o]=this.pageDimensions;return a(this,ts).serialize([s,i,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};ts=new WeakMap,rh=new WeakMap,Rt=new WeakMap,Rl=new WeakMap,Ml=new WeakMap,Uo=new WeakMap,$o=new WeakMap,Ho=new WeakMap,Dl=new WeakMap,Se=new WeakSet,tx=function({drawOutlines:t,drawId:s,drawingOptions:i}){g(this,ts,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=A(this,Se,nx).call(this,t,this.parent),A(this,Se,wd).call(this,t.box)},nx=function(t,s){const{id:i}=s.drawLayer.draw(Y._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},sx=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},vd=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=A(this,Se,nx).call(this,a(this,ts),t)}},yk=function([t,s,i,r]){const{parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(l/o),r*(o/l)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(l/o),r*(o/l)];default:return[t,s,i,r]}},vm=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(o/l),r*(l/o)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(o/l),r*(l/o)];default:return[t,s,i,r]}},wd=function(t){[this.x,this.y,this.width,this.height]=A(this,Se,yk).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},mc=function(){const{x:t,y:s,width:i,height:r,rotation:o,parentRotation:l,parentDimensions:[c,u]}=this;switch((o*4+l)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/u),r*(u/c),i*(c/u)];case 5:return[1-s,t,i*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-s,r*(u/c),i*(c/u)];case 7:return[s-i*(c/u),1-t-r*(u/c),i*(c/u),r*(u/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/c),s,r*(u/c),i*(c/u)];case 13:return[1-s-i*(c/u),t-r*(u/c),i*(c/u),r*(u/c)];case 14:return[1-t,1-s-i*(c/u),r*(u/c),i*(c/u)];case 15:return[s,1-t,i*(c/u),r*(u/c)];default:return[t,s,i,r]}},F(Y,"_currentDrawId",-1),F(Y,"_currentParent",null),b(Y,Rt,null),b(Y,Rl,null),b(Y,Ml,null),b(Y,Uo,NaN),b(Y,$o,null),b(Y,Ho,null),b(Y,Dl,NaN),F(Y,"_INNER_MARGIN",3);let cy=Y;var Mi,Mt,Dt,Il,oh,gn,Gt,ks,Fl,jl,Ol,ah,wm;class QR{constructor(e,t,s,i,r,o){b(this,ah);b(this,Mi,new Float64Array(6));b(this,Mt);b(this,Dt);b(this,Il);b(this,oh);b(this,gn);b(this,Gt,"");b(this,ks,0);b(this,Fl,new tg);b(this,jl);b(this,Ol);g(this,jl,s),g(this,Ol,i),g(this,Il,r),g(this,oh,o),[e,t]=A(this,ah,wm).call(this,e,t);const l=g(this,Mt,[NaN,NaN,NaN,NaN,e,t]);g(this,gn,[e,t]),g(this,Dt,[{line:l,points:a(this,gn)}]),a(this,Mi).set(l,0)}updateProperty(e,t){e==="stroke-width"&&g(this,oh,t)}isEmpty(){return!a(this,Dt)||a(this,Dt).length===0}isCancellable(){return a(this,gn).length<=10}add(e,t){[e,t]=A(this,ah,wm).call(this,e,t);const[s,i,r,o]=a(this,Mi).subarray(2,6),l=e-r,c=t-o;return Math.hypot(a(this,jl)*l,a(this,Ol)*c)<=2?null:(a(this,gn).push(e,t),isNaN(s)?(a(this,Mi).set([r,o,e,t],2),a(this,Mt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(a(this,Mi)[0])&&a(this,Mt).splice(6,6),a(this,Mi).set([s,i,r,o,e,t],0),a(this,Mt).push(...W.createBezierPoints(s,i,r,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(a(this,gn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){g(this,jl,s),g(this,Ol,i),g(this,Il,r),[e,t]=A(this,ah,wm).call(this,e,t);const o=g(this,Mt,[NaN,NaN,NaN,NaN,e,t]);g(this,gn,[e,t]);const l=a(this,Dt).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),a(this,Dt).push({line:o,points:a(this,gn)}),a(this,Mi).set(o,0),g(this,ks,0),this.toSVGPath(),null}getLastElement(){return a(this,Dt).at(-1)}setLastElement(e){return a(this,Dt)?(a(this,Dt).push(e),g(this,Mt,e.line),g(this,gn,e.points),g(this,ks,0),{path:{d:this.toSVGPath()}}):a(this,Fl).setLastElement(e)}removeLastElement(){if(!a(this,Dt))return a(this,Fl).removeLastElement();a(this,Dt).pop(),g(this,Gt,"");for(let e=0,t=a(this,Dt).length;e<t;e++){const{line:s,points:i}=a(this,Dt)[e];g(this,Mt,s),g(this,gn,i),g(this,ks,0),this.toSVGPath()}return{path:{d:a(this,Gt)}}}toSVGPath(){const e=W.svgRound(a(this,Mt)[4]),t=W.svgRound(a(this,Mt)[5]);if(a(this,gn).length===2)return g(this,Gt,`${a(this,Gt)} M ${e} ${t} Z`),a(this,Gt);if(a(this,gn).length<=6){const i=a(this,Gt).lastIndexOf("M");g(this,Gt,`${a(this,Gt).slice(0,i)} M ${e} ${t}`),g(this,ks,6)}if(a(this,gn).length===4){const i=W.svgRound(a(this,Mt)[10]),r=W.svgRound(a(this,Mt)[11]);return g(this,Gt,`${a(this,Gt)} L ${i} ${r}`),g(this,ks,12),a(this,Gt)}const s=[];a(this,ks)===0&&(s.push(`M ${e} ${t}`),g(this,ks,6));for(let i=a(this,ks),r=a(this,Mt).length;i<r;i+=6){const[o,l,c,u,h,d]=a(this,Mt).slice(i,i+6).map(W.svgRound);s.push(`C${o} ${l} ${c} ${u} ${h} ${d}`)}return g(this,Gt,a(this,Gt)+s.join(" ")),g(this,ks,a(this,Mt).length),a(this,Gt)}getOutlines(e,t,s,i){const r=a(this,Dt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),a(this,Fl).build(a(this,Dt),e,t,s,a(this,Il),a(this,oh),i),g(this,Mi,null),g(this,Mt,null),g(this,Dt,null),g(this,Gt,null),a(this,Fl)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Mi=new WeakMap,Mt=new WeakMap,Dt=new WeakMap,Il=new WeakMap,oh=new WeakMap,gn=new WeakMap,Gt=new WeakMap,ks=new WeakMap,Fl=new WeakMap,jl=new WeakMap,Ol=new WeakMap,ah=new WeakSet,wm=function(e,t){return W._normalizePoint(e,t,a(this,jl),a(this,Ol),a(this,Il))};var mn,Bp,zp,ns,Di,Ii,lh,ch,Bl,qt,qi,vk,wk,xk;class tg extends W{constructor(){super(...arguments);b(this,qt);b(this,mn);b(this,Bp,0);b(this,zp);b(this,ns);b(this,Di);b(this,Ii);b(this,lh);b(this,ch);b(this,Bl)}build(t,s,i,r,o,l,c){g(this,Di,s),g(this,Ii,i),g(this,lh,r),g(this,ch,o),g(this,Bl,l),g(this,zp,c??0),g(this,ns,t),A(this,qt,wk).call(this)}get thickness(){return a(this,Bl)}setLastElement(t){return a(this,ns).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return a(this,ns).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of a(this,ns)){if(t.push(`M${W.svgRound(s[4])} ${W.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${W.svgRound(s[10])} ${W.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[o,l,c,u,h,d]=s.subarray(i,i+6).map(W.svgRound);t.push(`C${o} ${l} ${c} ${u} ${h} ${d}`)}}return t.join("")}serialize([t,s,i,r],o){const l=[],c=[],[u,h,d,f]=A(this,qt,vk).call(this);let m,S,x,C,y,w,v,E,_;switch(a(this,ch)){case 0:_=W._rescale,m=t,S=s+r,x=i,C=-r,y=t+u*i,w=s+(1-h-f)*r,v=t+(u+d)*i,E=s+(1-h)*r;break;case 90:_=W._rescaleAndSwap,m=t,S=s,x=i,C=r,y=t+h*i,w=s+u*r,v=t+(h+f)*i,E=s+(u+d)*r;break;case 180:_=W._rescale,m=t+i,S=s,x=-i,C=r,y=t+(1-u-d)*i,w=s+h*r,v=t+(1-u)*i,E=s+(h+f)*r;break;case 270:_=W._rescaleAndSwap,m=t+i,S=s+r,x=-i,C=-r,y=t+(1-h-f)*i,w=s+(1-u-d)*r,v=t+(1-h)*i,E=s+(1-u)*r;break}for(const{line:k,points:T}of a(this,ns))l.push(_(k,m,S,x,C,o?new Array(k.length):null)),c.push(_(T,m,S,x,C,o?new Array(T.length):null));return{lines:l,points:c,rect:[y,w,v,E]}}static deserialize(t,s,i,r,o,{paths:{lines:l,points:c},rotation:u,thickness:h}){const d=[];let f,m,S,x,C;switch(u){case 0:C=W._rescale,f=-t/i,m=s/r+1,S=1/i,x=-1/r;break;case 90:C=W._rescaleAndSwap,f=-s/r,m=-t/i,S=1/r,x=1/i;break;case 180:C=W._rescale,f=t/i+1,m=-s/r,S=-1/i,x=1/r;break;case 270:C=W._rescaleAndSwap,f=s/r+1,m=t/i+1,S=-1/r,x=-1/i;break}if(!l){l=[];for(const w of c){const v=w.length;if(v===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(v===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const E=new Float32Array(3*(v-2));l.push(E);let[_,k,T,L]=w.subarray(0,4);E.set([NaN,NaN,NaN,NaN,_,k],0);for(let R=4;R<v;R+=2){const N=w[R],M=w[R+1];E.set(W.createBezierPoints(_,k,T,L,N,M),(R-2)*3),[_,k,T,L]=[T,L,N,M]}}}for(let w=0,v=l.length;w<v;w++)d.push({line:C(l[w].map(E=>E??NaN),f,m,S,x),points:C(c[w].map(E=>E??NaN),f,m,S,x)});const y=new this.prototype.constructor;return y.build(d,i,r,1,u,h,o),y}get box(){return a(this,mn)}updateProperty(t,s){return t==="stroke-width"?A(this,qt,xk).call(this,s):null}updateParentDimensions([t,s],i){const[r,o]=A(this,qt,qi).call(this);g(this,Di,t),g(this,Ii,s),g(this,lh,i);const[l,c]=A(this,qt,qi).call(this),u=l-r,h=c-o,d=a(this,mn);return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(t){return g(this,Bp,t),{path:{transform:this.rotationTransform}}}get viewBox(){return a(this,mn).map(W.svgRound).join(" ")}get defaultProperties(){const[t,s]=a(this,mn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${W.svgRound(t)} ${W.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=a(this,mn);let i=0,r=0,o=0,l=0,c=0,u=0;switch(a(this,Bp)){case 90:r=s/t,o=-t/s,c=t;break;case 180:i=-1,l=-1,c=t,u=s;break;case 270:r=-s/t,o=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${o} ${l} ${W.svgRound(c)} ${W.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[o,l]=A(this,qt,qi).call(this),[c,u,h,d]=a(this,mn);if(Math.abs(h-o)<=W.PRECISION||Math.abs(d-l)<=W.PRECISION){const C=t+i/2-(c+h/2),y=s+r/2-(u+d/2);return{path:{"transform-origin":`${W.svgRound(t)} ${W.svgRound(s)}`,transform:`${this.rotationTransform} translate(${C} ${y})`}}}const f=(i-2*o)/(h-2*o),m=(r-2*l)/(d-2*l),S=h/i,x=d/r;return{path:{"transform-origin":`${W.svgRound(c)} ${W.svgRound(u)}`,transform:`${this.rotationTransform} scale(${S} ${x}) translate(${W.svgRound(o)} ${W.svgRound(l)}) scale(${f} ${m}) translate(${W.svgRound(-o)} ${W.svgRound(-l)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[o,l]=A(this,qt,qi).call(this),c=a(this,mn),[u,h,d,f]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(d-o)<=W.PRECISION||Math.abs(f-l)<=W.PRECISION){const y=t+i/2-(u+d/2),w=s+r/2-(h+f/2);for(const{line:v,points:E}of a(this,ns))W._translate(v,y,w,v),W._translate(E,y,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${W.svgRound(t)} ${W.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*o)/(d-2*o),S=(r-2*l)/(f-2*l),x=-m*(u+o)+t+o,C=-S*(h+l)+s+l;if(m!==1||S!==1||x!==0||C!==0)for(const{line:y,points:w}of a(this,ns))W._rescale(y,x,C,m,S,y),W._rescale(w,x,C,m,S,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${W.svgRound(t)} ${W.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,o]=i,l=a(this,mn),c=t-l[0],u=s-l[1];if(a(this,Di)===r&&a(this,Ii)===o)for(const{line:h,points:d}of a(this,ns))W._translate(h,c,u,h),W._translate(d,c,u,d);else{const h=a(this,Di)/r,d=a(this,Ii)/o;g(this,Di,r),g(this,Ii,o);for(const{line:f,points:m}of a(this,ns))W._rescale(f,c,u,h,d,f),W._rescale(m,c,u,h,d,m);l[2]*=h,l[3]*=d}return l[0]=t,l[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${W.svgRound(t)} ${W.svgRound(s)}`}}}get defaultSVGProperties(){const t=a(this,mn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${W.svgRound(t[0])} ${W.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}mn=new WeakMap,Bp=new WeakMap,zp=new WeakMap,ns=new WeakMap,Di=new WeakMap,Ii=new WeakMap,lh=new WeakMap,ch=new WeakMap,Bl=new WeakMap,qt=new WeakSet,qi=function(t=a(this,Bl)){const s=a(this,zp)+t/2*a(this,lh);return a(this,ch)%180===0?[s/a(this,Di),s/a(this,Ii)]:[s/a(this,Ii),s/a(this,Di)]},vk=function(){const[t,s,i,r]=a(this,mn),[o,l]=A(this,qt,qi).call(this,0);return[t+o,s+l,i-2*o,r-2*l]},wk=function(){const t=g(this,mn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of a(this,ns)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6)X.pointBoundingBox(r[c],r[c+1],t);continue}let o=r[4],l=r[5];for(let c=6,u=r.length;c<u;c+=6){const[h,d,f,m,S,x]=r.subarray(c,c+6);X.bezierBoundingBox(o,l,h,d,f,m,S,x,t),o=S,l=x}}const[s,i]=A(this,qt,qi).call(this);t[0]=ln(t[0]-s,0,1),t[1]=ln(t[1]-i,0,1),t[2]=ln(t[2]+s,0,1),t[3]=ln(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},xk=function(t){const[s,i]=A(this,qt,qi).call(this);g(this,Bl,t);const[r,o]=A(this,qt,qi).call(this),[l,c]=[r-s,o-i],u=a(this,mn);return u[0]-=l,u[1]-=c,u[2]+=2*l,u[3]+=2*c,u};class rv extends mk{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:He._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new rv(this._viewParameters);return e.updateAll(this),e}}var Py,Sk;const Mc=class Mc extends cy{constructor(t){super({...t,name:"inkEditor"});b(this,Py);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){He.initialize(t,s),this._defaultDrawingOptions=new rv(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return he(this,"typesMap",new Map([[me.INK_THICKNESS,"stroke-width"],[me.INK_COLOR,"stroke"],[me.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,o){return new QR(t,s,i,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,o,l){return tg.deserialize(t,s,i,r,o,l)}static async deserialize(t,s,i){let r=null;if(t instanceof N1){const{data:{inkLists:l,rect:c,rotation:u,id:h,color:d,opacity:f,borderStyle:{rawWidth:m},popupRef:S,richText:x,contentsObj:C,creationDate:y,modificationDate:w},parent:{page:{pageNumber:v}}}=t;r=t={annotationType:oe.INK,color:Array.from(d),thickness:m,opacity:f,paths:{points:l},boxes:null,pageIndex:v-1,rect:c.slice(0),rotation:u,annotationElementId:h,id:h,deleted:!1,popupRef:S,richText:x,comment:(C==null?void 0:C.str)||null,creationDate:y,modificationDate:w}}const o=await super.deserialize(t,s,i);return o._initialData=r,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new oy(this)),[["colorPicker",this._colorPicker]]}get colorType(){return me.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=Mc.getDefaultDrawingOptions({stroke:X.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":o,"stroke-width":l}}=this,c=Object.assign(super.serialize(t),{color:He._colorManager.convert(r),opacity:o,thickness:l,paths:{lines:s,points:i}});return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!A(this,Py,Sk).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s,popup:this.comment}),null}};Py=new WeakSet,Sk=function(t){const{color:s,thickness:i,opacity:r,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,c)=>l!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==o},F(Mc,"_type","ink"),F(Mc,"_editorType",oe.INK),F(Mc,"_defaultDrawingOptions",null);let ix=Mc;class rx extends tg{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Dg=8,qh=3;var zl,ke,ox,Zs,bk,Ak,ax,xm,Ek,Ck,_k,lx,cx,kk;class zi{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},r,o,l,c){let u=new OffscreenCanvas(1,1),h=u.getContext("2d",{alpha:!1});const d=200,f=h.font=`${s} ${i} ${d}px ${t}`,{actualBoundingBoxLeft:m,actualBoundingBoxRight:S,actualBoundingBoxAscent:x,actualBoundingBoxDescent:C,fontBoundingBoxAscent:y,fontBoundingBoxDescent:w,width:v}=h.measureText(e),E=1.5,_=Math.ceil(Math.max(Math.abs(m)+Math.abs(S)||0,v)*E),k=Math.ceil(Math.max(Math.abs(x)+Math.abs(C)||d,Math.abs(y)+Math.abs(w)||d)*E);u=new OffscreenCanvas(_,k),h=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=f,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,_,k),h.fillStyle="black",h.fillText(e,_*(E-1)/2,k*(3-E)/2);const T=A(this,ke,lx).call(this,h.getImageData(0,0,_,k).data),L=A(this,ke,_k).call(this,T),R=A(this,ke,cx).call(this,L),N=A(this,ke,ax).call(this,T,_,k,R);return this.processDrawnLines({lines:{curves:N,width:_,height:k},pageWidth:r,pageHeight:o,rotation:l,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,r){const[o,l,c]=A(this,ke,kk).call(this,e),[u,h]=A(this,ke,Ck).call(this,o,l,c,Math.hypot(l,c)*a(this,zl).sigmaSFactor,a(this,zl).sigmaR,a(this,zl).kernelSize),d=A(this,ke,cx).call(this,h),f=A(this,ke,ax).call(this,u,l,c,d);return this.processDrawnLines({lines:{curves:f,width:l,height:c},pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:o,areContours:l}){i%180!==0&&([t,s]=[s,t]);const{curves:c,width:u,height:h}=e,d=e.thickness??0,f=[],m=Math.min(t/u,s/h),S=m/t,x=m/s,C=[];for(const{points:w}of c){const v=o?A(this,ke,Ek).call(this,w):w;if(!v)continue;C.push(v);const E=v.length,_=new Float32Array(E),k=new Float32Array(3*(E===2?2:E-2));if(f.push({line:k,points:_}),E===2){_[0]=v[0]*S,_[1]=v[1]*x,k.set([NaN,NaN,NaN,NaN,_[0],_[1]],0);continue}let[T,L,R,N]=v;T*=S,L*=x,R*=S,N*=x,_.set([T,L,R,N],0),k.set([NaN,NaN,NaN,NaN,T,L],0);for(let M=4;M<E;M+=2){const O=_[M]=v[M]*S,V=_[M+1]=v[M+1]*x;k.set(W.createBezierPoints(T,L,R,N,O,V),(M-2)*3),[T,L,R,N]=[R,N,O,V]}}if(f.length===0)return null;const y=l?new rx:new tg;return y.build(f,t,s,1,i,l?0:d,r),{outline:y,newCurves:C,areContours:l,thickness:d,width:u,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:r}){let o=1/0,l=-1/0,c=0;for(const v of e){c+=v.length;for(let E=2,_=v.length;E<_;E++){const k=v[E]-v[E-2];o=Math.min(o,k),l=Math.max(l,k)}}let u;o>=-128&&l<=127?u=Int8Array:o>=-32768&&l<=32767?u=Int16Array:u=Int32Array;const h=e.length,d=Dg+qh*h,f=new Uint32Array(d);let m=0;f[m++]=d*Uint32Array.BYTES_PER_ELEMENT+(c-2*h)*u.BYTES_PER_ELEMENT,f[m++]=0,f[m++]=i,f[m++]=r,f[m++]=t?0:1,f[m++]=Math.max(0,Math.floor(s??0)),f[m++]=h,f[m++]=u.BYTES_PER_ELEMENT;for(const v of e)f[m++]=v.length-2,f[m++]=v[0],f[m++]=v[1];const S=new CompressionStream("deflate-raw"),x=S.writable.getWriter();await x.ready,x.write(f);const C=u.prototype.constructor;for(const v of e){const E=new C(v.length-2);for(let _=2,k=v.length;_<k;_++)E[_-2]=v[_]-v[_-2];x.write(E)}x.close();const y=await new Response(S.readable).arrayBuffer(),w=new Uint8Array(y);return EC(w)}static async decompressSignature(e){try{const t=bN(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),r=i.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let o=null,l=0;for await(const v of s)o||(o=new Uint8Array(new Uint32Array(v.buffer,0,4)[0])),o.set(v,l),l+=v.length;const c=new Uint32Array(o.buffer,0,o.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const h=c[2],d=c[3],f=c[4]===0,m=c[5],S=c[6],x=c[7],C=[],y=(Dg+qh*S)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(x){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(o.buffer,y);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(o.buffer,y);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(o.buffer,y);break}l=0;for(let v=0;v<S;v++){const E=c[qh*v+Dg],_=new Float32Array(E+2);C.push(_);for(let k=0;k<qh-1;k++)_[k]=c[qh*v+Dg+k+1];for(let k=0;k<E;k++)_[k+2]=_[k]+w[l++]}return{areContours:f,thickness:m,outlines:C,width:h,height:d}}catch(t){return ae(`decompressSignature: ${t}`),null}}}zl=new WeakMap,ke=new WeakSet,ox=function(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i},Zs=new WeakMap,bk=function(e,t,s,i,r,o,l){const c=A(this,ke,ox).call(this,s,i,r,o);for(let u=0;u<8;u++){const h=(-u+c-l+16)%8,d=a(this,Zs)[2*h],f=a(this,Zs)[2*h+1];if(e[(s+d)*t+(i+f)]!==0)return h}return-1},Ak=function(e,t,s,i,r,o,l){const c=A(this,ke,ox).call(this,s,i,r,o);for(let u=0;u<8;u++){const h=(u+c+l+16)%8,d=a(this,Zs)[2*h],f=a(this,Zs)[2*h+1];if(e[(s+d)*t+(i+f)]!==0)return h}return-1},ax=function(e,t,s,i){const r=e.length,o=new Int32Array(r);for(let h=0;h<r;h++)o[h]=e[h]<=i?1:0;for(let h=1;h<s-1;h++)o[h*t]=o[h*t+t-1]=0;for(let h=0;h<t;h++)o[h]=o[t*s-1-h]=0;let l=1,c;const u=[];for(let h=1;h<s-1;h++){c=1;for(let d=1;d<t-1;d++){const f=h*t+d,m=o[f];if(m===0)continue;let S=h,x=d;if(m===1&&o[f-1]===0)l+=1,x-=1;else if(m>=1&&o[f+1]===0)l+=1,x+=1,m>1&&(c=m);else{m!==1&&(c=Math.abs(m));continue}const C=[d,h],y=x===d+1,w={isHole:y,points:C,id:l,parent:0};u.push(w);let v;for(const M of u)if(M.id===c){v=M;break}v?v.isHole?w.parent=y?v.parent:c:w.parent=y?c:v.parent:w.parent=y?c:0;const E=A(this,ke,bk).call(this,o,t,h,d,S,x,0);if(E===-1){o[f]=-l,o[f]!==1&&(c=Math.abs(o[f]));continue}let _=a(this,Zs)[2*E],k=a(this,Zs)[2*E+1];const T=h+_,L=d+k;S=T,x=L;let R=h,N=d;for(;;){const M=A(this,ke,Ak).call(this,o,t,R,N,S,x,1);_=a(this,Zs)[2*M],k=a(this,Zs)[2*M+1];const O=R+_,V=N+k;C.push(V,O);const H=R*t+N;if(o[H+1]===0?o[H]=-l:o[H]===1&&(o[H]=l),O===h&&V===d&&R===T&&N===L){o[f]!==1&&(c=Math.abs(o[f]));break}else S=R,x=N,R=O,N=V}}}return u},xm=function(e,t,s,i){if(s-t<=4){for(let T=t;T<s-2;T+=2)i.push(e[T],e[T+1]);return}const r=e[t],o=e[t+1],l=e[s-4]-r,c=e[s-3]-o,u=Math.hypot(l,c),h=l/u,d=c/u,f=h*o-d*r,m=c/l,S=1/u,x=Math.atan(m),C=Math.cos(x),y=Math.sin(x),w=S*(Math.abs(C)+Math.abs(y)),v=S*(1-w+w**2),E=Math.max(Math.atan(Math.abs(y+C)*v),Math.atan(Math.abs(y-C)*v));let _=0,k=t;for(let T=t+2;T<s-2;T+=2){const L=Math.abs(f-h*e[T+1]+d*e[T]);L>_&&(k=T,_=L)}_>(u*E)**2?(A(this,ke,xm).call(this,e,t,k+2,i),A(this,ke,xm).call(this,e,k,s,i)):i.push(r,o)},Ek=function(e){const t=[],s=e.length;return A(this,ke,xm).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},Ck=function(e,t,s,i,r,o){const l=new Float32Array(o**2),c=-2*i**2,u=o>>1;for(let x=0;x<o;x++){const C=(x-u)**2;for(let y=0;y<o;y++)l[x*o+y]=Math.exp((C+(y-u)**2)/c)}const h=new Float32Array(256),d=-2*r**2;for(let x=0;x<256;x++)h[x]=Math.exp(x**2/d);const f=e.length,m=new Uint8Array(f),S=new Uint32Array(256);for(let x=0;x<s;x++)for(let C=0;C<t;C++){const y=x*t+C,w=e[y];let v=0,E=0;for(let k=0;k<o;k++){const T=x+k-u;if(!(T<0||T>=s))for(let L=0;L<o;L++){const R=C+L-u;if(R<0||R>=t)continue;const N=e[T*t+R],M=l[k*o+L]*h[Math.abs(N-w)];v+=N*M,E+=M}}const _=m[y]=Math.round(v/E);S[_]++}return[m,S]},_k=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},lx=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let l=0,c=s.length;l<c;l++){const u=s[l]=e[l<<2];i=Math.max(i,u),r=Math.min(r,u)}const o=255/(i-r);for(let l=0,c=s.length;l<c;l++)s[l]=(s[l]-r)*o;return s},cx=function(e){let t,s=-1/0,i=-1/0;const r=e.findIndex(c=>c!==0);let o=r,l=r;for(t=r;t<256;t++){const c=e[t];c>s&&(t-o>i&&(i=t-o,l=t-1),s=c,o=t)}for(t=l-1;t>=0&&!(e[t]>e[t+1]);t--);return t},kk=function(e){const t=e,{width:s,height:i}=e,{maxDim:r}=a(this,zl);let o=s,l=i;if(s>r||i>r){let f=s,m=i,S=Math.log2(Math.max(s,i)/r);const x=Math.floor(S);S=S===x?x-1:x;for(let y=0;y<S;y++){o=Math.ceil(f/2),l=Math.ceil(m/2);const w=new OffscreenCanvas(o,l);w.getContext("2d").drawImage(e,0,0,f,m,0,0,o,l),f=o,m=l,e!==t&&e.close(),e=w.transferToImageBitmap()}const C=Math.min(r/o,r/l);o=Math.round(o*C),l=Math.round(l*C)}const u=new OffscreenCanvas(o,l).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,o,l),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,o,l);const h=u.getImageData(0,0,o,l).data;return[A(this,ke,lx).call(this,h),o,l]},b(zi,ke),b(zi,zl,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),b(zi,Zs,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class M1 extends mk{constructor(){super(),super.updateProperties({fill:He._defaultLineColor,"stroke-width":0})}clone(){const e=new M1;return e.updateAll(this),e}}class D1 extends rv{constructor(e){super(e),super.updateProperties({stroke:He._defaultLineColor,"stroke-width":1})}clone(){const e=new D1(this._viewParameters);return e.updateAll(this),e}}var Vo,Fi,Go,Ul;const zn=class zn extends cy{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});b(this,Vo,!1);b(this,Fi,null);b(this,Go,null);b(this,Ul,null);this._willKeepAspectRatio=!0,g(this,Go,t.signatureData||null),g(this,Fi,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){He.initialize(t,s),this._defaultDrawingOptions=new M1,this._defaultDrawnSignatureOptions=new D1(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return he(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!a(this,Fi)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(a(this,Go)){const{lines:r,mustSmooth:o,areContours:l,description:c,uuid:u,heightInPage:h}=a(this,Go),{rawDims:{pageWidth:d,pageHeight:f},rotation:m}=this.parent.viewport,S=zi.processDrawnLines({lines:r,pageWidth:d,pageHeight:f,rotation:m,innerMargin:zn._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(S,h,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:a(this,Fi)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){g(this,Ul,t),this.addEditToolbar()}getUuid(){return a(this,Ul)}get description(){return a(this,Fi)}set description(t){g(this,Fi,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:i,width:r,height:o}=a(this,Go),l=Math.max(r,o),c=zi.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:r,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,s,i,r){const{x:o,y:l}=this,{outline:c}=g(this,Go,t);g(this,Vo,c instanceof rx),this.description=i;let u;a(this,Vo)?u=zn.getDefaultDrawingOptions():(u=zn._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[,h]=this.pageDimensions;let d=s/h;d=d>=1?.5:d,this.width*=d/this.height,this.width>=1&&(d*=.9/this.width,this.width=.9),this.height=d,this.setDims(),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return zi.process(t,s,i,r,zn._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:i,pageHeight:r},rotation:o}=this.parent.viewport;return zi.extractContoursFromText(t,s,i,r,o,zn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return zi.processDrawnLines({lines:t,pageWidth:s,pageHeight:i,rotation:r,innerMargin:zn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=zn.getDefaultDrawingOptions():(this._drawingOptions=zn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:a(this,Vo),color:[0,0,0],thickness:a(this,Vo)?0:r});return this.addComment(o),t?(o.paths={lines:s,points:i},o.uuid=a(this,Ul),o.isCopy=!0):o.lines=s,a(this,Fi)&&(o.accessibilityData={type:"Figure",alt:a(this,Fi)}),o}static deserializeDraw(t,s,i,r,o,l){return l.areContours?rx.deserialize(t,s,i,r,o,l):tg.deserialize(t,s,i,r,o,l)}static async deserialize(t,s,i){var o;const r=await super.deserialize(t,s,i);return g(r,Vo,t.areContours),r.description=((o=t.accessibilityData)==null?void 0:o.alt)||"",g(r,Ul,t.uuid),r}};Vo=new WeakMap,Fi=new WeakMap,Go=new WeakMap,Ul=new WeakMap,F(zn,"_type","signature"),F(zn,"_editorType",oe.SIGNATURE),F(zn,"_defaultDrawingOptions",null);let ux=zn;var Ke,It,Wo,Tr,Xo,uh,Pr,$l,ji,ss,hh,be,xd,Sd,Sm,bm,Am,dx,Em,Tk;class hx extends He{constructor(t){super({...t,name:"stampEditor"});b(this,be);b(this,Ke,null);b(this,It,null);b(this,Wo,null);b(this,Tr,null);b(this,Xo,null);b(this,uh,"");b(this,Pr,null);b(this,$l,!1);b(this,ji,null);b(this,ss,!1);b(this,hh,!1);g(this,Tr,t.bitmapUrl),g(this,Xo,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){He.initialize(t,s)}static isHandlingMimeForPasting(t){return ty.includes(t)}static paste(t,s){s.pasteEditor({mode:oe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:o,height:l,channels:r.length/(o*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;a(this,It)&&(g(this,Ke,null),this._uiManager.imageManager.deleteId(a(this,It)),(t=a(this,Pr))==null||t.remove(),g(this,Pr,null),a(this,ji)&&(clearTimeout(a(this,ji)),g(this,ji,null))),super.remove()}rebuild(){if(!this.parent){a(this,It)&&A(this,be,Sm).call(this);return}super.rebuild(),this.div!==null&&(a(this,It)&&a(this,Pr)===null&&A(this,be,Sm).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(a(this,Wo)||a(this,Ke)||a(this,Tr)||a(this,Xo)||a(this,It)||a(this,$l))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),a(this,$l)||(a(this,Ke)?A(this,be,bm).call(this):A(this,be,Sm).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(g(this,It,i),r&&g(this,Ke,r),g(this,$l,!1),A(this,be,bm).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;a(this,ji)!==null&&clearTimeout(a(this,ji)),g(this,ji,setTimeout(()=>{g(this,ji,null),A(this,be,dx).call(this)},200))}copyCanvas(t,s,i=!1){t||(t=224);const{width:r,height:o}=a(this,Ke),l=new li;let c=a(this,Ke),u=r,h=o,d=null;if(s){if(r>s||o>s){const T=Math.min(s/r,s/o);u=Math.floor(r*T),h=Math.floor(o*T)}d=document.createElement("canvas");const m=d.width=Math.ceil(u*l.sx),S=d.height=Math.ceil(h*l.sy);a(this,ss)||(c=A(this,be,Am).call(this,m,S));const x=d.getContext("2d");x.filter=this._uiManager.hcmFilter;let C="white",y="#cfcfd8";this._uiManager.hcmFilter!=="none"?y="black":CN.isDarkMode&&(C="#8f8f9d",y="#42414d");const w=15,v=w*l.sx,E=w*l.sy,_=new OffscreenCanvas(v*2,E*2),k=_.getContext("2d");k.fillStyle=C,k.fillRect(0,0,v*2,E*2),k.fillStyle=y,k.fillRect(0,0,v,E),k.fillRect(v,E,v,E),x.fillStyle=x.createPattern(_,"repeat"),x.fillRect(0,0,m,S),x.drawImage(c,0,0,c.width,c.height,0,0,m,S)}let f=null;if(i){let m,S;if(l.symmetric&&c.width<t&&c.height<t)m=c.width,S=c.height;else if(c=a(this,Ke),r>t||o>t){const y=Math.min(t/r,t/o);m=Math.floor(r*y),S=Math.floor(o*y),a(this,ss)||(c=A(this,be,Am).call(this,m,S))}const C=new OffscreenCanvas(m,S).getContext("2d",{willReadFrequently:!0});C.drawImage(c,0,0,c.width,c.height,0,0,m,S),f={width:m,height:S,data:C.getImageData(0,0,m,S).data}}return{canvas:d,width:u,height:h,imageData:f}}static async deserialize(t,s,i){var C;let r=null,o=!1;if(t instanceof V_){const{data:{rect:y,rotation:w,id:v,structParent:E,popupRef:_,richText:k,contentsObj:T,creationDate:L,modificationDate:R},container:N,parent:{page:{pageNumber:M}},canvas:O}=t;let V,H;O?(delete t.canvas,{id:V,bitmap:H}=i.imageManager.getFromCanvas(N.id,O),O.remove()):(o=!0,t._hasNoCanvas=!0);const te=((C=await s._structTree.getAriaAttributes(`${S1}${v}`))==null?void 0:C.get("aria-label"))||"";r=t={annotationType:oe.STAMP,bitmapId:V,bitmap:H,pageIndex:M-1,rect:y.slice(0),rotation:w,annotationElementId:v,id:v,deleted:!1,accessibilityData:{decorative:!1,altText:te},isSvg:!1,structParent:E,popupRef:_,richText:k,comment:(T==null?void 0:T.str)||null,creationDate:L,modificationDate:R}}const l=await super.deserialize(t,s,i),{rect:c,bitmap:u,bitmapUrl:h,bitmapId:d,isSvg:f,accessibilityData:m}=t;o?(i.addMissingCanvas(t.id,l),g(l,$l,!0)):d&&i.imageManager.isValidId(d)?(g(l,It,d),u&&g(l,Ke,u)):g(l,Tr,h),g(l,ss,f);const[S,x]=l.pageDimensions;return l.width=(c[2]-c[0])/S,l.height=(c[3]-c[1])/x,m&&(l.altTextData=m),l._initialData=r,t.comment&&l.setCommentData(t),g(l,hh,!!r),l}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:a(this,It),isSvg:a(this,ss)});if(this.addComment(i),t)return i.bitmapUrl=A(this,be,Em).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=A(this,be,Tk).call(this,i);return c.isSame?null:(c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(s===null)return i;s.stamps||(s.stamps=new Map);const l=a(this,ss)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(a(this,It)))s.stamps.set(a(this,It),{area:l,serialized:i}),i.bitmap=A(this,be,Em).call(this,!1);else if(a(this,ss)){const c=s.stamps.get(a(this,It));l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=A(this,be,Em).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Ke=new WeakMap,It=new WeakMap,Wo=new WeakMap,Tr=new WeakMap,Xo=new WeakMap,uh=new WeakMap,Pr=new WeakMap,$l=new WeakMap,ji=new WeakMap,ss=new WeakMap,hh=new WeakMap,be=new WeakSet,xd=function(t,s=!1){if(!t){this.remove();return}g(this,Ke,t.bitmap),s||(g(this,It,t.id),g(this,ss,t.isSvg)),t.file&&g(this,uh,t.file.name),A(this,be,bm).call(this)},Sd=function(){if(g(this,Wo,null),this._uiManager.enableWaiting(!1),!!a(this,Pr)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&a(this,Ke)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&a(this,Ke)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Sm=function(){if(a(this,It)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(a(this,It)).then(i=>A(this,be,xd).call(this,i,!0)).finally(()=>A(this,be,Sd).call(this));return}if(a(this,Tr)){const i=a(this,Tr);g(this,Tr,null),this._uiManager.enableWaiting(!0),g(this,Wo,this._uiManager.imageManager.getFromUrl(i).then(r=>A(this,be,xd).call(this,r)).finally(()=>A(this,be,Sd).call(this)));return}if(a(this,Xo)){const i=a(this,Xo);g(this,Xo,null),this._uiManager.enableWaiting(!0),g(this,Wo,this._uiManager.imageManager.getFromFile(i).then(r=>A(this,be,xd).call(this,r)).finally(()=>A(this,be,Sd).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=ty.join(",");const s=this._uiManager._signal;g(this,Wo,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,be,xd).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>A(this,be,Sd).call(this))),t.click()},bm=function(){var u;const{div:t}=this;let{width:s,height:i}=a(this,Ke);const[r,o]=this.pageDimensions,l=.75;if(this.width)s=this.width*r,i=this.height*o;else if(s>l*r||i>l*o){const h=Math.min(l*r/s,l*o/i);s*=h,i*=h}this._uiManager.enableWaiting(!1);const c=g(this,Pr,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this.width=s/r,this.height=i/o,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),A(this,be,dx).call(this),a(this,hh)||(this.parent.addUndoableEditor(this),g(this,hh,!0)),this._reportTelemetry({action:"inserted_image"}),a(this,uh)&&this.div.setAttribute("aria-description",a(this,uh)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Am=function(t,s){const{width:i,height:r}=a(this,Ke);let o=i,l=r,c=a(this,Ke);for(;o>2*t||l>2*s;){const u=o,h=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*s&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const d=new OffscreenCanvas(o,l);d.getContext("2d").drawImage(c,0,0,u,h,0,0,o,l),c=d.transferToImageBitmap()}return c},dx=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,o=new li,l=Math.ceil(i*t*o.sx),c=Math.ceil(r*s*o.sy),u=a(this,Pr);if(!u||u.width===l&&u.height===c)return;u.width=l,u.height=c;const h=a(this,ss)?a(this,Ke):A(this,be,Am).call(this,l,c),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,l,c)},Em=function(t){if(t){if(a(this,ss)){const r=this._uiManager.imageManager.getSvgUrl(a(this,It));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=a(this,Ke),s.getContext("2d").drawImage(a(this,Ke),0,0),s.toDataURL()}if(a(this,ss)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*Hr.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*Hr.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(r,o);return l.getContext("2d").drawImage(a(this,Ke),0,0,a(this,Ke).width,a(this,Ke).height,0,0,r,o),l.transferToImageBitmap()}return structuredClone(a(this,Ke))},Tk=function(t){var l;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,o=(((l=t.accessibilityData)==null?void 0:l.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}},F(hx,"_type","stamp"),F(hx,"_editorType",oe.STAMP);var Hl,dh,qo,Yo,Lr,Mn,Ko,fh,ph,ei,Nr,Ft,Rr,Qo,gh,Q,Jo,Be,fx,Pk,fi,px,gx,Cm;const $s=class $s{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:o,drawLayer:l,textLayer:c,viewport:u,l10n:h}){b(this,Be);b(this,Hl);b(this,dh,!1);b(this,qo,null);b(this,Yo,null);b(this,Lr,null);b(this,Mn,new Map);b(this,Ko,!1);b(this,fh,!1);b(this,ph,!1);b(this,ei,null);b(this,Nr,null);b(this,Ft,null);b(this,Rr,null);b(this,Qo,null);b(this,gh,-1);b(this,Q);const d=[...a($s,Jo).values()];if(!$s._initialized){$s._initialized=!0;for(const f of d)f.initialize(h,e)}e.registerEditorTypes(d),g(this,Q,e),this.pageIndex=t,this.div=s,g(this,Hl,r),g(this,qo,o),this.viewport=u,g(this,Ft,c),this.drawLayer=l,this._structTree=i,a(this,Q).addLayer(this)}get isEmpty(){return a(this,Mn).size===0}get isInvisible(){return this.isEmpty&&a(this,Q).getMode()===oe.NONE}updateToolbar(e){a(this,Q).updateToolbar(e)}updateMode(e=a(this,Q).getMode()){switch(A(this,Be,Cm).call(this),e){case oe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case oe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case oe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===oe.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const s of a($s,Jo).values())t.toggle(`${s._type}Editing`,e===s._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=a(this,Ft))==null?void 0:t.div)}setEditingState(e){a(this,Q).setEditingState(e)}addCommands(e){a(this,Q).addCommands(e)}cleanUndoStack(e){a(this,Q).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=a(this,qo))==null||t.div.classList.toggle("disabled",!e)}async enable(){var s;g(this,ph,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(s=a(this,Qo))==null||s.abort(),g(this,Qo,null);const e=new Set;for(const i of a(this,Be,fx))i.enableEditing(),i.show(!0),i.annotationElementId&&(a(this,Q).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=a(this,qo);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),a(this,Q).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}g(this,ph,!1),a(this,Q)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var s;if(g(this,fh,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),a(this,Ft)&&!a(this,Qo)){g(this,Qo,new AbortController);const i=a(this,Q).combinedSignal(a(this,Qo));a(this,Ft).div.addEventListener("pointerdown",r=>{const{clientX:l,clientY:c,timeStamp:u}=r,h=a(this,gh);if(u-h>500){g(this,gh,u);return}g(this,gh,-1);const{classList:d}=this.div;d.toggle("getElements",!0);const f=document.elementsFromPoint(l,c);if(d.toggle("getElements",!1),!this.div.contains(f[0]))return;let m;const S=new RegExp(`^${Zd}[0-9]+$`);for(const C of f)if(S.test(C.id)){m=C.id;break}if(!m)return;const x=a(this,Mn).get(m);(x==null?void 0:x.annotationElementId)===null&&(r.stopPropagation(),r.preventDefault(),x.dblclick(r))},{signal:i,capture:!0})}const e=a(this,qo);if(e){const i=new Map,r=new Map;for(const l of a(this,Be,fx)){if(l.disableEditing(),!l.annotationElementId){l.updateFakeAnnotationElement(e);continue}if(l.serialize()!==null){i.set(l.annotationElementId,l);continue}else r.set(l.annotationElementId,l);(s=this.getEditableAnnotation(l.annotationElementId))==null||s.show(),l.remove()}const o=e.getEditableAnnotations();for(const l of o){const{id:c}=l.data;if(a(this,Q).isDeletedAnnotationElement(c)){l.updateEdited({deleted:!0});continue}let u=r.get(c);if(u){u.resetAnnotationElement(l),u.show(!1),l.show();continue}u=i.get(c),u&&(a(this,Q).addChangedExistingAnnotation(u),u.renderAnnotationElement(l)&&u.show(!1)),l.show()}}A(this,Be,Cm).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const i of a($s,Jo).values())t.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),g(this,fh,!1)}getEditableAnnotation(e){var t;return((t=a(this,qo))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){a(this,Q).getActive()!==e&&a(this,Q).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=a(this,Ft))!=null&&e.div&&!a(this,Rr)){g(this,Rr,new AbortController);const t=a(this,Q).combinedSignal(a(this,Rr));a(this,Ft).div.addEventListener("pointerdown",A(this,Be,Pk).bind(this),{signal:t}),a(this,Ft).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=a(this,Ft))!=null&&e.div&&a(this,Rr)&&(a(this,Rr).abort(),g(this,Rr,null),a(this,Ft).div.classList.remove("highlighting"))}enableClick(){if(a(this,Yo))return;g(this,Yo,new AbortController);const e=a(this,Q).combinedSignal(a(this,Yo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=a(this,Yo))==null||e.abort(),g(this,Yo,null)}attach(e){a(this,Mn).set(e.id,e);const{annotationElementId:t}=e;t&&a(this,Q).isDeletedAnnotationElement(t)&&a(this,Q).removeDeletedAnnotationElement(e)}detach(e){var t;a(this,Mn).delete(e.id),(t=a(this,Hl))==null||t.removePointerInTextLayer(e.contentDiv),!a(this,fh)&&e.annotationElementId&&a(this,Q).addDeletedAnnotationElement(e)}remove(e){this.detach(e),a(this,Q).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(a(this,Q).addDeletedAnnotationElement(e.annotationElementId),He.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),a(this,Q).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!a(this,ph)),a(this,Q).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!a(this,Lr)&&(e._focusEventsAllowed=!1,g(this,Lr,setTimeout(()=>{g(this,Lr,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:a(this,Q)._signal}),t.focus())},0))),e._structTreeParentId=(s=a(this,Hl))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getEditorByUID(e){for(const t of a(this,Mn).values())if(t.uid===e)return t;return null}getNextId(){return a(this,Q).getId()}combinedSignal(e){return a(this,Q).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=a(this,Be,fi))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await a(this,Q).updateMode(e.mode);const{offsetX:s,offsetY:i}=A(this,Be,gx).call(this),r=this.getNextId(),o=A(this,Be,px).call(this,{parent:this,id:r,x:s,y:i,uiManager:a(this,Q),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=a($s,Jo).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,a(this,Q)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=A(this,Be,px).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:a(this,Q),isCentered:t,...s});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(A(this,Be,gx).call(this),!0,e)}setSelected(e){a(this,Q).setSelected(e)}toggleSelected(e){a(this,Q).toggleSelected(e)}unselect(e){a(this,Q).unselect(e)}pointerup(e){var i;const{isMac:t}=Bt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!a(this,Ko)||(g(this,Ko,!1),(i=a(this,Be,fi))!=null&&i.isDrawer&&a(this,Be,fi).supportMultipleDrawings))return;if(!a(this,dh)){g(this,dh,!0);return}const s=a(this,Q).getMode();if(s===oe.STAMP||s===oe.SIGNATURE){a(this,Q).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(a(this,Q).getMode()===oe.HIGHLIGHT&&this.enableTextSelection(),a(this,Ko)){g(this,Ko,!1);return}const{isMac:t}=Bt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(g(this,Ko,!0),(i=a(this,Be,fi))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=a(this,Q).getActive();g(this,dh,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),a(this,ei)){a(this,Be,fi).startDrawing(this,a(this,Q),!1,e);return}a(this,Q).setCurrentDrawingSession(this),g(this,ei,new AbortController);const t=a(this,Q).combinedSignal(a(this,ei));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(g(this,Nr,null),this.commitOrRemove())},{signal:t}),a(this,Be,fi).startDrawing(this,a(this,Q),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&g(this,Nr,t);return}a(this,Nr)&&setTimeout(()=>{var t;(t=a(this,Nr))==null||t.focus(),g(this,Nr,null)},0)}endDrawingSession(e=!1){return a(this,ei)?(a(this,Q).setCurrentDrawingSession(null),a(this,ei).abort(),g(this,ei,null),g(this,Nr,null),a(this,Be,fi).endDrawing(e)):null}findNewParent(e,t,s){const i=a(this,Q).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return a(this,ei)?(this.endDrawingSession(),!0):!1}onScaleChanging(){a(this,ei)&&a(this,Be,fi).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=a(this,Q).getActive())==null?void 0:e.parent)===this&&(a(this,Q).commitOrRemove(),a(this,Q).setActiveEditor(null)),a(this,Lr)&&(clearTimeout(a(this,Lr)),g(this,Lr,null));for(const s of a(this,Mn).values())(t=a(this,Hl))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,a(this,Mn).clear(),a(this,Q).removeLayer(this)}render({viewport:e}){this.viewport=e,pa(this.div,e);for(const t of a(this,Q).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){a(this,Q).commitOrRemove(),A(this,Be,Cm).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,pa(this.div,{rotation:s}),t!==s)for(const i of a(this,Mn).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return a(this,Q).viewParameters.realScale}};Hl=new WeakMap,dh=new WeakMap,qo=new WeakMap,Yo=new WeakMap,Lr=new WeakMap,Mn=new WeakMap,Ko=new WeakMap,fh=new WeakMap,ph=new WeakMap,ei=new WeakMap,Nr=new WeakMap,Ft=new WeakMap,Rr=new WeakMap,Qo=new WeakMap,gh=new WeakMap,Q=new WeakMap,Jo=new WeakMap,Be=new WeakSet,fx=function(){return a(this,Mn).size!==0?a(this,Mn).values():a(this,Q).getEditors(this.pageIndex)},Pk=function(e){a(this,Q).unselectAll();const{target:t}=e;if(t===a(this,Ft).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&a(this,Ft).div.contains(t)){const{isMac:s}=Bt.platform;if(e.button!==0||e.ctrlKey&&s)return;a(this,Q).showAllEditors("highlight",!0,!0),a(this,Ft).div.classList.add("free"),this.toggleDrawing(),ly.startHighlighting(this,a(this,Q).direction==="ltr",{target:a(this,Ft).div,x:e.x,y:e.y}),a(this,Ft).div.addEventListener("pointerup",()=>{a(this,Ft).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:a(this,Q)._signal}),e.preventDefault()}},fi=function(){return a($s,Jo).get(a(this,Q).getMode())},px=function(e){const t=a(this,Be,fi);return t?new t.prototype.constructor(e):null},gx=function(){const{x:e,y:t,width:s,height:i}=this.boundingClientRect,r=Math.max(0,e),o=Math.max(0,t),l=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),u=(r+l)/2-e,h=(o+c)/2-t,[d,f]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:d,offsetY:f}},Cm=function(){for(const e of a(this,Mn).values())e.isEmpty()&&e.remove()},F($s,"_initialized",!1),b($s,Jo,new Map([qw,ix,hx,ly,ux].map(e=>[e._editorType,e])));let uy=$s;var ti,yn,Vl,Up,Ly,Lk,Hi,mx,Nk,yx;const Et=class Et{constructor({pageIndex:e}){b(this,Hi);b(this,ti,null);b(this,yn,new Map);b(this,Vl,new Map);this.pageIndex=e}setParent(e){if(!a(this,ti)){g(this,ti,e);return}if(a(this,ti)!==e){if(a(this,yn).size>0)for(const t of a(this,yn).values())t.remove(),e.append(t);g(this,ti,e)}}static get _svgFactory(){return he(this,"_svgFactory",new af)}draw(e,t=!1,s=!1){const i=At(Et,Up)._++,r=A(this,Hi,mx).call(this),o=Et._svgFactory.createElement("defs");r.append(o);const l=Et._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),t&&a(this,Vl).set(i,l);const u=s?A(this,Hi,Nk).call(this,o,c):null,h=Et._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(r,e),a(this,yn).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=At(Et,Up)._++,i=A(this,Hi,mx).call(this),r=Et._svgFactory.createElement("defs");i.append(r);const o=Et._svgFactory.createElement("path");r.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const d=Et._svgFactory.createElement("mask");r.append(d),c=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=Et._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const m=Et._svgFactory.createElement("use");d.append(m),m.setAttribute("href",`#${l}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=Et._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${l}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return i.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(i,e),a(this,yn).set(s,i),s}finalizeDraw(e,t){a(this,Vl).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:o}=t,l=typeof e=="number"?a(this,yn).get(e):e;if(l){if(s&&A(this,Hi,yx).call(this,l,s),i&&A(c=Et,Ly,Lk).call(c,l,i),r){const{classList:u}=l;for(const[h,d]of Object.entries(r))u.toggle(h,d)}if(o){const h=l.firstChild.firstChild;A(this,Hi,yx).call(this,h,o)}}}updateParent(e,t){if(t===this)return;const s=a(this,yn).get(e);s&&(a(t,ti).append(s),a(this,yn).delete(e),a(t,yn).set(e,s))}remove(e){a(this,Vl).delete(e),a(this,ti)!==null&&(a(this,yn).get(e).remove(),a(this,yn).delete(e))}destroy(){g(this,ti,null);for(const e of a(this,yn).values())e.remove();a(this,yn).clear(),a(this,Vl).clear()}};ti=new WeakMap,yn=new WeakMap,Vl=new WeakMap,Up=new WeakMap,Ly=new WeakSet,Lk=function(e,[t,s,i,r]){const{style:o}=e;o.top=`${100*s}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*r}%`},Hi=new WeakSet,mx=function(){const e=Et._svgFactory.create(1,1,!0);return a(this,ti).append(e),e.setAttribute("aria-hidden",!0),e},Nk=function(e,t){const s=Et._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=Et._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},yx=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},b(Et,Ly),b(Et,Up,0);let hy=Et;globalThis._pdfjsTestingUtils={HighlightOutliner:Kw};globalThis.pdfjsLib={AbortException:$r,AnnotationEditorLayer:uy,AnnotationEditorParamsType:me,AnnotationEditorType:oe,AnnotationEditorUIManager:ga,AnnotationLayer:R1,AnnotationMode:Bi,AnnotationType:pt,applyOpacity:PC,build:R_,ColorPicker:of,createValidAbsoluteUrl:v1,CSSConstants:TC,DOMSVGFactory:af,DrawLayer:hy,FeatureTest:Bt,fetchData:Rh,findContrastColor:LC,getDocument:k1,getFilenameFromUrl:CC,getPdfFilenameFromUrl:_C,getRGB:Mh,getUuid:x1,getXfaPageViewport:kC,GlobalWorkerOptions:Ls,ImageKind:Nd,InvalidPDFException:ey,isDataScheme:Jp,isPdfFile:sv,isValidExplicitDest:c_,MathClamp:ln,noContextMenu:ds,normalizeUnicode:AC,OPS:Eh,OutputScale:li,PasswordResponses:SC,PDFDataRangeTransport:T1,PDFDateString:nf,PDFWorker:Ch,PermissionFlag:xC,PixelsPerInch:Hr,RenderingCancelledException:nv,renderRichText:A1,ResponseException:ef,setLayerDimensions:pa,shadow:he,SignatureExtractor:zi,stopEvent:tt,SupportedImageMimeTypes:ty,TextLayer:rf,TouchManager:sf,updateUrlHash:w1,Util:X,VerbosityLevel:Yp,version:P1,XfaLayer:b1};const JR=Object.freeze(Object.defineProperty({__proto__:null,AbortException:$r,AnnotationEditorLayer:uy,AnnotationEditorParamsType:me,AnnotationEditorType:oe,AnnotationEditorUIManager:ga,AnnotationLayer:R1,AnnotationMode:Bi,AnnotationType:pt,CSSConstants:TC,ColorPicker:of,DOMSVGFactory:af,DrawLayer:hy,FeatureTest:Bt,GlobalWorkerOptions:Ls,ImageKind:Nd,InvalidPDFException:ey,MathClamp:ln,OPS:Eh,OutputScale:li,PDFDataRangeTransport:T1,PDFDateString:nf,PDFWorker:Ch,PasswordResponses:SC,PermissionFlag:xC,PixelsPerInch:Hr,RenderingCancelledException:nv,ResponseException:ef,SignatureExtractor:zi,SupportedImageMimeTypes:ty,TextLayer:rf,TouchManager:sf,Util:X,VerbosityLevel:Yp,XfaLayer:b1,applyOpacity:PC,build:R_,createValidAbsoluteUrl:v1,fetchData:Rh,findContrastColor:LC,getDocument:k1,getFilenameFromUrl:CC,getPdfFilenameFromUrl:_C,getRGB:Mh,getUuid:x1,getXfaPageViewport:kC,isDataScheme:Jp,isPdfFile:sv,isValidExplicitDest:c_,noContextMenu:ds,normalizeUnicode:AC,renderRichText:A1,setLayerDimensions:pa,shadow:he,stopEvent:tt,updateUrlHash:w1,version:P1},Symbol.toStringTag,{value:"Module"}));function Rk(n){var e,t,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=Rk(n[e]))&&(s&&(s+=" "),s+=t)}else for(t in n)n[t]&&(s&&(s+=" "),s+=t);return s}function ov(){for(var n,e,t=0,s="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=Rk(n))&&(s&&(s+=" "),s+=e);return s}var Rb=Object.prototype.hasOwnProperty;function Mb(n,e,t){for(t of n.keys())if($c(t,e))return t}function $c(n,e){var t,s,i;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((s=n.length)===e.length)for(;s--&&$c(n[s],e[s]););return s===-1}if(t===Set){if(n.size!==e.size)return!1;for(s of n)if(i=s,i&&typeof i=="object"&&(i=Mb(e,i),!i)||!e.has(i))return!1;return!0}if(t===Map){if(n.size!==e.size)return!1;for(s of n)if(i=s[0],i&&typeof i=="object"&&(i=Mb(e,i),!i)||!$c(s[1],e.get(i)))return!1;return!0}if(t===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(t===DataView){if((s=n.byteLength)===e.byteLength)for(;s--&&n.getInt8(s)===e.getInt8(s););return s===-1}if(ArrayBuffer.isView(n)){if((s=n.byteLength)===e.byteLength)for(;s--&&n[s]===e[s];);return s===-1}if(!t||typeof n=="object"){s=0;for(t in n)if(Rb.call(n,t)&&++s&&!Rb.call(e,t)||!(t in e)||!$c(n[t],e[t]))return!1;return Object.keys(e).length===s}}return n!==n&&e!==e}function ng(n){let e=!1;return{promise:new Promise((s,i)=>{n.then(r=>!e&&s(r)).catch(r=>!e&&i(r))}),cancel(){e=!0}}}const ZR=["onCopy","onCut","onPaste"],eM=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],tM=["onFocus","onBlur"],nM=["onInput","onInvalid","onReset","onSubmit"],sM=["onLoad","onError"],iM=["onKeyDown","onKeyPress","onKeyUp"],rM=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],oM=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],aM=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],lM=["onSelect"],cM=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],uM=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],hM=["onScroll"],dM=["onWheel"],fM=["onAnimationStart","onAnimationEnd","onAnimationIteration"],pM=["onTransitionEnd"],gM=["onToggle"],mM=["onChange"],yM=[...ZR,...eM,...tM,...nM,...sM,...iM,...rM,...oM,...aM,...lM,...cM,...uM,...hM,...dM,...fM,...pM,...mM,...gM];function Mk(n,e){const t={};for(const s of yM){const i=n[s];i&&(e?t[s]=r=>i(r,e(s)):t[s]=i)}return t}var vM="Invariant failed";function Oe(n,e){if(!n)throw new Error(vM)}var wM=function(){},xM=wM;const un=Vb(xM),Dk=P.createContext(null),SM="noopener noreferrer nofollow";class bM{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Oe(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Oe(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}addLinkAttributes(e,t,s){e.href=t,e.rel=this.externalLinkRel||SM,e.target=s?"_blank":this.externalLinkTarget||""}goToDestination(e){return new Promise(t=>{Oe(this.pdfDocument),Oe(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Oe(Array.isArray(t));const s=t[0];new Promise(i=>{Oe(this.pdfDocument),s instanceof Object?this.pdfDocument.getPageIndex(s).then(r=>{i(r)}).catch(()=>{Oe(!1)}):typeof s=="number"?i(s):Oe(!1)}).then(i=>{const r=i+1;Oe(this.pdfViewer),Oe(r>=1&&r<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:i,pageNumber:r})})})}goToPage(e){const t=e-1;Oe(this.pdfViewer),Oe(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(e){this.goToDestination(e)}}function Hc({children:n,type:e}){return p.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:n})}const Db={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function AM(n,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function _h(){return P.useReducer(AM,{value:void 0,error:void 0})}const av=typeof window<"u",Ik=av&&window.location.protocol==="file:";function EM(n){return typeof n<"u"}function Sa(n){return EM(n)&&n!==null}function CM(n){return typeof n=="string"}function _M(n){return n instanceof ArrayBuffer}function kM(n){return Oe(av),n instanceof Blob}function vx(n){return CM(n)&&/^data:/.test(n)}function Ib(n){Oe(vx(n));const[e="",t=""]=n.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function TM(){return av&&window.devicePixelRatio||1}const Fk="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function Fb(){un(!Ik,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${Fk}`)}function PM(){un(!Ik,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${Fk}`)}function Zl(n){n!=null&&n.cancel&&n.cancel()}function wx(n,e){return Object.defineProperty(n,"width",{get(){return this.getViewport({scale:e}).width},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.getViewport({scale:e}).height},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.getViewport({scale:1}).width},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.getViewport({scale:1}).height},configurable:!0}),n}function jk(n){return n.name==="AbortException"||n.name==="RenderingCancelledException"}function LM(n){return new Promise((e,t)=>{const s=new FileReader;s.onload=()=>{if(!s.result)return t(new Error("Error while reading a file."));e(s.result)},s.onerror=i=>{if(!i.target)return t(new Error("Error while reading a file."));const{error:r}=i.target;if(!r)return t(new Error("Error while reading a file."));switch(r.code){case r.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case r.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case r.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},s.readAsArrayBuffer(n)})}const{PDFDataRangeTransport:NM}=JR,RM=(n,e)=>{switch(e){case Db.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");n(t);break}case Db.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");n(t);break}}};function jb(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const MM=P.forwardRef(function({children:e,className:t,error:s="Failed to load PDF file.",externalLinkRel:i,externalLinkTarget:r,file:o,inputRef:l,imageResourcesPath:c,loading:u="Loading PDF",noData:h="No PDF file specified.",onItemClick:d,onLoadError:f,onLoadProgress:m,onLoadSuccess:S,onPassword:x=RM,onSourceError:C,onSourceSuccess:y,options:w,renderMode:v,rotate:E,scale:_,...k},T){const[L,R]=_h(),{value:N,error:M}=L,[O,V]=_h(),{value:H,error:te}=O,z=P.useRef(new bM),B=P.useRef([]),D=P.useRef(void 0),U=P.useRef(void 0);o&&o!==D.current&&jb(o)&&(un(!$c(o,D.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),D.current=o),w&&w!==U.current&&(un(!$c(w,U.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),U.current=w);const K=P.useRef({scrollPageIntoView:ee=>{const{dest:re,pageNumber:ve,pageIndex:vt=ve-1}=ee;if(d){d({dest:re,pageIndex:vt,pageNumber:ve});return}const Ve=B.current[vt];if(Ve){Ve.scrollIntoView();return}un(!1,`An internal link leading to page ${ve} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});P.useImperativeHandle(T,()=>({linkService:z,pages:B,viewer:K}),[]);function le(){y&&y()}function Z(){M&&(un(!1,M.toString()),C&&C(M))}function se(){R({type:"RESET"})}P.useEffect(se,[o,R]);const _e=P.useCallback(async()=>{if(!o)return null;if(typeof o=="string")return vx(o)?{data:Ib(o)}:(Fb(),{url:o});if(o instanceof NM)return{range:o};if(_M(o))return{data:o};if(av&&kM(o))return{data:await LM(o)};if(Oe(typeof o=="object"),Oe(jb(o)),"url"in o&&typeof o.url=="string"){if(vx(o.url)){const{url:ee,...re}=o;return{data:Ib(ee),...re}}Fb()}return o},[o]);P.useEffect(()=>{const ee=ng(_e());return ee.promise.then(re=>{R({type:"RESOLVE",value:re})}).catch(re=>{R({type:"REJECT",error:re})}),()=>{Zl(ee)}},[_e,R]),P.useEffect(()=>{if(!(typeof N>"u")){if(N===!1){Z();return}le()}},[N]);function J(){H&&(S&&S(H),B.current=new Array(H.numPages),z.current.setDocument(H))}function ie(){te&&(un(!1,te.toString()),f&&f(te))}P.useEffect(function(){V({type:"RESET"})},[V,N]),P.useEffect(function(){if(!N)return;const re=w?{...N,...w}:N,ve=k1(re);m&&(ve.onProgress=m),x&&(ve.onPassword=x);const vt=ve;return vt.promise.then(Ve=>{vt.destroyed||V({type:"RESOLVE",value:Ve})}).catch(Ve=>{vt.destroyed||V({type:"REJECT",error:Ve})}),()=>{vt.destroy()}},[w,V,N]),P.useEffect(()=>{if(!(typeof H>"u")){if(H===!1){ie();return}J()}},[H]),P.useEffect(function(){z.current.setViewer(K.current),z.current.setExternalLinkRel(i),z.current.setExternalLinkTarget(r)},[i,r]);const ye=P.useCallback((ee,re)=>{B.current[ee]=re},[]),Os=P.useCallback(ee=>{delete B.current[ee]},[]),Bs=P.useMemo(()=>({imageResourcesPath:c,linkService:z.current,onItemClick:d,pdf:H,registerPage:ye,renderMode:v,rotate:E,scale:_,unregisterPage:Os}),[c,d,H,ye,v,E,_,Os]),dn=P.useMemo(()=>Mk(k,()=>H),[k,H]);function Ee(){function ee(ve){return!!(ve!=null&&ve.pdf)}if(!ee(Bs))throw new Error("pdf is undefined");const re=typeof e=="function"?e(Bs):e;return p.jsx(Dk.Provider,{value:Bs,children:re})}function I(){return o?H==null?p.jsx(Hc,{type:"loading",children:typeof u=="function"?u():u}):H===!1?p.jsx(Hc,{type:"error",children:typeof s=="function"?s():s}):Ee():p.jsx(Hc,{type:"no-data",children:typeof h=="function"?h():h})}return p.jsx("div",{className:ov("react-pdf__Document",t),ref:l,...dn,children:I()})});function Ok(){return P.useContext(Dk)}function Bk(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.filter(Boolean);if(t.length<=1){var s=t[0];return s||null}return function(r){for(var o=0,l=t;o<l.length;o++){var c=l[o];typeof c=="function"?c(r):c&&(c.current=r)}}}const zk=P.createContext(null);function lv(){return P.useContext(zk)}function DM(){const n=Ok(),e=lv();Oe(e);const t={...n,...e},{filterAnnotations:s,imageResourcesPath:i,linkService:r,onGetAnnotationsError:o,onGetAnnotationsSuccess:l,onRenderAnnotationLayerError:c,onRenderAnnotationLayerSuccess:u,page:h,pdf:d,renderForms:f,rotate:m,scale:S=1}=t;Oe(d),Oe(h),Oe(r);const[x,C]=_h(),{value:y,error:w}=x,v=P.useRef(null);un(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function E(){y&&l&&l(y)}function _(){w&&(un(!1,w.toString()),o&&o(w))}P.useEffect(function(){C({type:"RESET"})},[C,h]),P.useEffect(function(){if(!h)return;const N=ng(h.getAnnotations()),M=N;return N.promise.then(O=>{C({type:"RESOLVE",value:O})}).catch(O=>{C({type:"REJECT",error:O})}),()=>{Zl(M)}},[C,h]),P.useEffect(()=>{if(y!==void 0){if(y===!1){_();return}E()}},[y]);function k(){u&&u()}function T(R){un(!1,`${R}`),c&&c(R)}const L=P.useMemo(()=>h.getViewport({scale:S,rotation:m}),[h,m,S]);return P.useEffect(function(){if(!d||!h||!r||!y)return;const{current:N}=v;if(!N)return;const M=L.clone({dontFlip:!0}),O={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:d.annotationStorage,commentManager:null,div:N,l10n:null,linkService:r,page:h,structTreeLayer:null,viewport:M},V={annotations:s?s({annotations:y}):y,annotationStorage:d.annotationStorage,div:N,imageResourcesPath:i,linkService:r,page:h,renderForms:f,viewport:M};N.innerHTML="";try{new R1(O).render(V),k()}catch(H){T(H)}return()=>{}},[y,s,i,r,h,d,f,L]),p.jsx("div",{className:ov("react-pdf__Page__annotations","annotationLayer"),ref:v})}const Uk={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},IM=/^H(\d+)$/;function FM(n){return n in Uk}function cv(n){return"children"in n}function $k(n){return cv(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function jM(n){const e={};if(cv(n)){const{role:t}=n,s=t.match(IM);if(s)e.role="heading",e["aria-level"]=Number(s[1]);else if(FM(t)){const i=Uk[t];i&&(e.role=i)}}return e}function Hk(n){const e={};if(cv(n)){if(n.alt!==void 0&&(e["aria-label"]=n.alt),n.lang!==void 0&&(e.lang=n.lang),$k(n)){const[t]=n.children;if(t){const s=Hk(t);return{...e,...s}}}}else"id"in n&&(e["aria-owns"]=n.id);return e}function OM(n){return n?{...jM(n),...Hk(n)}:null}function Vk({className:n,node:e}){const t=P.useMemo(()=>OM(e),[e]),s=P.useMemo(()=>!cv(e)||$k(e)?null:e.children.map((i,r)=>p.jsx(Vk,{node:i},r)),[e]);return p.jsx("span",{className:n,...t,children:s})}function BM(){const n=lv();Oe(n);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=n,[s,i]=_h(),{value:r,error:o}=s,{customTextRenderer:l,page:c}=n;function u(){r&&t&&t(r)}function h(){o&&(un(!1,o.toString()),e&&e(o))}return P.useEffect(function(){i({type:"RESET"})},[i,c]),P.useEffect(function(){if(l||!c)return;const f=ng(c.getStructTree()),m=f;return f.promise.then(S=>{i({type:"RESOLVE",value:S})}).catch(S=>{i({type:"REJECT",error:S})}),()=>Zl(m)},[l,c,i]),P.useEffect(()=>{if(r!==void 0){if(r===!1){h();return}u()}},[r]),r?p.jsx(Vk,{className:"react-pdf__Page__structTree structTree",node:r}):null}const Ob=Bi;function zM(n){const e=lv();Oe(e);const t={...e,...n},{_className:s,canvasBackground:i,devicePixelRatio:r=TM(),onRenderError:o,onRenderSuccess:l,page:c,renderForms:u,renderTextLayer:h,rotate:d,scale:f}=t,{canvasRef:m}=n;Oe(c);const S=P.useRef(null);function x(){c&&l&&l(wx(c,f))}function C(E){jk(E)||(un(!1,E.toString()),o&&o(E))}const y=P.useMemo(()=>c.getViewport({scale:f*r,rotation:d}),[r,c,d,f]),w=P.useMemo(()=>c.getViewport({scale:f,rotation:d}),[c,d,f]);P.useEffect(function(){if(!c)return;c.cleanup();const{current:_}=S;if(!_)return;_.width=y.width,_.height=y.height,_.style.width=`${Math.floor(w.width)}px`,_.style.height=`${Math.floor(w.height)}px`,_.style.visibility="hidden";const k={annotationMode:u?Ob.ENABLE_FORMS:Ob.ENABLE,canvas:_,canvasContext:_.getContext("2d",{alpha:!1}),viewport:y};i&&(k.background=i);const T=c.render(k),L=T;return T.promise.then(()=>{_.style.visibility="",x()}).catch(C),()=>Zl(L)},[i,c,u,y,w]);const v=P.useCallback(()=>{const{current:E}=S;E&&(E.width=0,E.height=0)},[]);return P.useEffect(()=>v,[v]),p.jsx("canvas",{className:`${s}__canvas`,dir:"ltr",ref:Bk(m,S),style:{display:"block",userSelect:"none"},children:h?p.jsx(BM,{}):null})}function UM(n){return"str"in n}function $M(){const n=lv();Oe(n);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:s,onRenderTextLayerError:i,onRenderTextLayerSuccess:r,page:o,pageIndex:l,pageNumber:c,rotate:u,scale:h}=n;Oe(o);const[d,f]=_h(),{value:m,error:S}=d,x=P.useRef(null);un(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function C(){m&&s&&s(m)}function y(){S&&(un(!1,S.toString()),t&&t(S))}P.useEffect(function(){f({type:"RESET"})},[o,f]),P.useEffect(function(){if(!o)return;const L=ng(o.getTextContent()),R=L;return L.promise.then(N=>{f({type:"RESOLVE",value:N})}).catch(N=>{f({type:"REJECT",error:N})}),()=>Zl(R)},[o,f]),P.useEffect(()=>{if(m!==void 0){if(m===!1){y();return}C()}},[m]);const w=P.useCallback(()=>{r&&r()},[r]),v=P.useCallback(T=>{jk(T)||(un(!1,T.toString()),i&&i(T))},[i]);function E(){const T=x.current;T&&T.classList.add("selecting")}function _(){const T=x.current;T&&T.classList.remove("selecting")}const k=P.useMemo(()=>o.getViewport({scale:h,rotation:u}),[o,u,h]);return P.useLayoutEffect(function(){if(!o||!m)return;const{current:L}=x;if(!L)return;L.innerHTML="";const R=o.streamTextContent({includeMarkedContent:!0}),N={container:L,textContentSource:R,viewport:k},M=new rf(N),O=M;return M.render().then(()=>{const V=document.createElement("div");V.className="endOfContent",L.append(V);const H=L.querySelectorAll('[role="presentation"]');if(e){let te=0;m.items.forEach((z,B)=>{if(!UM(z))return;const D=H[te];if(!D)return;const U=e({pageIndex:l,pageNumber:c,itemIndex:B,...z});D.innerHTML=U,te+=z.str&&z.hasEOL?2:1})}w()}).catch(v),()=>Zl(O)},[e,v,w,o,l,c,m,k]),p.jsx("div",{className:ov("react-pdf__Page__textContent","textLayer"),onMouseUp:_,onMouseDown:E,ref:x})}const Bb=1;function Ig(n){const t={...Ok(),...n},{_className:s="react-pdf__Page",_enableRegisterUnregisterPage:i=!0,canvasBackground:r,canvasRef:o,children:l,className:c,customRenderer:u,customTextRenderer:h,devicePixelRatio:d,error:f="Failed to load the page.",filterAnnotations:m,height:S,inputRef:x,loading:C="Loading page",noData:y="No page specified.",onGetAnnotationsError:w,onGetAnnotationsSuccess:v,onGetStructTreeError:E,onGetStructTreeSuccess:_,onGetTextError:k,onGetTextSuccess:T,onLoadError:L,onLoadSuccess:R,onRenderAnnotationLayerError:N,onRenderAnnotationLayerSuccess:M,onRenderError:O,onRenderSuccess:V,onRenderTextLayerError:H,onRenderTextLayerSuccess:te,pageIndex:z,pageNumber:B,pdf:D,registerPage:U,renderAnnotationLayer:K=!0,renderForms:le=!1,renderMode:Z="canvas",renderTextLayer:se=!0,rotate:_e,scale:J=Bb,unregisterPage:ie,width:ye,...Os}=t,[Bs,dn]=_h(),{value:Ee,error:I}=Bs,ee=P.useRef(null);Oe(D);const re=Sa(B)?B-1:z??null,ve=B??(Sa(z)?z+1:null),vt=_e??(Ee?Ee.rotate:null),Ve=P.useMemo(()=>{if(!Ee)return null;let Yr=1;const rc=J??Bb;if(ye||S){const Kr=Ee.getViewport({scale:1,rotation:vt});ye?Yr=ye/Kr.width:S&&(Yr=S/Kr.height)}return rc*Yr},[S,Ee,vt,J,ye]);P.useEffect(function(){return()=>{Sa(re)&&i&&ie&&ie(re)}},[i,D,re,ie]);function Gi(){if(R){if(!Ee||!Ve)return;R(wx(Ee,Ve))}if(i&&U){if(!Sa(re)||!ee.current)return;U(re,ee.current)}}function sg(){I&&(un(!1,I.toString()),L&&L(I))}P.useEffect(function(){dn({type:"RESET"})},[dn,D,re]),P.useEffect(function(){if(!D||!ve)return;const rc=ng(D.getPage(ve)),Kr=rc;return rc.promise.then(hv=>{dn({type:"RESOLVE",value:hv})}).catch(hv=>{dn({type:"REJECT",error:hv})}),()=>Zl(Kr)},[dn,D,ve]),P.useEffect(()=>{if(Ee!==void 0){if(Ee===!1){sg();return}Gi()}},[Ee,Ve]);const Dh=P.useMemo(()=>Sa(re)&&ve&&Sa(vt)&&Sa(Ve)?{_className:s,canvasBackground:r,customTextRenderer:h,devicePixelRatio:d,filterAnnotations:m,onGetAnnotationsError:w,onGetAnnotationsSuccess:v,onGetStructTreeError:E,onGetStructTreeSuccess:_,onGetTextError:k,onGetTextSuccess:T,onRenderAnnotationLayerError:N,onRenderAnnotationLayerSuccess:M,onRenderError:O,onRenderSuccess:V,onRenderTextLayerError:H,onRenderTextLayerSuccess:te,page:Ee,pageIndex:re,pageNumber:ve,renderForms:le,renderTextLayer:se,rotate:vt,scale:Ve}:null,[s,r,h,d,m,w,v,E,_,k,T,N,M,O,V,H,te,Ee,re,ve,le,se,vt,Ve]),ig=P.useMemo(()=>Mk(Os,()=>Ee&&(Ve?wx(Ee,Ve):void 0)),[Os,Ee,Ve]),Ih=`${re}@${Ve}/${vt}`;function uv(){switch(Z){case"custom":return Oe(u),p.jsx(u,{},`${Ih}_custom`);case"none":return null;case"canvas":default:return p.jsx(zM,{canvasRef:o},`${Ih}_canvas`)}}function Wk(){return se?p.jsx($M,{},`${Ih}_text`):null}function Xk(){return K?p.jsx(DM,{},`${Ih}_annotations`):null}function qk(){function Yr(Kr){return!!(Kr!=null&&Kr.page)}if(!Yr(Dh))throw new Error("page is undefined");const rc=typeof l=="function"?l(Dh):l;return p.jsxs(zk.Provider,{value:Dh,children:[uv(),Wk(),Xk(),rc]})}function Yk(){return ve?D===null||Ee===void 0||Ee===null?p.jsx(Hc,{type:"loading",children:typeof C=="function"?C():C}):D===!1||Ee===!1?p.jsx(Hc,{type:"error",children:typeof f=="function"?f():f}):qk():p.jsx(Hc,{type:"no-data",children:typeof y=="function"?y():y})}return p.jsx("div",{className:ov(s,c),"data-page-number":ve,ref:Bk(x,ee),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${Ve}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:r||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...ig,children:Yk()})}PM();Ls.workerSrc="pdf.worker.mjs";Ls.workerSrc=`//unpkg.com/pdfjs-dist@${P1}/build/pdf.worker.min.mjs`;const Qv=[.5,.75,1,1.25,1.5],HM=2;function VM(){const{bookId:n}=sL(),e=Xp(),[t,s]=P.useState(null),[i,r]=P.useState(!0),[o,l]=P.useState(null),[c,u]=P.useState(!1),[h,d]=P.useState(0),[f,m]=P.useState(0),[S,x]=P.useState(HM),[C,y]=P.useState(!1),[w,v]=P.useState(null),[E,_]=P.useState(!1),[k,T]=P.useState(new Set),L=Qv[S],R=f===0,N=R?1:(f-1)*2+2,M=R?0:N+1,O=h>0?1+Math.ceil((h-1)/2):0,V=P.useMemo(()=>{const J=new Set;return J.add(N),M>0&&M<=h&&J.add(M),N>1&&J.add(N-1),N>2&&J.add(N-2),N<h&&J.add(N+1),N+1<h&&J.add(N+2),Array.from(J).filter(ie=>ie>=1&&ie<=h)},[N,M,h]);P.useEffect(()=>{(async()=>{if(!n){l("ID do livro no fornecido"),r(!1);return}try{const ie=await lc.getById(n);s(ie)}catch(ie){l("Erro ao carregar o livro"),console.error(ie)}finally{r(!1)}})()},[n]),P.useEffect(()=>{if(t&&!i){const J=setTimeout(()=>_(!0),300);return()=>clearTimeout(J)}},[t,i]),P.useEffect(()=>{const J=ie=>ie.preventDefault();return document.addEventListener("contextmenu",J),()=>document.removeEventListener("contextmenu",J)},[]),P.useEffect(()=>{const J=ie=>{ie.key==="ArrowRight"||ie.key===" "?(ie.preventDefault(),z()):ie.key==="ArrowLeft"?(ie.preventDefault(),B()):ie.key==="Home"?(ie.preventDefault(),m(0)):ie.key==="End"&&(ie.preventDefault(),m(Math.max(0,O-1)))};return document.addEventListener("keydown",J),()=>document.removeEventListener("keydown",J)},[O]),P.useEffect(()=>{const J=()=>u(!!document.fullscreenElement);return document.addEventListener("fullscreenchange",J),()=>document.removeEventListener("fullscreenchange",J)},[]);const H=P.useCallback(({numPages:J})=>{d(J)},[]),te=P.useCallback(J=>{T(ie=>new Set(ie).add(J))},[]),z=P.useCallback(()=>{f<O-1&&!C&&(y(!0),v("next"),setTimeout(()=>{m(J=>J+1),setTimeout(()=>{y(!1),v(null)},500)},500))},[f,O,C]),B=P.useCallback(()=>{f>0&&!C&&(y(!0),v("prev"),setTimeout(()=>{m(J=>J-1),setTimeout(()=>{y(!1),v(null)},500)},500))},[f,C]),D=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()},U=()=>{S<Qv.length-1&&x(J=>J+1)},K=()=>{S>0&&x(J=>J-1)},le=()=>e(-1);if(i)return p.jsxs("div",{className:"book-reader-loading",children:[p.jsx(Ds,{size:48,className:"spin"}),p.jsx("p",{children:"Carregando livro..."})]});if(o||!t)return p.jsxs("div",{className:"book-reader-error",children:[p.jsx(fa,{size:48}),p.jsx("h2",{children:"Erro ao carregar"}),p.jsx("p",{children:o||"Livro no encontrado"}),p.jsxs("button",{className:"btn btn-primary",onClick:le,children:[p.jsx(Uv,{size:20}),"Voltar"]})]});if(!t.pdf_url)return p.jsxs("div",{className:"book-reader-error",children:[p.jsx(fa,{size:48}),p.jsx("h2",{children:"PDF no disponvel"}),p.jsx("p",{children:"Este livro ainda no possui um arquivo PDF associado."}),p.jsxs("button",{className:"btn btn-primary",onClick:le,children:[p.jsx(Uv,{size:20}),"Voltar"]})]});const Z=zc.getPdfUrl(t.pdf_url),se=k.has(N)&&(R||M>h||k.has(M)),_e=R?`Capa (Pgina 1) de ${h}`:M<=h?`Pginas ${N} - ${M} de ${h}`:`Pgina ${N} de ${h}`;return p.jsxs("div",{className:`book-reader ${c?"fullscreen":""}`,children:[p.jsxs("div",{className:"reader-header",children:[p.jsx("button",{className:"btn btn-icon",onClick:le,title:"Voltar",children:p.jsx(Uv,{size:20})}),p.jsxs("div",{className:"reader-title",children:[p.jsx("h1",{children:t.title}),p.jsx("span",{className:"reader-author",children:t.author})]}),p.jsxs("div",{className:"reader-controls",children:[p.jsxs("div",{className:"zoom-controls",children:[p.jsx("button",{className:"btn btn-icon",onClick:K,disabled:S===0,children:p.jsx(rN,{size:18})}),p.jsxs("span",{className:"zoom-level",children:[Math.round(L*100),"%"]}),p.jsx("button",{className:"btn btn-icon",onClick:U,disabled:S===Qv.length-1,children:p.jsx(iN,{size:18})})]}),p.jsx("div",{className:"control-divider"}),p.jsx("button",{className:"btn btn-icon",onClick:D,children:c?p.jsx(tN,{size:20}):p.jsx(eN,{size:20})})]})]}),p.jsxs("div",{className:"reader-content",children:[p.jsxs("div",{className:`book-container ${E?"open":""} ${R?"cover-mode":""}`,children:[p.jsx("button",{className:"nav-arrow nav-prev",onClick:B,disabled:f===0||C,children:p.jsx(GL,{size:32})}),p.jsx("div",{className:`book-spread ${C?`flipping-${w}`:""} ${R?"single-page":""}`,children:p.jsxs(MM,{file:Z,onLoadSuccess:H,loading:p.jsx("div",{className:"page-loading",children:p.jsx(Ds,{size:32,className:"spin"})}),error:p.jsx("div",{className:"page-error",children:"Erro ao carregar PDF"}),children:[p.jsx("div",{className:"preload-container",children:V.map(J=>p.jsx(Ig,{pageNumber:J,scale:L,renderTextLayer:!1,renderAnnotationLayer:!1,onLoadSuccess:()=>te(J),className:"preload-page"},`preload-${J}`))}),R?p.jsxs("div",{className:"book-page cover-page",children:[p.jsx("div",{className:"page-inner",children:p.jsx(Ig,{pageNumber:1,scale:L,renderTextLayer:!1,renderAnnotationLayer:!1,loading:""})}),p.jsx("div",{className:"cover-shadow"})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:`book-page left-page ${w==="prev"?"flip-in":""}`,children:[p.jsx("div",{className:"page-inner",children:N<=h&&p.jsx(Ig,{pageNumber:N,scale:L,renderTextLayer:!1,renderAnnotationLayer:!1,loading:""})}),p.jsx("div",{className:"page-shadow left-shadow"})]}),p.jsx("div",{className:"book-spine"}),p.jsxs("div",{className:`book-page right-page ${w==="next"?"flip-out":""}`,children:[p.jsx("div",{className:"page-inner",children:M<=h&&p.jsx(Ig,{pageNumber:M,scale:L,renderTextLayer:!1,renderAnnotationLayer:!1,loading:""})}),p.jsx("div",{className:"page-shadow right-shadow"})]})]})]})}),p.jsx("button",{className:"nav-arrow nav-next",onClick:z,disabled:f>=O-1||C,children:p.jsx(vC,{size:32})})]}),!se&&h>0&&p.jsx("div",{className:"page-loading-overlay",children:p.jsx(Ds,{size:32,className:"spin"})})]}),p.jsxs("div",{className:"reader-footer",children:[p.jsx("div",{className:"reader-info",children:p.jsx("span",{className:"badge",children:t.curriculum_component})}),p.jsx("div",{className:"page-indicator",children:p.jsx("span",{children:_e})}),p.jsx("div",{className:"reader-shortcuts",children:p.jsx("span",{children:"  Navegar"})})]})]})}const GM="modulepreload",WM=function(n){return"/"+n},zb={},XM=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(c=>{if(c=WM(c),c in zb)return;zb[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":GM,u||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((f,m)=>{d.addEventListener("load",f),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})},qM=[{value:"student",label:"Livro do Aluno"},{value:"professor",label:"Livro do Professor"}],YM=["Matemtica","Lngua Portuguesa","Cincias","Histria","Geografia","Ingls","Artes","Educao Fsica","Filosofia","Sociologia"],KM=["1 ANO","2 ANO","3 ANO","4 ANO","5 ANO"];function QM({onFilterChange:n,showProfessorFilter:e=!0,showStudentFilter:t=!0}){const{getUsersByRole:s}=qr(),[i,r]=P.useState({search:"",curriculumComponent:"all",classGroup:"all",professorId:"all",studentId:"all"}),[o,l]=P.useState(!1),c=s("professor"),u=s("student"),h=(m,S)=>{const x={...i,[m]:S};r(x),n(x)},d=()=>{const m={search:"",curriculumComponent:"all",classGroup:"all",professorId:"all",studentId:"all"};r(m),n(m)},f=i.search||i.curriculumComponent&&i.curriculumComponent!=="all"||i.classGroup&&i.classGroup!=="all"||i.professorId&&i.professorId!=="all"||i.studentId&&i.studentId!=="all";return p.jsxs("div",{className:"book-filters",children:[p.jsxs("div",{className:"filters-main",children:[p.jsxs("div",{className:"search-filter",children:[p.jsx(Jy,{size:18,className:"search-icon"}),p.jsx("input",{type:"text",placeholder:"Buscar por ttulo, autor...",value:i.search,onChange:m=>h("search",m.target.value),className:"search-input"})]}),p.jsxs("button",{className:`filter-toggle ${o?"active":""} ${f?"has-filters":""}`,onClick:()=>l(!o),children:[p.jsx(qL,{size:18}),"Filtros",f&&p.jsx("span",{className:"filter-badge"})]}),f&&p.jsxs("button",{className:"clear-filters",onClick:d,children:[p.jsx(qp,{size:16}),"Limpar"]})]}),o&&p.jsxs("div",{className:"filters-expanded",children:[p.jsxs("div",{className:"filter-group",children:[p.jsx("label",{children:"Componente Curricular"}),p.jsxs("select",{value:i.curriculumComponent,onChange:m=>h("curriculumComponent",m.target.value),className:"select",children:[p.jsx("option",{value:"all",children:"Todos os componentes"}),YM.map(m=>p.jsx("option",{value:m,children:m},m))]})]}),p.jsxs("div",{className:"filter-group",children:[p.jsx("label",{children:"Turma"}),p.jsxs("select",{value:i.classGroup,onChange:m=>h("classGroup",m.target.value),className:"select",children:[p.jsx("option",{value:"all",children:"Todas as turmas"}),KM.map(m=>p.jsx("option",{value:m,children:m},m))]})]}),e&&p.jsxs("div",{className:"filter-group",children:[p.jsx("label",{children:"Professor"}),p.jsxs("select",{value:i.professorId,onChange:m=>h("professorId",m.target.value),className:"select",children:[p.jsx("option",{value:"all",children:"Todos os professores"}),c.map(m=>p.jsx("option",{value:m.id,children:m.name},m.id))]})]}),t&&p.jsxs("div",{className:"filter-group",children:[p.jsx("label",{children:"Aluno"}),p.jsxs("select",{value:i.studentId,onChange:m=>h("studentId",m.target.value),className:"select",children:[p.jsx("option",{value:"all",children:"Todos os alunos"}),u.map(m=>p.jsx("option",{value:m.id,children:m.name},m.id))]})]})]})]})}const Ub=n=>n?zc.getFileUrl(n):"https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?w=400&h=600&fit=crop";function JM(){const n=Xp(),{addBook:e,updateBook:t,deleteBook:s,filterBooks:i}=y1(),[r,o]=P.useState(!1),[l,c]=P.useState(null),[u,h]=P.useState({}),[d,f]=P.useState({title:"",author:"",description:"",coverUrl:"",pdfUrl:"",curriculumComponent:"",bookType:"student",classGroups:[]}),[m,S]=P.useState([]),[x,C]=P.useState([]);P.useEffect(()=>{y(),w()},[]);const y=async()=>{try{const I=await Zh.getAll();S(I),I.length>0&&!d.curriculumComponent&&f(ee=>({...ee,curriculumComponent:I[0].name}))}catch(I){console.error("Error loading curriculum components:",I)}},w=async()=>{try{const I=await ed.getAll();C(I)}catch(I){console.error("Error loading series:",I)}},[v,E]=P.useState(null),[_,k]=P.useState(!1),[T,L]=P.useState(null),[R,N]=P.useState(!1),M=P.useRef(null),[O,V]=P.useState(null),[H,te]=P.useState(!1),[z,B]=P.useState(null),[D,U]=P.useState(!1),K=P.useRef(null),le=i(u),Z=I=>{I?(c(I),f({title:I.title,author:I.author,description:I.description,coverUrl:I.cover_url||"",pdfUrl:I.pdf_url||"",curriculumComponent:I.curriculum_component||"",bookType:I.book_type||"student",classGroups:I.class_groups||[]}),E(null),N(!!I.pdf_url),V(null),U(!!I.cover_url)):(c(null),f({title:"",author:"",description:"",coverUrl:"",pdfUrl:"",curriculumComponent:"Matemtica",bookType:"student",classGroups:[]}),E(null),N(!1),V(null),U(!1)),o(!0)},se=()=>{o(!1),c(null),f({title:"",author:"",description:"",coverUrl:"",pdfUrl:"",curriculumComponent:"Matemtica",bookType:"student",classGroups:[]}),E(null),L(null),N(!1),V(null),B(null),U(!1)},_e=async I=>{I.preventDefault();const ee=d.coverUrl||"https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?w=400&h=600&fit=crop",re={title:d.title,author:d.author,description:d.description,cover_url:ee,pdf_url:d.pdfUrl||void 0,curriculum_component:d.curriculumComponent,book_type:d.bookType,class_groups:d.classGroups};try{l?await t(l.id,re):await e(re),se()}catch(ve){console.error("Error saving book:",ve)}},J=I=>{var re;const ee=(re=I.target.files)==null?void 0:re[0];if(ee){if(!ee.type.startsWith("image/")){B("Apenas arquivos de imagem so permitidos");return}if(ee.size>5*1024*1024){B("A imagem deve ter no mximo 5MB");return}V(ee),B(null),U(!1)}},ie=async()=>{if(O){te(!0),B(null);try{const I=await zc.uploadImage(O);I.imageUrl&&(f(ee=>({...ee,coverUrl:I.imageUrl})),U(!0),V(null))}catch(I){B(I instanceof Error?I.message:"Erro ao fazer upload")}finally{te(!1)}}},ye=I=>{var re;const ee=(re=I.target.files)==null?void 0:re[0];if(ee){if(ee.type!=="application/pdf"){L("Apenas arquivos PDF so permitidos");return}if(ee.size>50*1024*1024){L("O arquivo deve ter no mximo 50MB");return}E(ee),L(null),N(!1)}},Os=async()=>{if(v){k(!0),L(null);try{const ee=(await zc.uploadPdf(v)).pdfUrl;try{const re=await Bs(v);f(re?ve=>({...ve,pdfUrl:ee||"",coverUrl:re}):ve=>({...ve,pdfUrl:ee||""}))}catch(re){console.error("Error auto-generating cover:",re),f(ve=>({...ve,pdfUrl:ee||""}))}N(!0),E(null)}catch(I){L(I instanceof Error?I.message:"Erro ao fazer upload")}finally{k(!1)}}},Bs=async I=>{try{const ee=await XM(()=>import("./pdf-D9U_qkVv.js"),[]);ee.GlobalWorkerOptions.workerSrc="/pdf.worker.min.mjs";const re=await I.arrayBuffer(),vt=await(await ee.getDocument({data:re}).promise).getPage(1),Ve=vt.getViewport({scale:1.5}),Gi=document.createElement("canvas"),sg=Gi.getContext("2d");if(!sg)return null;Gi.height=Ve.height,Gi.width=Ve.width;const Dh={canvasContext:sg,viewport:Ve};await vt.render(Dh).promise;const ig=await new Promise(uv=>Gi.toBlob(uv,"image/jpeg",.8));return ig&&(await zc.uploadImage(ig)).imageUrl||null}catch(ee){return console.error("Failed to generate PDF cover:",ee),null}},dn=I=>{confirm("Tem certeza que deseja excluir este livro?")&&s(I)},Ee=I=>{d.classGroups.includes(I)?f({...d,classGroups:d.classGroups.filter(ee=>ee!==I)}):f({...d,classGroups:[...d.classGroups,I]})};return p.jsxs("div",{className:"manage-books animate-fadeIn",children:[p.jsxs("div",{className:"page-header",children:[p.jsx("h1",{children:"Gerenciar Livros"}),p.jsxs("button",{className:"btn btn-primary",onClick:()=>Z(),children:[p.jsx(Qy,{size:20}),"Adicionar Livro"]})]}),p.jsx(QM,{onFilterChange:h}),p.jsx("div",{className:"books-grid",children:le.map(I=>{const ee=Ub(I.cover_url),re=I.cover_url&&!I.cover_url.includes("unsplash");return p.jsxs("div",{className:"book-card animate-slideUp",children:[p.jsx("div",{className:"book-card-cover-container",children:re?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"book-card-cover-blur",style:{backgroundImage:`url(${ee})`}}),p.jsx("img",{src:ee,alt:I.title,className:"book-card-cover",style:{position:"relative",zIndex:1},onError:ve=>{var Gi;const vt=ve.target;vt.style.display="none";const Ve=(Gi=vt.parentElement)==null?void 0:Gi.querySelector(".book-cover-placeholder");Ve&&(Ve.style.display="flex")}}),p.jsxs("div",{className:"book-cover-placeholder",style:{display:"none"},children:[p.jsx(Vh,{size:48}),p.jsx("span",{children:"Sem Capa"})]})]}):p.jsxs("div",{className:"book-cover-placeholder",children:[p.jsx(Vh,{size:48}),p.jsx("span",{children:"Sem Capa"})]})}),p.jsxs("div",{className:"book-card-content",children:[p.jsxs("div",{className:"book-card-badges",children:[p.jsx("span",{className:`badge badge-${I.book_type}`,children:I.book_type==="professor"?"Professor":"Aluno"}),p.jsx("span",{className:"badge badge-component",children:I.curriculum_component})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"book-name",title:I.title,children:I.title}),p.jsx("span",{className:"book-author",children:I.author})]}),p.jsxs("div",{className:"class-tags",children:[(I.class_groups||[]).slice(0,3).map(ve=>p.jsx("span",{className:"class-tag",children:ve},ve)),(I.class_groups||[]).length>3&&p.jsxs("span",{className:"class-tag-more",children:["+",(I.class_groups||[]).length-3]})]}),p.jsx("div",{className:"book-card-footer",children:p.jsxs("div",{className:"book-card-actions",children:[p.jsx("button",{className:"btn btn-icon",onClick:()=>I.pdf_url&&n(`/reader/${I.id}`),title:I.pdf_url?"Visualizar":"Sem PDF",disabled:!I.pdf_url,children:p.jsx(XL,{size:18})}),p.jsx("button",{className:"btn btn-icon",onClick:()=>Z(I),title:"Editar",children:p.jsx(Ky,{size:18})}),p.jsx("button",{className:"btn btn-icon danger",onClick:()=>dn(I.id),title:"Excluir",children:p.jsx(Zy,{size:18})})]})})]})]},I.id)})}),le.length===0&&p.jsxs("div",{className:"text-center text-muted",style:{padding:"4rem"},children:[p.jsx(Vh,{size:48,style:{opacity:.2,marginBottom:"1rem"}}),p.jsx("p",{children:"Nenhum livro encontrado com os filtros selecionados."})]}),r&&p.jsx("div",{className:"modal-overlay",onClick:se,children:p.jsxs("div",{className:"modal modal-lg",onClick:I=>I.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:l?"Editar Livro":"Adicionar Livro"}),p.jsx("button",{className:"btn btn-icon",onClick:se,children:p.jsx(qp,{size:20})})]}),p.jsxs("form",{onSubmit:_e,children:[p.jsxs("div",{className:"modal-body",children:[p.jsxs("div",{className:"form-grid",children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Ttulo"}),p.jsx("input",{type:"text",className:"input",value:d.title,onChange:I=>f({...d,title:I.target.value}),required:!0})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Autor"}),p.jsx("input",{type:"text",className:"input",value:d.author,onChange:I=>f({...d,author:I.target.value}),required:!0})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Descrio"}),p.jsx("textarea",{className:"input textarea",value:d.description,onChange:I=>f({...d,description:I.target.value}),rows:3,required:!0})]}),p.jsxs("div",{className:"form-grid",children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Componente Curricular"}),p.jsx("select",{className:"select",value:d.curriculumComponent,onChange:I=>f({...d,curriculumComponent:I.target.value}),required:!0,children:m.map(I=>p.jsx("option",{value:I.name,children:I.name},I.id))})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Tipo de Livro"}),p.jsx("select",{className:"select",value:d.bookType,onChange:I=>f({...d,bookType:I.target.value}),required:!0,children:qM.map(I=>p.jsx("option",{value:I.value,children:I.label},I.value))})]})]}),p.jsx("div",{className:"form-grid",children:p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Capa do Livro"}),p.jsx("div",{className:"tabs-container mb-2",children:p.jsxs("div",{className:"pdf-upload-container",children:[p.jsx("input",{ref:K,type:"file",accept:"image/*",onChange:J,style:{display:"none"}}),O?p.jsxs("div",{className:"pdf-selected",children:[p.jsx(Vh,{size:20}),p.jsx("span",{className:"pdf-filename",children:O.name}),p.jsxs("span",{className:"pdf-size",children:["(",(O.size/1024/1024).toFixed(2)," MB)"]}),p.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:ie,disabled:H,children:H?p.jsxs(p.Fragment,{children:[p.jsx(Ds,{size:16,className:"spin"})," Enviando..."]}):p.jsxs(p.Fragment,{children:[p.jsx(Ag,{size:16})," Enviar"]})})]}):p.jsxs("div",{className:"upload-area",onClick:()=>{var I;return(I=K.current)==null?void 0:I.click()},children:[p.jsx(Ag,{size:32}),p.jsx("span",{children:"Clique para selecionar uma capa"}),p.jsx("span",{className:"upload-hint",children:"Formatos: JPG, PNG (Max 5MB)"})]}),z&&p.jsx("p",{className:"upload-error",children:z}),D&&p.jsx("p",{className:"upload-success",children:"Capa enviada com sucesso!"}),d.coverUrl&&!O&&p.jsx("div",{className:"mt-2",style:{width:"100px",height:"140px",background:"#ccc",borderRadius:"4px",overflow:"hidden"},children:p.jsx("img",{src:Ub(d.coverUrl),alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover"}})})]})})]})}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Turmas"}),p.jsx("div",{className:"class-grid",children:x.map(I=>p.jsxs("label",{className:`class-checkbox ${d.classGroups.includes(I.name)?"checked":""}`,children:[p.jsx("input",{type:"checkbox",checked:d.classGroups.includes(I.name),onChange:()=>Ee(I.name)}),p.jsx("span",{children:I.name})]},I.id))})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Arquivo PDF"}),p.jsxs("div",{className:"pdf-upload-container",children:[p.jsx("input",{ref:M,type:"file",accept:".pdf,application/pdf",onChange:ye,style:{display:"none"}}),d.pdfUrl&&!v?p.jsxs("div",{className:"pdf-uploaded",children:[p.jsx(VL,{size:20,className:"text-success"}),p.jsx("span",{children:"PDF anexado"}),p.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>f({...d,pdfUrl:""}),children:"Remover"})]}):v?p.jsxs("div",{className:"pdf-selected",children:[p.jsx(Vh,{size:20}),p.jsx("span",{className:"pdf-filename",children:v.name}),p.jsxs("span",{className:"pdf-size",children:["(",(v.size/1024/1024).toFixed(2)," MB)"]}),p.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:Os,disabled:_,children:_?p.jsxs(p.Fragment,{children:[p.jsx(Ds,{size:16,className:"spin"})," Enviando..."]}):p.jsxs(p.Fragment,{children:[p.jsx(Ag,{size:16})," Enviar"]})})]}):p.jsxs("div",{className:"upload-area",onClick:()=>{var I;return(I=M.current)==null?void 0:I.click()},children:[p.jsx(Ag,{size:32}),p.jsx("span",{children:"Clique para selecionar um PDF"}),p.jsx("span",{className:"upload-hint",children:"Mximo 50MB"})]}),T&&p.jsx("p",{className:"upload-error",children:T}),R&&p.jsx("p",{className:"upload-success",children:"PDF enviado com sucesso!"})]})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:se,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"btn btn-primary",children:l?"Salvar":"Adicionar"})]})]})]})})]})}function ZM(){const{users:n,addUser:e,updateUser:t,deleteUser:s,getUsersByRole:i}=qr(),[r,o]=P.useState(!1),[l,c]=P.useState(null),[u,h]=P.useState("all"),[d,f]=P.useState({name:"",email:"",password:"",role:"student",class_group:""}),m=n.filter(w=>u==="all"?!0:w.role===u),S=w=>{w?(c(w),f({name:w.name,email:w.email,password:"",role:w.role,class_group:w.class_group||""})):(c(null),f({name:"",email:"",password:"",role:"student",class_group:""})),o(!0)},x=()=>{o(!1),c(null),f({name:"",email:"",password:"",role:"student",class_group:""})},C=w=>{w.preventDefault();const v={name:d.name,email:d.email,role:d.role,...d.password?{password:d.password}:{},...d.role==="student"&&d.class_group?{class_group:d.class_group}:{}};l?t(l.id,v):e(v),x()},y=w=>{confirm("Tem certeza que deseja excluir este usurio?")&&s(w)};return p.jsxs("div",{className:"manage-users animate-fadeIn",children:[p.jsxs("div",{className:"page-header",children:[p.jsx("h1",{children:"Gerenciar Usurios"}),p.jsxs("button",{className:"btn btn-primary",onClick:()=>S(),children:[p.jsx(Qy,{size:20}),"Adicionar Usurio"]})]}),p.jsxs("div",{className:"filter-tabs",children:[p.jsxs("button",{className:`filter-tab ${u==="all"?"active":""}`,onClick:()=>h("all"),children:["Todos (",n.length,")"]}),p.jsxs("button",{className:`filter-tab ${u==="admin"?"active":""}`,onClick:()=>h("admin"),children:["Admins (",i("admin").length,")"]}),p.jsxs("button",{className:`filter-tab ${u==="professor"?"active":""}`,onClick:()=>h("professor"),children:["Professores (",i("professor").length,")"]}),p.jsxs("button",{className:`filter-tab ${u==="student"?"active":""}`,onClick:()=>h("student"),children:["Alunos (",i("student").length,")"]})]}),p.jsx("div",{className:"users-table-container",children:p.jsxs("table",{className:"table",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Usurio"}),p.jsx("th",{children:"Email"}),p.jsx("th",{children:"Perfil"}),p.jsx("th",{children:"Turma"}),p.jsx("th",{children:"Aes"})]})}),p.jsx("tbody",{children:m.map(w=>p.jsxs("tr",{children:[p.jsx("td",{children:p.jsxs("div",{className:"user-cell",children:[p.jsx("img",{src:w.avatar,alt:w.name,className:"user-avatar"}),p.jsx("span",{className:"user-name",children:w.name})]})}),p.jsx("td",{children:w.email}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${w.role}`,children:w.role})}),p.jsx("td",{children:w.class_group||"-"}),p.jsx("td",{children:p.jsxs("div",{className:"actions",children:[p.jsx("button",{className:"btn btn-icon",onClick:()=>S(w),title:"Editar",children:p.jsx(Ky,{size:18})}),p.jsx("button",{className:"btn btn-icon danger",onClick:()=>y(w.id),title:"Excluir",children:p.jsx(Zy,{size:18})})]})})]},w.id))})]})}),r&&p.jsx("div",{className:"modal-overlay",onClick:x,children:p.jsxs("div",{className:"modal",onClick:w=>w.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:l?"Editar Usurio":"Adicionar Usurio"}),p.jsx("button",{className:"btn btn-icon",onClick:x,children:p.jsx(qp,{size:20})})]}),p.jsxs("form",{onSubmit:C,children:[p.jsxs("div",{className:"modal-body",children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Nome Completo"}),p.jsx("input",{type:"text",className:"input",value:d.name,onChange:w=>f({...d,name:w.target.value}),required:!0})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Email"}),p.jsx("input",{type:"email",className:"input",value:d.email,onChange:w=>f({...d,email:w.target.value}),required:!0})]}),p.jsxs("div",{className:"input-group",children:[p.jsxs("label",{children:["Senha ",l&&"(deixe em branco para manter)"]}),p.jsx("input",{type:"password",className:"input",value:d.password,onChange:w=>f({...d,password:w.target.value}),required:!l,placeholder:l?"":""})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Perfil"}),p.jsxs("select",{className:"select",value:d.role,onChange:w=>f({...d,role:w.target.value}),children:[p.jsx("option",{value:"admin",children:"Administrador"}),p.jsx("option",{value:"professor",children:"Professor"}),p.jsx("option",{value:"student",children:"Aluno"})]})]}),d.role==="student"&&p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Turma"}),p.jsxs("select",{className:"select",value:d.class_group,onChange:w=>f({...d,class_group:w.target.value}),children:[p.jsx("option",{value:"",children:"Selecione uma turma"}),mC.map(w=>p.jsx("option",{value:w,children:w},w))]})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:x,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"btn btn-primary",children:l?"Salvar":"Adicionar"})]})]})]})})]})}function eD(){const[n,e]=P.useState([]),[t,s]=P.useState(!0),[i,r]=P.useState(!1),[o,l]=P.useState(null),[c,u]=P.useState(""),[h,d]=P.useState(null),[f,m]=P.useState(!1);P.useEffect(()=>{S()},[]);const S=async()=>{try{const v=await Zh.getAll();e(v)}catch(v){console.error("Error loading components:",v)}finally{s(!1)}},x=v=>{v?(l(v),u(v.name)):(l(null),u("")),d(null),r(!0)},C=()=>{r(!1),l(null),u(""),d(null)},y=async v=>{if(v.preventDefault(),!c.trim()){d("Nome  obrigatrio");return}m(!0),d(null);try{if(o){const E=await Zh.update(o.id,c.trim());e(_=>_.map(k=>k.id===E.id?E:k))}else{const E=await Zh.create(c.trim());e(_=>[..._,E].sort((k,T)=>k.name.localeCompare(T.name)))}C()}catch(E){d(E instanceof Error?E.message:"Erro ao salvar")}finally{m(!1)}},w=async v=>{if(confirm(`Tem certeza que deseja excluir "${v.name}"?`))try{await Zh.delete(v.id),e(E=>E.filter(_=>_.id!==v.id))}catch(E){alert(E instanceof Error?E.message:"Erro ao excluir")}};return t?p.jsxs("div",{className:"loading-container",children:[p.jsx(Ds,{size:32,className:"spin"}),p.jsx("p",{children:"Carregando componentes..."})]}):p.jsxs("div",{className:"manage-curriculum animate-fadeIn",children:[p.jsxs("div",{className:"page-header",children:[p.jsx("h1",{children:"Componentes Curriculares"}),p.jsxs("button",{className:"btn btn-primary",onClick:()=>x(),children:[p.jsx(Qy,{size:20}),"Adicionar Componente"]})]}),p.jsxs("div",{className:"curriculum-grid",children:[n.map(v=>p.jsxs("div",{className:"curriculum-card",children:[p.jsx("div",{className:"curriculum-icon",children:p.jsx(fa,{size:24})}),p.jsx("div",{className:"curriculum-info",children:p.jsx("h3",{children:v.name})}),p.jsxs("div",{className:"curriculum-actions",children:[p.jsx("button",{className:"btn btn-icon",onClick:()=>x(v),title:"Editar",children:p.jsx(Ky,{size:18})}),p.jsx("button",{className:"btn btn-icon danger",onClick:()=>w(v),title:"Excluir",children:p.jsx(Zy,{size:18})})]})]},v.id)),n.length===0&&p.jsxs("div",{className:"empty-state",children:[p.jsx(fa,{size:48}),p.jsx("p",{children:"Nenhum componente curricular cadastrado"}),p.jsx("button",{className:"btn btn-primary",onClick:()=>x(),children:"Adicionar Primeiro Componente"})]})]}),i&&p.jsx("div",{className:"modal-overlay",onClick:C,children:p.jsxs("div",{className:"modal",onClick:v=>v.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:o?"Editar Componente":"Adicionar Componente"}),p.jsx("button",{className:"btn btn-icon",onClick:C,children:p.jsx(qp,{size:20})})]}),p.jsxs("form",{onSubmit:y,children:[p.jsxs("div",{className:"modal-body",children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Nome do Componente Curricular"}),p.jsx("input",{type:"text",className:"input",value:c,onChange:v=>u(v.target.value),placeholder:"Ex: Matemtica, Lngua Portuguesa...",autoFocus:!0})]}),h&&p.jsx("p",{className:"form-error",children:h})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:C,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"btn btn-primary",disabled:f,children:f?p.jsxs(p.Fragment,{children:[p.jsx(Ds,{size:18,className:"spin"}),"Salvando..."]}):o?"Salvar":"Adicionar"})]})]})]})})]})}function tD(){const[n,e]=P.useState([]),[t,s]=P.useState(!0),[i,r]=P.useState(!1),[o,l]=P.useState(null),[c,u]=P.useState(""),[h,d]=P.useState(null),[f,m]=P.useState(!1);P.useEffect(()=>{S()},[]);const S=async()=>{try{const v=await ed.getAll();e(v)}catch(v){console.error("Error loading series:",v)}finally{s(!1)}},x=v=>{v?(l(v),u(v.name)):(l(null),u("")),d(null),r(!0)},C=()=>{r(!1),l(null),u(""),d(null)},y=async v=>{if(v.preventDefault(),!c.trim()){d("Nome  obrigatrio");return}m(!0),d(null);try{if(o){const E=await ed.update(o.id,c.trim());e(_=>_.map(k=>k.id===E.id?E:k))}else{const E=await ed.create(c.trim());e(_=>[..._,E].sort((k,T)=>k.name.localeCompare(T.name)))}C()}catch(E){d(E instanceof Error?E.message:"Erro ao salvar")}finally{m(!1)}},w=async v=>{if(confirm(`Tem certeza que deseja excluir "${v.name}"?`))try{await ed.delete(v.id),e(E=>E.filter(_=>_.id!==v.id))}catch(E){alert(E instanceof Error?E.message:"Erro ao excluir")}};return t?p.jsxs("div",{className:"loading-container",children:[p.jsx(Ds,{size:32,className:"spin"}),p.jsx("p",{children:"Carregando sries..."})]}):p.jsxs("div",{className:"manage-curriculum animate-fadeIn",children:[p.jsxs("div",{className:"page-header",children:[p.jsx("h1",{children:"Gerenciar Sries"}),p.jsxs("button",{className:"btn btn-primary",onClick:()=>x(),children:[p.jsx(Qy,{size:20}),"Adicionar Srie"]})]}),p.jsxs("div",{className:"curriculum-grid",children:[n.map(v=>p.jsxs("div",{className:"curriculum-card",children:[p.jsx("div",{className:"curriculum-icon",children:p.jsx(Zm,{size:24})}),p.jsx("div",{className:"curriculum-info",children:p.jsx("h3",{children:v.name})}),p.jsxs("div",{className:"curriculum-actions",children:[p.jsx("button",{className:"btn btn-icon",onClick:()=>x(v),title:"Editar",children:p.jsx(Ky,{size:18})}),p.jsx("button",{className:"btn btn-icon danger",onClick:()=>w(v),title:"Excluir",children:p.jsx(Zy,{size:18})})]})]},v.id)),n.length===0&&p.jsxs("div",{className:"empty-state",children:[p.jsx(Zm,{size:48}),p.jsx("p",{children:"Nenhuma srie cadastrada"}),p.jsx("button",{className:"btn btn-primary",onClick:()=>x(),children:"Adicionar Primeira Srie"})]})]}),i&&p.jsx("div",{className:"modal-overlay",onClick:C,children:p.jsxs("div",{className:"modal",onClick:v=>v.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:o?"Editar Srie":"Adicionar Srie"}),p.jsx("button",{className:"btn btn-icon",onClick:C,children:p.jsx(qp,{size:20})})]}),p.jsxs("form",{onSubmit:y,children:[p.jsxs("div",{className:"modal-body",children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{children:"Nome da Srie"}),p.jsx("input",{type:"text",className:"input",value:c,onChange:v=>u(v.target.value),placeholder:"Ex: 1 Ano, 2 Ano, 3 Ano...",autoFocus:!0})]}),h&&p.jsx("p",{className:"form-error",children:h})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:C,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"btn btn-primary",disabled:f,children:f?p.jsxs(p.Fragment,{children:[p.jsx(Ds,{size:18,className:"spin"}),"Salvando..."]}):o?"Salvar":"Adicionar"})]})]})]})})]})}function Gk({book:n,onClick:e}){const t=Xp(),s=()=>{n.pdf_url&&t(`/reader/${n.id}`)},i=()=>{n.pdf_url&&t(`/reader/${n.id}`),e&&e()};return p.jsxs("div",{className:"book-card",onClick:i,children:[p.jsxs("div",{className:"book-cover",children:[p.jsx("img",{src:zc.getFileUrl(n.cover_url)||"/placeholder-book.png",alt:n.title}),p.jsx("div",{className:"book-overlay",children:p.jsxs("button",{className:"read-btn",onClick:r=>{r.stopPropagation(),s()},disabled:!n.pdf_url,children:[p.jsx(fa,{size:20}),p.jsx("span",{children:n.pdf_url?"Ler Agora":"Sem PDF"})]})})]}),p.jsxs("div",{className:"book-info",children:[p.jsx("h3",{className:"book-title",children:n.title}),p.jsx("p",{className:"book-author",children:n.author}),p.jsx("div",{className:"book-meta",children:p.jsx("span",{className:"book-component",children:n.curriculum_component})})]}),p.jsx("div",{className:"book-arrow",children:p.jsx(vC,{size:20})})]})}function nD(){const{books:n,isLoading:e,filterBooks:t}=y1(),[s,i]=P.useState(""),[r,o]=P.useState("all"),[l,c]=P.useState("all"),u=t({search:s,curriculumComponent:r,classGroup:l});return p.jsxs("div",{className:"my-books animate-fadeIn",children:[p.jsx("div",{className:"page-header",children:p.jsx("h1",{children:"Biblioteca de Livros"})}),p.jsxs("div",{className:"books-filters",children:[p.jsxs("div",{className:"search-input",children:[p.jsx(Jy,{size:18}),p.jsx("input",{type:"text",placeholder:"Buscar livros...",value:s,onChange:h=>i(h.target.value),className:"input"})]}),p.jsxs("select",{className:"select",value:r,onChange:h=>o(h.target.value),children:[p.jsx("option",{value:"all",children:"Todas as disciplinas"}),jL.map(h=>p.jsx("option",{value:h,children:h},h))]}),p.jsxs("select",{className:"select",value:l,onChange:h=>c(h.target.value),children:[p.jsx("option",{value:"all",children:"Todas as turmas"}),mC.map(h=>p.jsx("option",{value:h,children:h},h))]})]}),p.jsx("section",{className:"books-section",children:p.jsx("div",{className:"books-list",children:e?p.jsx("div",{className:"empty-state",children:p.jsx("p",{children:"Carregando livros..."})}):u.length>0?u.map(h=>p.jsx(Gk,{book:h},h.id)):p.jsxs("div",{className:"empty-state",children:[p.jsx(fa,{size:48}),p.jsx("p",{children:n.length===0?"Nenhum livro disponvel ainda.":"Nenhum livro corresponde aos filtros selecionados."})]})})})]})}function sD(){const{user:n,getStudentsByProfessor:e}=qr(),t=n?e(n.id):[],s=t.reduce((i,r)=>{const o=r.class_group||"Sem turma";return i[o]||(i[o]=[]),i[o].push(r),i},{});return p.jsxs("div",{className:"my-books animate-fadeIn",children:[p.jsxs("div",{className:"page-header",children:[p.jsx("h1",{children:"Meus Alunos"}),p.jsxs("span",{className:"badge",children:[t.length," alunos"]})]}),t.length===0?p.jsxs("div",{className:"empty-state",children:[p.jsx(wC,{size:48}),p.jsx("p",{children:"Nenhum aluno vinculado a voc ainda."})]}):Object.entries(s).map(([i,r])=>p.jsxs("section",{className:"books-section",children:[p.jsxs("h2",{children:[i," (",r.length," alunos)"]}),p.jsx("div",{className:"students-grid",children:r.map(o=>p.jsxs("div",{className:"student-card",children:[p.jsxs("div",{className:"student-header",children:[p.jsx("img",{src:o.avatar,alt:o.name,className:"student-avatar"}),p.jsxs("div",{className:"student-info",children:[p.jsx("span",{className:"student-name",children:o.name}),p.jsx("span",{className:"student-email",children:o.email})]})]}),p.jsx("div",{className:"student-stats",children:p.jsxs("div",{className:"student-stat",children:[p.jsx("span",{className:"stat-value",children:o.class_group||"-"}),p.jsx("span",{className:"stat-label",children:"Turma"})]})})]},o.id))})]},i))]})}function iD(){const{user:n}=qr(),{studentBooks:e,isLoading:t}=y1(),[s,i]=P.useState(""),r=e.filter(o=>{if(!s)return!0;const l=s.toLowerCase();return o.title.toLowerCase().includes(l)||o.author.toLowerCase().includes(l)||o.curriculum_component.toLowerCase().includes(l)});return t?p.jsx("div",{className:"my-library loading",children:p.jsx("p",{children:"Carregando biblioteca..."})}):p.jsxs("div",{className:"my-library animate-fadeIn",children:[p.jsxs("div",{className:"page-header",children:[p.jsx("h1",{children:"Minha Biblioteca"}),(n==null?void 0:n.class_group)&&p.jsxs("span",{className:"class-badge",children:["Turma: ",n.class_group]})]}),p.jsxs("div",{className:"library-search",children:[p.jsx(Jy,{size:18}),p.jsx("input",{type:"text",placeholder:"Buscar livros...",value:s,onChange:o=>i(o.target.value),className:"input"})]}),p.jsx("div",{className:"library-grid",children:r.map(o=>p.jsx(Gk,{book:o},o.id))}),r.length===0&&p.jsxs("div",{className:"empty-state",children:[p.jsx(fa,{size:64}),p.jsx("h3",{children:"Nenhum livro encontrado"}),p.jsx("p",{children:e.length===0?"No h livros disponveis para sua turma ainda.":"Nenhum livro corresponde  sua busca."})]})]})}function rD(){return p.jsx(kL,{children:p.jsx(FL,{children:p.jsx(OL,{children:p.jsxs(wL,{children:[p.jsx(at,{path:"/login",element:p.jsx(dN,{})}),p.jsx(at,{path:"/",element:p.jsx(so,{to:"/login",replace:!0})}),p.jsx(at,{element:p.jsx(Eg,{allowedRoles:["admin","professor","student"]}),children:p.jsx(at,{path:"/reader/:bookId",element:p.jsx(VM,{})})}),p.jsx(at,{element:p.jsx(Eg,{allowedRoles:["admin"]}),children:p.jsxs(at,{element:p.jsx($v,{}),children:[p.jsx(at,{path:"/admin",element:p.jsx(so,{to:"/admin/books",replace:!0})}),p.jsx(at,{path:"/admin/books",element:p.jsx(JM,{})}),p.jsx(at,{path:"/admin/users",element:p.jsx(ZM,{})}),p.jsx(at,{path:"/admin/curriculum",element:p.jsx(eD,{})}),p.jsx(at,{path:"/admin/series",element:p.jsx(tD,{})})]})}),p.jsx(at,{element:p.jsx(Eg,{allowedRoles:["professor"]}),children:p.jsxs(at,{element:p.jsx($v,{}),children:[p.jsx(at,{path:"/professor",element:p.jsx(so,{to:"/professor/my-books",replace:!0})}),p.jsx(at,{path:"/professor/my-books",element:p.jsx(nD,{})}),p.jsx(at,{path:"/professor/students",element:p.jsx(sD,{})})]})}),p.jsx(at,{element:p.jsx(Eg,{allowedRoles:["student"]}),children:p.jsxs(at,{element:p.jsx($v,{}),children:[p.jsx(at,{path:"/student",element:p.jsx(so,{to:"/student/library",replace:!0})}),p.jsx(at,{path:"/student/library",element:p.jsx(iD,{})})]})}),p.jsx(at,{path:"*",element:p.jsx(so,{to:"/login",replace:!0})})]})})})})}sC(document.getElementById("root")).render(p.jsx(P.StrictMode,{children:p.jsx(rD,{})}));
